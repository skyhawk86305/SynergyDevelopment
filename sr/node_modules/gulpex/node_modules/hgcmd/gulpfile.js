'use strict';

var gulp = require('gulp'),
    gulpex = require('gulpex')(gulp);

var paths = {
        output: {
            'coverage': [ 'coverage.html' ],
            'jsdoc': [ 'doc/**' ],
            'pack': [ '*.tgz' ]
        }
    };

gulp.task('default', [ 'test', 'posttest' ]);

gulp.task('posttest', [ 'lint', 'doc', 'coverage', 'check-stale', 'check-dep-links' ]);

gulp.task('test', gulpex.run('lab -v'));

gulp.task('coverage', [ 'test' ], gulpex.run('lab -c -o coverage.html -r html'));

gulp.task('lint', gulpex.run('jshint index.js gulpfile.js lib test'));

gulp.task('doc', gulpex.run('jsdoc -c jsdoc.json -d doc -r index.js lib'));

gulp.task('clean', gulpex.clean(paths.output));

gulp.task('check-deps', gulpex.run('david --warn404'));

gulp.task('check-stale', gulpex.checkStale(__dirname));

gulp.task('check-dep-links', gulpex.checkDepLinks(__dirname));

gulp.task('watch', [ 'default' ], function () {
    gulp.watch([ 'index.js', 'lib/**', 'gulpfile.js', 'test/**' ], [ 'default' ]);
});
