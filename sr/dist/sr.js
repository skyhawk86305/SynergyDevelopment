(function e(t,r,i){function s(a,o){if(!r[a]){if(!t[a]){var l=typeof require=="function"&&require;if(!o&&l)return l(a,!0);if(n)return n(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return s(r?r:e)},u,u.exports,e,t,r,i)}return r[a].exports}var n=typeof require=="function"&&require;for(var a=0;a<i.length;a++)s(i[a]);return s})({1:[function(e,t,r){"use strict";var i=e("assert"),s=e("async"),n=window._,a=e("./components/app"),o=e("../lib/constants"),l=e("../lib/dispatcher"),c=e("../lib/stores/event-journal"),u=e("../lib/stores/hardware"),p=e("../lib/log-api"),d=e("../lib/stores/logger"),f=e("../lib/stores/motd"),h=e("./pages/portfolio"),m=e("../lib/stores/portfolio"),g=e("../lib/stores/prodinfo"),y=e("./pages/project"),v=e("../lib/stores/project"),_=window.React,E=e("./pages/releasenotes"),b=e("react-router"),w=e("../lib/stores/user-preferences"),S=e("../lib/stores/user-session"),A=e("../lib/xhr");var C=_.createFactory(b.Route),T=_.createFactory(b.DefaultRoute);e("setimmediate");setImmediate(R);function R(){s.auto({logger:q(d),log:["logger",N],xhr:L(A),portfolio:q(m,"xhr"),productInfo:q(g,"xhr","log"),project:q(v,"xhr","productInfo"),journal:q(c),motd:q(f),userSession:q(S),userPreferences:q(w,"log"),hardware:q(u),stores:["hardware","journal","motd","portfolio","productInfo","project","project","userPreferences","userSession",D],dispatcher:q(k,"log","stores"),routes:j(O),fire:["dispatcher",j(I,B)]},e);function e(e,r){if(e){return t(e,r)}r.log.debug("constructed and rendered");s.eachSeries([M,F,P("PORTFOLIO_FETCH"),P("MOTD_FETCH"),P("USER_SESSION_FETCH"),P("PRODUCTINFO_FETCH")],n,a);function n(e,t){i.equal(typeof e,"function","77c98c62");i.equal(typeof t,"function","52b5bfcd");try{e.call(this,r);setImmediate(t,null)}catch(s){setImmediate(t,s)}}function a(e){if(e){return t(e,r)}r.log.debug("launched")}}function t(e,t){try{return t.log(["launch-fatal"],e)}catch(r){try{return console.error(e)}catch(i){return}}}}function P(e){i.equal(typeof e,"string","fa8553d2");t._name=e;return t;function t(t){i.equal(typeof t,"object","4ec5a7b1");t.fire(e)}}function N(e,t){var r=t.logger,i={bind:r},s=new p(r.log,i);e(null,s.log)}function D(e,t){var r={};n.forEach(t,function i(e,t){if(x(e)){r[t]=e.getGuard()}});e(null,r)}function x(e){return typeof e==="object"&&e.act&&e.getState&&e.watch&&e.unwatch}function k(e){var t=n.values(e.stores),r=e.log;return new l(t,r)}function O(){return C({handler:a},T({name:"portfolio",handler:h}),C({name:"project",path:"/v/:uuid",handler:y}),C({name:"releasenotes",path:"/releasenotes",handler:E}))}function I(e){var t=e.dispatcher;return t.act.bind(t)}function M(e){e.log.debug("rendering...");var t=e.routes,r=e.stores,i=e.fire;b.run(t,b.HistoryLocation,function(t,s){var n=_.createFactory(t),a={stores:r,fire:i,log:e.log,params:s.params,query:s.query};_.render(n(a),document.getElementById("container"))})}function F(e){e.log.debug("starting log drainer...");e.dispatcher.on("dispatched",function(){e.logger.drain(t)});function t(e,t){A("POST",o.CLIENT_LOG_PATH,{payload:e},t)}}function q(e){var t=n.toArray(arguments).slice(1),r=j(i,B);return t.concat([r]);function i(r){if(t.length){return new e(n.pick(r,t))}else{return new e}}}function L(e){return t;function t(t){t(null,e)}}function j(e,t){i.equal(typeof e,"function","can't asyncify "+typeof e);t=t||s;r._name=e._name||e.name||undefined;return r;function r(r,s){i.equal(typeof r,"function","async fn needs callback");var n;try{n=e.apply(this,t(s))}catch(a){setImmediate(r,a)}setImmediate(r,null,n)}function s(){return[]}}function B(e){return[e]}},{"../lib/constants":65,"../lib/dispatcher":68,"../lib/log-api":73,"../lib/stores/event-journal":113,"../lib/stores/hardware":114,"../lib/stores/logger":115,"../lib/stores/motd":116,"../lib/stores/portfolio":117,"../lib/stores/prodinfo":118,"../lib/stores/project":119,"../lib/stores/user-preferences":121,"../lib/stores/user-session":122,"../lib/xhr":125,"./components/app":7,"./pages/portfolio":47,"./pages/project":48,"./pages/releasenotes":49,assert:127,async:126,"react-router":162,setimmediate:181}],2:[function(e,t,r){"use strict";var i=window.React,s=e("./repeat"),n=e("./faglyph"),a=e("./capacity-tooltip"),o=e("../../lib/units.js"),l=window._,c=e("../../lib/model/aggregates/aggregateReporter"),u=e("./constants"),p=e("../usual-props");var d=i.createClass({displayName:"AggregateDevice",propTypes:{aggregateDevice:i.PropTypes.object.isRequired},render:function(){var e=this.props.aggregateDevice;var t="hdd-o",r=e.rpm.toString(),s=new o(e.physicalRawCapacityGB,"GB").makeHappyFriendly(null,null,"%d%s");if(e.isVirtualDevice){s=new o(e.rightSizedCapacityGB,"GB").to("GiB").makeHappyFriendly();t="pie-chart"}return i.createElement("div",{className:"count-icon-grouping hide-contracted no-overflow"},i.createElement("span",{className:"count"},e.count),i.createElement("span",{className:"icon drive-speed-"+r.replace(".","p")},i.createElement(n,{name:t})),i.createElement("span",{className:"item"},s))}});var f=i.createClass({displayName:"Aggregate",propTypes:l.merge({aggregate:i.PropTypes.object.isRequired,systems:i.PropTypes.array.isRequired,select:i.PropTypes.func.isRequired,isEditModeManualAggregates:i.PropTypes.bool.isRequired,displayCapacityInBase:i.PropTypes.string.isRequired,aggregateDisplayLanguage:i.PropTypes.string.isRequired,selectDetails:i.PropTypes.object.isRequired,userPreferences:i.PropTypes.object.isRequired},p.isRequired),selectAggregate:function(e,t){t.stopPropagation();t.preventDefault();var r={controller:{_id:e._controller},aggregate:{_id:e._id},manualAggregates:this.props.isEditModeManualAggregates};this.props.select(r,u.UI_SELECT_ADD_CHANGE_AGGREGATE)},deleteAggregate:function(e){e.stopPropagation();e.preventDefault();this.props.fire("PROJECT_DELETE_AGGREGATE",this.props.aggregate._systemId,this.props.aggregate);this.props.select()},_getDeviceCapacity:function(){var e=this.props.aggregate._raid_groups[0].__deviceSpecs;return e&&e[0].spec?e[0].spec.rawgb:0},_getRaidSize:function(){return this.props.aggregate._raid_groups[0]._devices.length},_getSystemThatOwnsThisAggregate:function(e){var t=this.props.systems;if(!(t instanceof Array)){t=[t]}return l.first(l.where(t,function(t){var r=l.flatten(l.map(t.controllers,function(e){return l.map(e.aggregates,function(e){return e._id})}));return l.contains(r,e._id)}))},_isSelected:function(){var e=this.props.selectDetails.aggregate;if(e){if(e._id===this.props.aggregate._id){return true}}return false},render:function(){var e=this.props.aggregate.name||"un-named",t=this.props.aggregate._controllerName,r=this.props.aggregate.is_root_aggregate,n=this._getSystemThatOwnsThisAggregate(this.props.aggregate),u=this.props.map.inspect(n),p=new c(u),f=p.createAggregateReport(this.props.aggregate),h=f.summary,m=r?h.rootCapacity:h.usableCapacity,g=new o(m,"GiB"),y=g.to(this.props.displayCapacityInBase).friendly(2);e=e.substring(0,15);var v=l.partial(this.selectAggregate,this.props.aggregate),_=l.map(l.keys(h.driveSpecSummary),function(e){var t=h.driveSpecSummary[e];return{isVirtualDevice:t.isVirtual,virtualDeviceType:t.virtualPartitionType,physicalRawCapacityGB:t.rawgb,rightSizedCapacityGB:t.rsgb,rpm:t.rpm,count:t.count}});var E=r||!this.props.isEditModeManualAggregates&&!this.props.aggregate._manual?r?i.createElement("span",{className:"badge"},"root"):i.createElement("div",null):i.createElement("span",{className:"fa fa-fw fa-trash",onClick:this.deleteAggregate});var b=i.addons.classSet({"row-list-item":true,selectable:true,selected:this._isSelected()});var w,S,A=l.where(_,{virtualDeviceType:"cache"});if(!l.isEmpty(A)){var C=h.cacheCapacity,T=this.props.userPreferences.useBase10Yields?"GB":"GiB",R=new o(C,"GiB"),P=R.to(T).friendly(2);w=i.createElement("div",null,P,i.createElement(a,{title:"Flash Pool Capacity ("+this.props.aggregateDisplayLanguage+")",inputUnit:R}));S=i.createElement("div",null,i.createElement("div",null,i.createElement("br",null)),i.createElement("div",null,i.createElement("span",{className:this.props.aggregate.is_hybrid?"fa fa-fw fa-flash hide-contracted":"hide-contracted"})))}return i.createElement("div",{className:b,onClick:v},i.createElement("div",{className:"row-list-cell row-list-cell-aggr-icon"},E),i.createElement("div",{className:"row-list-cell row-list-cell-aggr-name"},i.createElement("span",{className:"emphasize"},e)),i.createElement("div",{className:"row-list-cell row-list-cell-aggr-controller"},i.createElement("span",null,t)),i.createElement("div",{className:"row-list-cell row-list-cell-aggr-devices"},i.createElement(s,{seq:_,prop:"aggregateDevice"},i.createElement(d,null))),i.createElement("div",{className:"row-list-cell row-list-cell-aggr-size numeric"},i.createElement("div",{className:"hide-contracted no-overflow hover"},i.createElement("div",null,y,i.createElement(a,{title:"Usable Capacity ("+this.props.aggregateDisplayLanguage+")",inputUnit:g})),w)),i.createElement("div",{className:"row-list-cell hide-contracted"},S),i.createElement("span",{className:"chevron"},i.createElement("span",{className:"fa fa-fw fa-chevron-right"})))}});var h=i.createClass({displayName:"AggregateDetails",propTypes:l.merge({systems:i.PropTypes.array.isRequired,aggregateDisplayLanguage:i.PropTypes.string.isRequired,select:i.PropTypes.func.isRequired,clearSelection:i.PropTypes.func,selectDetails:i.PropTypes.object.isRequired,userPreferences:i.PropTypes.object.isRequired},p.isRequired),toggleAggregatesMode:function(e){e.stopPropagation();e.preventDefault();var t=this.props,r=t.systems instanceof Array?t.systems:[t.systems];var i=!this.state.isEditModeManualAggregates;if(i){}else{l(r).forEach(function(e){t.fire("PROJECT_REBUILD_AUTO_AGGREGATES",e._id)})}this.setState({isEditModeManualAggregates:i})},_getAllAggregatesAndDecorate:function(e){var t=[],r=e||this.props.systems;if(!(r instanceof Array)){r=[r]}l.forEach(r,function(e){l.forEach(e.controllers,function(r){var i=l.cloneDeep(r.aggregates);l.forEach(i,function(t){t._controllerName=r.name||"un-named";t._systemId=e._id});t.push(i)})});return l.flatten(t)},_sortByRootAggregate:function(e){return l.sortBy(e,function(e){return!e.is_root_aggregate})},addAggregate:function(e){e.stopPropagation();e.preventDefault();this.props.select({},u.UI_SELECT_ADD_CHANGE_AGGREGATE)},render:function(){var e=this._sortByRootAggregate(this._getAllAggregatesAndDecorate()),t=this.props.aggregateDisplayLanguage,r=t.toLowerCase(),n=t.substring(0,t.length-1),a=n.toLowerCase(),o=l.where(e,function(e){return!e._manual}),c=l.where(e,function(e){return e._manual});var u=this.props.systems._policies||{},d=u.Aggregates||{},h=this.props.userPreferences.useBase10Yields?"TB":"TiB";var m=d.manual?true:false;var g="row-list-item selectable new";var y=m?i.createElement("div",{className:g,onClick:this.addAggregate},i.createElement("div",{className:"row-list-cell row-list-cell-aggr-icon"}),i.createElement("div",{className:"row-list-cell"},"Add a new ",a),i.createElement("span",{className:"chevron"},i.createElement("span",{className:"fa fa-fw fa-plus"}))):i.createElement("div",null);return i.createElement("div",null,i.createElement("div",{className:"row-list-item-grouping"},i.createElement("div",{className:"row-list"},i.createElement("div",{className:"row-list-item row-list-item-aggregate-header"},i.createElement("div",{className:"row-list-cell row-list-cell-aggr-icon"}),i.createElement("div",{className:"row-list-cell"},i.createElement("div",{className:"aggregate-type-header no-overflow"},"Manually created ",r))),y,i.createElement(s,{seq:c,prop:"aggregate"},i.createElement(f,i.__spread({isEditModeManualAggregates:m,systems:this.props.systems,select:this.props.select,selectDetails:this.props.selectDetails,displayCapacityInBase:h,aggregateDisplayLanguage:n,userPreferences:this.props.userPreferences},p(this.props)))))),i.createElement("div",{className:"row-list-item-grouping"},i.createElement("div",{className:"row-list"},i.createElement("div",{className:"row-list-item row-list-item-aggregate-header"},i.createElement("div",{className:"row-list-cell row-list-cell-aggr-icon"}),i.createElement("div",{className:"row-list-cell"},i.createElement("div",{className:"aggregate-type-header no-overflow"},"Automatically created ",r))),i.createElement(s,{seq:o,prop:"aggregate"},i.createElement(f,i.__spread({isEditModeManualAggregates:m,systems:this.props.systems,select:this.props.select,selectDetails:this.props.selectDetails,displayCapacityInBase:h,aggregateDisplayLanguage:n,userPreferences:this.props.userPreferences},p(this.props)))))))}});t.exports=h},{"../../lib/model/aggregates/aggregateReporter":76,"../../lib/units.js":123,"../usual-props":51,"./capacity-tooltip":9,"./constants":14,"./faglyph":16,"./repeat":34}],3:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./common/option-row"),a=e("./aggregate-summary"),o=e("./flash-pool"),l=e("../../lib/units.js"),c=e("../usual-props");var u=s.createClass({displayName:"AggregateEditorExtendedOptions",propTypes:i.merge({extendedOption:s.PropTypes.string,aggregateBuilder:s.PropTypes.object.isRequired,selected:s.PropTypes.object,updateModel:s.PropTypes.func,hagi:s.PropTypes.object.isRequired,hagroups:s.PropTypes.array.isRequired,readOnly:s.PropTypes.bool.isRequired,displayType:s.PropTypes.string,setExtendedOption:s.PropTypes.func.isRequired,report:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired,close:s.PropTypes.func.isRequired},c.isRequired),render:function(){var e;switch(this.props.extendedOption){case"driveSelector":e=s.createElement(p,{aggregateBuilder:this.props.aggregateBuilder,displayType:this.props.displayType,updateModel:this.props.updateModel,close:this.props.close});break;case"flashPoolEditor":e=s.createElement("div",{className:"aggregate-editor-extended-options"},s.createElement(o,s.__spread({aggregate:this.props.aggregateBuilder.aggregate,hagi:this.props.hagi},i.pick(this.props,"fire","log"))));break;case"raidSelector":e=s.createElement(d,{aggregateBuilder:this.props.aggregateBuilder,updateModel:this.props.updateModel,close:this.props.close});break;default:var t=this.props.userPreferences.useBase10Yields?"TB":"TiB",r=this.props.aggregateBuilder.aggregate,n=this.props.aggregateBuilder.systemLimits();e=s.createElement(a,{report:this.props.report,limits:n,base10YieldsPreference:t,raidType:r.raid_type,isESeries:this.props.hagi.isESeries});break}return e}});var p=s.createClass({displayName:"DriveSelector",propTypes:{aggregateBuilder:s.PropTypes.object.isRequired,displayType:s.PropTypes.string.isRequired,updateModel:s.PropTypes.func.isRequired,close:s.PropTypes.func.isRequired},render:function(){var e=this.props,t=this,r=e.aggregateBuilder.deviceSummary(),a=r.data.spec,o=this.getDriveSpecDisplay(a),l=e.aggregateBuilder.availableDeviceGroupsForAggregate();var c=i(l).map(function(e){var r=i.partial(t.selectDriveForAggregate,e.spec,e.count),a=t.getDriveSpecDisplay(e.spec,e.count);return s.createElement(n,{action:r,readOnly:false,optionName:a,optionValue:a===o,type:"radio"})});return s.createElement("div",{className:"aggregate-editor-extended-options"},s.createElement("div",{className:"row-list-item-option-header"},"Select ",this.props.displayType," Disk"),c)},getDriveSpecDisplay:function(e,t){var r;if(t){r="("+t+")"}else{r=""}if(e){if(e.slice){return this.getVirtualDeviceSize(e)}else{return e.rawgb+"GB "+e.type+" "+r}}else{return"none"}},getVirtualDeviceSize:function(e){return new l(e.rsgb,"GB").to("GiB").makeHappyFriendly()},selectDriveForAggregate:function(e){console.log("event",e);this.props.close()}});var d=s.createClass({displayName:"RaidSelector",propTypes:{aggregateBuilder:s.PropTypes.object.isRequired,updateModel:s.PropTypes.func.isRequired,close:s.PropTypes.func.isRequired},render:function(){var e=this.props,t=this,r=e.aggregateBuilder.aggregate.raid_type,a=e.aggregateBuilder.availableRaidTypes();var o=i(a).map(function(e){var a=i.partial(t.selectRaidTypeForAggregate,e);return s.createElement(n,{action:a,readOnly:false,optionName:e.replace("_"," "),optionValue:e===r,type:"radio"})});return s.createElement("div",{className:"aggregate-editor-extended-options"},s.createElement("div",{className:"row-list-item-option-header"},"Select RAID Type"),o)},selectRaidTypeForAggregate:function(e){this.props.aggregateBuilder.setRaidType(e);this.props.updateModel();this.props.close()}});t.exports=u},{"../../lib/units.js":123,"../usual-props":51,"./aggregate-summary":6,"./common/option-row":12,"./flash-pool":17}],4:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./common/option-row"),a=e("../../lib/model/aggregates/raid-types"),o=e("../../lib/units.js"),l=e("../usual-props");var c=s.createClass({displayName:"AggregateEditorOptions",propTypes:i.merge({aggregateBuilder:s.PropTypes.object.isRequired,changeRaidSize:s.PropTypes.func,requestedRaidSize:s.PropTypes.number,selected:s.PropTypes.object,updateModel:s.PropTypes.func,hagi:s.PropTypes.object.isRequired,hagroups:s.PropTypes.array.isRequired,readOnly:s.PropTypes.bool.isRequired,displayType:s.PropTypes.string,setExtendedOption:s.PropTypes.func.isRequired,report:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired},l.isRequired),render:function(){var e=this.props,t=this,r=this.getHagroup(),i=new a,o=e.aggregateBuilder,l=o.deviceSummary(),c=o.deviceLimits(),u=o.raidSizeLimits(),p=l.data.spec,d=o.aggregate,f=this.props.requestedRaidSize?this.props.requestedRaidSize:this.getActualRaidSize(),h=e.report;var m=!e.readOnly&&!d.is_root_aggregate,g=!e.readOnly&&!(d.is_root_aggregate&&h.summary.containsVirtualDevices),y=!e.readOnly&&!d.is_root_aggregate;function v(){if(!e.hagi.isESeries){return s.createElement("div",null,s.createElement("div",{className:"row-list-item-option-header"},"Flash Pool"),s.createElement(n,{action:t.openFlashPoolEditor,readOnly:false,optionName:t.getFlashPoolDisplayName(),type:"extended"}),s.createElement("div",{className:"row-list-item-option-header"},"Configuration"),s.createElement(n,{action:t.props.changeRaidSize,readOnly:!y,optionName:"Requested RAID Size",optionValue:f,maxValue:u.max,minValue:u.min,type:"spinner"}),s.createElement(n,{action:null,readOnly:true,optionName:"Actual RAID Size",optionValue:t.getActualRaidSize(),type:"spinner"}),s.createElement(n,{action:t.setSnapReserveProportion,readOnly:!g,optionName:"Snap Reserve %",optionValue:t.getAggregateSnapReserveAsPercentage(d),maxValue:50,minValue:0,hide:!t.isManualAggregatePolicyEnabled(),type:"spinner"}))}}return s.createElement("div",{className:"aggregate-editor-options"},s.createElement("div",{className:"row-list-item-option-header"},e.displayType," Name"),s.createElement(n,{action:this.setAggregateName,readOnly:!this.isManualAggregatePolicyEnabled(),optionName:d.name,type:"text"}),s.createElement("div",{className:"row-list-item-option-header"},"Controller"),s.createElement(n,{action:this.setToPrimaryController,readOnly:!m,optionName:r.controllers[0].name,optionValue:this.isAggregateOnPrimaryController(d),type:"radio"}),s.createElement(n,{action:this.setToPartnerController,readOnly:!m,optionName:r.controllers.length>1?r.controllers[1].name:"n/a",optionValue:!this.isAggregateOnPrimaryController(d),type:"radio"}),s.createElement("div",{className:"row-list-item-option-header"},"RAID Type"),s.createElement(n,{action:this.openRaidSelector,readOnly:!g,optionName:d.raid_type.replace("_"," "),type:"extended"}),s.createElement("div",{className:"row-list-item-option-header"},"Devices"),s.createElement(n,{action:this.setDriveCount,readOnly:!g,optionName:"Count",optionValue:l.data.count,maxValue:c.max,minValue:c.min,type:"spinner"}),s.createElement(n,{action:this._applyDdpReserve,readOnly:this.isManualAggregatePolicyEnabled(),optionName:"Reserve",optionValue:h.summary.driveRoleSummary&&h.summary.driveRoleSummary.reserve?h.summary.driveRoleSummary.reserve:0,maxValue:h.summary.driveRoleSummary?this.getMaxDdpReserveCount(h.summary.driveRoleSummary.total):0,hide:!(e.hagi.isESeries&&d.raid_type===i.DDP),type:"spinner"}),s.createElement(n,{action:this.openDriveSelector,readOnly:!g,optionName:this.getDriveSpecDisplay(p),type:"extended"}),v())},getAggregateSnapReserveAsPercentage:function(e){return Math.round(e._snapreserve_proportion*100)},getDriveSpecDisplay:function(e,t){var r;if(t){r="("+t+")"}else{r=""}if(e){if(e.slice){return this.getVirtualDeviceSize(e)}else{return e.rawgb+"GB "+e.type+" "+r}}else{return"none"}},getBuilder:function(){return this.props.aggregateBuilder},getFlashPoolDisplayName:function(){var e=this.props.report.summary.cacheCapacity,t=this.props.userPreferences.useBase10Yields?"GB":"GiB",r=new o(e,"GiB"),i=r.to(t).friendly(2);var s=e?i+" allocated":"None allocated";return s},getHagroup:function(){return i.first(this.props.hagroups)},getMaxDdpReserveCount:function(e){console.log("totalDriveCount",e);return 0},getActualRaidSize:function(){var e=this.getBuilder();return e.currentRaidSize()},getRequestedRaidSize:function(){var e=this.getBuilder();return e.requestedRaidSize()},getVirtualDeviceSize:function(e){return new o(e.rsgb,"GB").to("GiB").makeHappyFriendly()},isAggregateOnPrimaryController:function(e){var t=this.getHagroup();return e._controller===t.controllers[0]._id?true:false},isManualAggregatePolicyEnabled:function(){var e=i.first(this.props.hagroups),t=e._policies||{},r=t.Aggregates||{},s=r.manual?true:false;return s},setAggregateName:function(e){var t=this.getBuilder();t.setName(e.target.value);this.props.updateModel()},setDriveCount:function(e){var t=this.getBuilder(),r=t.deviceSummary(),i=r.data.spec;if(i){t.setDeviceAndCount(i,e);this.props.updateModel()}},setSnapReserveProportion:function(e){var t=this.getBuilder(),r=e/100;t.setSnapReserve(r);this.props.updateModel()},setToPartnerController:function(){var e=this.getBuilder(),t=this.getHagroup(),r=i.last(t.controllers);e.setController(r);this.props.updateModel()},setToPrimaryController:function(){var e=this.getBuilder(),t=this.getHagroup(),r=i.first(t.controllers);e.setController(r);this.props.updateModel()},openDriveSelector:function(){this.props.setExtendedOption("driveSelector")},openFlashPoolEditor:function(){this.props.setExtendedOption("flashPoolEditor")},openRaidSelector:function(){this.props.setExtendedOption("raidSelector")}});t.exports=c},{"../../lib/model/aggregates/raid-types":86,"../../lib/units.js":123,"../usual-props":51,"./common/option-row":12}],5:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("../usual-props"),a=e("./layout/column-header"),o=e("./layout/action-link"),l=e("./layout/scrollable-region"),c=e("./aggregate-editor-options"),u=e("./aggregate-editor-extended-options"),p=e("../../lib/model/aggregates/aggregateReporter"),d=e("../../lib/model/aggregates/manual-aggregate-builder");var f=s.createClass({displayName:"AggregateEditor",propTypes:i.merge({selection:s.PropTypes.object.isRequired,selected:s.PropTypes.object,selectedItem:s.PropTypes.array.isRequired,onClose:s.PropTypes.func,platformConfig:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired,installations:s.PropTypes.array.isRequired},n.isRequired),getInitialState:function(){return{requestedRaidSize:0}},componentWillReceiveProps:function(e){this.checkPropsAndInitializeState(e)},componentWillMount:function(){this.checkPropsAndInitializeState(this.props)},render:function(){var e=this.builder,t=e.aggregate,r=!this.isManualAggregatePolicyEnabled(),i=this.isProductLineESeries(),c=i?"Storage Container":"Aggregate",u=r?"View "+c:"Change "+c,d=this.props.selectedItem,f=this.makeHagi(d),m=new p(f),g=m.createAggregateReport(t);if(!this.canAddAggregate()){return s.createElement("div",{className:"placeholder-pane"},"No unallocated/spare devices available to create new aggregate.",s.createElement("br",null),"Add more drives to system.")}return s.createElement("div",null,s.createElement(a,{columnTitle:u},s.createElement(o,{isToggle:false,select:this.props.onClose,selected:false,enabled:true},"Close")),s.createElement(l,null,s.createElement(h,s.__spread({aggregateBuilder:e,changeRaidSize:this.changeRaidSize,requestedRaidSize:this.state.requestedRaidSize,hagi:f,hagroups:d,displayType:c,readOnly:r,updateModel:this.updateModel,selected:this.props.selected,report:g,userPreferences:this.props.userPreferences},n(this.props)))))},changeRaidSize:function(e){this.setState({requestedRaidSize:e});this.builder.setRaidSize(e);this.updateModel()},addAggregate:function(e){this.builder=new d(e);if(this.builder.aggregate){this.props.fire("PROJECT_ADD_MANUAL_AGGREGATE",e.hagroup._id,this.builder.aggregate,this.selectAggregate)}else{console.log("add failed 2: could not plan new aggregate")}},canAddAggregate:function(){return this.isAggregateSpecifiedInSelection(this.props)},checkPropsAndInitializeState:function(e){var t=this.makeHagi(e.selectedItem),r=this.state.requestedRaidSize;if(!this.isAggregateSpecifiedInSelection(e)){this.addAggregate(t)}else{this.builder=new d(t,i.first(e.selection),r)}},isAggregateSpecifiedInSelection:function(e){return"aggregate"in e.selected.selector},isManualAggregatePolicyEnabled:function(){var e=i.first(this.props.selectedItem),t=e._policies||{},r=t.Aggregates||{},s=r.manual?true:false;return s},isProductLineESeries:function(){var e=this.makeHagi(this.props.selectedItem);return e.isESeries},makeHagi:function(e){var t=this.props.map,r=i.first(e);return t.inspect(r)},selectAggregate:function(e){var t=this.props.selected,r=i.clone(t.selector)||{};if(e){i.merge(r,{aggregate:{_id:e._id},controller:{_id:e._controller}});this.props.fire("HARDWARE_SELECT",t.uuid,r,t.col2View,t.col3View)}},updateModel:function(){var e=i.first(this.props.selectedItem),t=this.builder.aggregate;if(t){this.props.fire("PROJECT_ADD_MANUAL_AGGREGATE",e._id,t,this.selectAggregate)}else{console.error("missing aggregate")}}});var h=s.createClass({displayName:"AggregateEditorPane",propTypes:i.merge({aggregateBuilder:s.PropTypes.object.isRequired,changeRaidSize:s.PropTypes.func,requestedRaidSize:s.PropTypes.number,selected:s.PropTypes.object,updateModel:s.PropTypes.func,hagi:s.PropTypes.object.isRequired,hagroups:s.PropTypes.array.isRequired,readOnly:s.PropTypes.bool.isRequired,displayType:s.PropTypes.string,report:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired},n.isRequired),getInitialState:function(){return{extendedOption:null}},render:function(){return s.createElement("div",{className:"aggregate-editor"},s.createElement(c,s.__spread({aggregateBuilder:this.props.aggregateBuilder,changeRaidSize:this.props.changeRaidSize,requestedRaidSize:this.props.requestedRaidSize,hagi:this.props.hagi,hagroups:this.props.hagroups,displayType:this.props.displayType,readOnly:this.props.readOnly,updateModel:this.props.updateModel,selected:this.props.selected,setExtendedOption:this.setExtendedOption,report:this.props.report,userPreferences:this.props.userPreferences},n(this.props))),s.createElement(u,s.__spread({extendedOption:this.state.extendedOption,aggregateBuilder:this.props.aggregateBuilder,hagi:this.props.hagi,hagroups:this.props.hagroups,displayType:this.props.displayType,readOnly:this.props.readOnly,updateModel:this.props.updateModel,selected:this.props.selected,setExtendedOption:this.setExtendedOption,report:this.props.report,userPreferences:this.props.userPreferences,close:this.close},n(this.props))))},close:function(){this.setState({extendedOption:null})},setExtendedOption:function(e){this.setState({extendedOption:e})}});t.exports=f},{"../../lib/model/aggregates/aggregateReporter":76,"../../lib/model/aggregates/manual-aggregate-builder":78,"../usual-props":51,"./aggregate-editor-extended-options":3,"./aggregate-editor-options":4,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26}],6:[function(e,t,r){"use strict";var i=window.React,s=e("../../lib/model/aggregates/raid-types"),n=e("../../lib/units.js");var a=i.createClass({displayName:"AggregateSummary",propTypes:{report:i.PropTypes.object.isRequired,limits:i.PropTypes.object.isRequired,base10YieldsPreference:i.PropTypes.string.isRequired,raidType:i.PropTypes.string.isRequired,isESeries:i.PropTypes.bool.isRequired},render:function(){var e=200;if(this.props.isESeries){return i.createElement(o,{report:this.props.report,limits:this.props.limits,base10YieldsPreference:this.props.base10YieldsPreference,raidType:this.props.raid_type})}return i.createElement("div",{className:"aggregate-editor-extended-options aggregate-editor-summary"},i.createElement("div",{className:"row-list-item-option-header"},"Aggregate Summary"),i.createElement(c,{report:this.props.report,limits:this.props.limits,scaleModifier:e,base10YieldsPreference:this.props.base10YieldsPreference}),i.createElement(u,{driveRoleSummary:this.props.report.summary.driveRoleSummary,limits:this.props.limits,scaleModifier:e}))}});var o=i.createClass({displayName:"StorageContainerSummary",propTypes:{report:i.PropTypes.object.isRequired,limits:i.PropTypes.object.isRequired,base10YieldsPreference:i.PropTypes.string.isRequired,raidType:i.PropTypes.string.isRequired},render:function(){var e=this.props.raidType==="DDP"||this.props.raidType===(new s).DDP?"DDP":"Volume Group",t=200,r;if(e==="DDP"){r=i.createElement(p,{driveRoleSummary:this.props.report.summary.driveRoleSummary,limits:this.props.limits,scaleModifier:t})}else{r=i.createElement(u,{driveRoleSummary:this.props.report.summary.driveRoleSummary,limits:this.props.limits,scaleModifier:t,showTotalToMaxRatio:true})}return i.createElement("div",{className:"aggregate-editor-extended-options aggregate-editor-summary"},i.createElement("div",{className:"row-list-item-option-header"},"Storage Container Summary"),i.createElement(l,{report:this.props.report,limits:this.props.limits,scaleModifier:t,base10YieldsPreference:this.props.base10YieldsPreference,aggregateDisplayLanguage:e}),r)}});var l=i.createClass({displayName:"CapacitySummaryChartForESeries",render:function(){var e=this.props.report,t=this.props.limits,r=this.props.base10YieldsPreference,s=this.props.aggregateDisplayLanguage,a=e.summary.isRootAggregate?e.summary.rootCapacity:e.summary.usableCapacity,o=e.summary.isRootAggregate?"Root Capacity ":"Usable Capacity ",l=this.props.scaleModifier,c=new n(t.capacity_gb,"GB"),u=c.to("GiB").value,p=0/u*l,d=a/u*l,f=new n(a,"GiB");return i.createElement("div",{className:"ae-summary-graph"},i.createElement("span",{className:"emphasize"},s," Size"),i.createElement("svg",{width:l,height:"110"},i.createElement("g",null,i.createElement("rect",{width:l,height:"32",y:"2",className:"ae-summary-bar-container"}),i.createElement("rect",{width:p,height:"32",y:"2",className:"ae-summary-bar-snap-reserve"}),i.createElement("rect",{width:d,height:"32",x:p,y:"2",className:"ae-summary-bar-usable-capacity"})),i.createElement("g",null,i.createElement("rect",{width:"8",height:"8",y:"48",className:"ae-summary-bar-usable-capacity"}),i.createElement("text",{x:"16",y:"56"},o+" "+f.to(r).friendly(2)))))}});var c=i.createClass({displayName:"CapacitySummaryChartWithSnapReserve",render:function(){var e=this.props.report,t=this.props.limits,r=this.props.base10YieldsPreference,s=e.summary.isRootAggregate?e.summary.rootCapacity:e.summary.usableCapacity,a=e.summary.isRootAggregate?"Root Capacity ":"Usable Capacity ",o=e.summary.snapReserveCapacity+s,l=this.props.scaleModifier,c=e.summary.snapReserveCapacity/new n(t.aggr.size_64_tb,"TiB").to("GiB").value*l,u=s/new n(t.aggr.size_64_tb,"TiB").to("GiB").value*l,p=new n(s,"GiB"),d=new n(e.summary.snapReserveCapacity,"GiB");return i.createElement("div",{className:"ae-summary-graph"},i.createElement("span",{className:"emphasize"},"Aggregate Size"),i.createElement("br",null),i.createElement("span",{className:"pull-right"},new n(o,"GiB").to(r).friendly(2)," / ",new n(t.aggr.size_64_tb,"TiB").to(r).friendly(2)),i.createElement("br",null),i.createElement("svg",{width:l,height:"110"},i.createElement("g",null,i.createElement("rect",{width:l,height:"32",y:"2",className:"ae-summary-bar-container"}),i.createElement("rect",{width:c,height:"32",y:"2",className:"ae-summary-bar-snap-reserve"}),i.createElement("rect",{width:u,height:"32",x:c,y:"2",className:"ae-summary-bar-usable-capacity"})),i.createElement("g",null,i.createElement("rect",{width:"8",height:"8",y:"48",className:"ae-summary-bar-snap-reserve"}),i.createElement("text",{x:"16",y:"56"},"Snap Reserve "+d.to(r).friendly(2)),i.createElement("rect",{width:"8",height:"8",y:"72",className:"ae-summary-bar-usable-capacity"}),i.createElement("text",{x:"16",y:"80"},a+" "+p.to(r).friendly(2)))))
}});var u=i.createClass({displayName:"DriveCountsSummaryChartWithParity",render:function(){var e=this.props.scaleModifier,t=this.props.limits.drive.total,r=this.props.driveRoleSummary,s=r.parity+r.dparity,n=s+r.data+s,a=s/t*e,o=r.data/t*e,l=this.props.showTotalToMaxRatio;return i.createElement("div",{className:"ae-summary-graph"},i.createElement("span",{className:"emphasize"},"Drive Counts"),l?i.createElement("span",{className:"pull-right"},n," / ",t," Drives"):"",i.createElement("svg",{width:e,height:"140"},i.createElement("g",null,i.createElement("rect",{width:e,height:"32",y:"2",className:"ae-summary-bar-container"}),i.createElement("rect",{width:a,height:"32",y:"2",className:"ae-summary-bar-parity-drives"}),i.createElement("rect",{width:o,height:"32",x:a,y:"2",className:"ae-summary-bar-data-drives"})),i.createElement("g",null,i.createElement("rect",{width:"8",height:"8",y:"48",className:"ae-summary-bar-parity-drives"}),i.createElement("text",{x:"16",y:"56"},"Parity Drives "+s),i.createElement("rect",{width:"8",height:"8",y:"72",className:"ae-summary-bar-data-drives"}),i.createElement("text",{x:"16",y:"80"},"Data Drives "+r.data))))}});var p=i.createClass({displayName:"DriveCountsSummaryChartWithReserve",render:function(){var e=this.props.scaleModifier,t=this.props.limits.drive.total,r=this.props.driveRoleSummary,s=r.parity+r.dparity,n=s/t*e,a=r.data/t*e,o=s+r.data+(r.reserve||0);return i.createElement("div",{className:"ae-summary-graph"},i.createElement("span",{className:"emphasize"},"Drive Counts"),i.createElement("span",{className:"pull-right"},o," / ",t," Drives"),i.createElement("br",null),i.createElement("svg",{width:e,height:"140"},i.createElement("g",null,i.createElement("rect",{width:e,height:"32",y:"2",className:"ae-summary-bar-container"}),i.createElement("rect",{width:n,height:"32",y:"2",className:"ae-summary-bar-parity-drives"}),i.createElement("rect",{width:a,height:"32",x:n,y:"2",className:"ae-summary-bar-data-drives"})),i.createElement("g",null,i.createElement("rect",{width:"8",height:"8",y:"48",className:"ae-summary-bar-parity-drives"}),i.createElement("text",{x:"16",y:"56"},"Reserve Drives "+(r.reserve||0)),i.createElement("rect",{width:"8",height:"8",y:"72",className:"ae-summary-bar-data-drives"}),i.createElement("text",{x:"16",y:"80"},"Data Drives "+r.data))))}});t.exports=a},{"../../lib/model/aggregates/raid-types":86,"../../lib/units.js":123}],7:[function(e,t,r){"use strict";var i=window.React,s=e("react-router").RouteHandler;var n=i.createClass({displayName:"App",render:function(){return i.createElement("div",{id:"app"},i.createElement(s,i.__spread({},this.props)))}});t.exports=n},{"react-router":162}],8:[function(e,t,r){"use strict";var i=e("./glyph"),s=e("./faglyph"),n=window.React;var a=n.createClass({displayName:"Button",propTypes:{onClick:n.PropTypes.func.isRequired,title:n.PropTypes.string,glyph:n.PropTypes.string,faglyph:n.PropTypes.string,spin:n.PropTypes.bool,alignRight:n.PropTypes.bool},_glyph:function(){if(this.props.faglyph){return n.createElement(s,{name:this.props.faglyph,spin:this.props.spin})}else if(this.props.glyph){return n.createElement(i,{name:this.props.glyph,spin:this.props.spin})}else{return null}},_allClasses:function(){var e={btn:true,"btn-default":true};if(this.props.extraClasses instanceof Array){this.props.extraClasses.forEach(function(t){e[t]=true})}else if(typeof this.props.extraClasses==="string"){this.props.extraClasses.split(" ").forEach(function(t){e[t]=true})}else if(this.props.extraClasses instanceof Object){for(var t in this.props.extraClasses){e[t]=this.props.extraClasses[t]}}return n.addons.classSet(e)},_renderInside:function(){if(this.props.alignRight){return n.createElement("span",null,this._glyph(),this.props.children)}else{return n.createElement("span",null,this.props.children,this._glyph())}},_handleKeyUp:function(e){if(e.key==="Enter"){this.props.onClick()}},render:function(){return n.createElement("div",{className:this._allClasses(),title:this.props.title,tabIndex:0,onClick:this.props.onClick,onKeyUp:this._handleKeyUp},this._renderInside())}});t.exports=a},{"./faglyph":16,"./glyph":19}],9:[function(e,t,r){"use strict";var i=window.React,s=e("./tooltip"),n=e("../../lib/units.js");var a=i.createClass({displayName:"CapacityTooltip",propTypes:{inputValue:i.PropTypes.number,displayUnitsFrom:i.PropTypes.string,inputUnit:i.PropTypes.object},render:function(){var e=this.props.inputUnit||new n(this.props.inputValue,this.props.displayUnitsFrom);return i.createElement(s,{title:this.props.title||"Capacity",position:"left",titleClassName:"right strong"},i.createElement("table",null,i.createElement("tr",null,i.createElement("th",{className:"right"},"Base 2"),i.createElement("th",null),i.createElement("th",{className:"right"},"Base 10")),i.createElement("tr",null,i.createElement("td",{className:"numeric"}," ",t(e.to("GiB"))," GiB"),i.createElement("td",null),i.createElement("td",{className:"numeric"}," ",t(e.to("GB"))," GB")),i.createElement("tr",null,i.createElement("td",{className:"numeric"}," ",t(e.to("TiB"))," TiB"),i.createElement("td",null),i.createElement("td",{className:"numeric"}," ",t(e.to("TB"))," TB"))));function t(e){return e.value.toFixed(3).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}}});t.exports=a},{"../../lib/units.js":123,"./tooltip":45}],10:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./button"),a=e("./constants"),o=e("./layout/column-header"),l=e("./layout/action-link"),c=e("./layout/scrollable-region"),u=e("./repeat");var p=s.createClass({displayName:"SystemRow",propTypes:{system:s.PropTypes.object.isRequired,guard:s.PropTypes.object.isRequired,selector:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired},getInitialState:function(){return{editingName:false,newControllerName1:"",newControllerName2:""}},componentWillReceiveProps:function(e){if(this.props.system._id!==e.system._id){var t=e.system.controllers||[];this.setState({editingName:false,newControllerName1:t[0]?t[0].name||"":"",newControllerName2:t[1]?t[1].name||"":""})}},_editName:function(){var e=this.props.system.controllers||[];this.setState({editingName:true,newControllerName1:e[0]?e[0].name||"":"",newControllerName2:e[1]?e[1].name||"":""},function(){this.refs.controllerNameInput1.getDOMNode().select()})},_saveNewName:function(){if(this.state.newControllerName1&&this.state.newControllerName2){this.setState({editingName:false,newControllerName1:"",newControllerName2:""});if(this.props.system&&this.props.system._id){this.props.fire("PROJECT_NAME_CONTROLLERS",this.props.system._id,this.state.newControllerName1,this.state.newControllerName2)}}else{this._cancelEditName()}},_cancelEditName:function(){var e=this.props.system.controllers||[];this.setState({editingName:false,newControllerName1:e[0]?e[0].name||"":"",newControllerName2:e[1]?e[1].name||"":""})},_captureNewControllerName1:function(e){if(!e.target.value){this.setState({newControllerName1:""})}else if(e.target.value.search("^[A-Za-z0-9_-]+$")!==-1){this.setState({newControllerName1:e.target.value})}},_captureNewControllerName2:function(e){if(!e.target.value){this.setState({newControllerName2:""})}else if(e.target.value.search("^[A-Za-z0-9_.-]+$")!==-1){this.setState({newControllerName2:e.target.value})}},_deleteSystem:function(e,t){t.stopPropagation();t.preventDefault();this.props.fire("PROJECT_REMOVE_SYSTEM",this.props.system._id);if(e){this.props.fire("PROJECT_SET_CLUSTER_VERSION",this.props.system.cluster._id,e)}},_getControllerPairName:function(){var e=i.flatten(this.props.system.controllers||[],"name").join(" / ");return e&&e!==" / "?e:"un-named"},_getRawCapacity:function(){var e=i.reduce(this.props.system.shelves,function(e,t){var r=i.isEmpty(t._x_bom)?[]:t._x_bom.drive_specs,s=i.reduce(r,function(e,t){return e+(t.rawgb||0*t.quantity||0)},0);return e+s},0);return e?(e>999?e/1e3+"TB ":e+"GB ")+" Raw":""},_handleKeyUp:function(e){if(e.key==="Enter"){this._saveNewName()}else if(e.key==="Escape"){this._cancelEditName()}},_renderNameCells:function(e){var t=[];t.push(s.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-middle"},s.createElement("div",{className:"edit-name-box"},s.createElement("input",{type:"text",ref:"controllerNameInput1",value:this.state.newControllerName1,placeholder:"name",onChange:this._captureNewControllerName1,onKeyUp:this._handleKeyUp,className:"form-control"}))));if(e.length>1){t.push(s.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-middle"},s.createElement("div",{className:"edit-name-box"},s.createElement("input",{type:"text",ref:"controllerNameInput2",value:this.state.newControllerName2,placeholder:"name",onChange:this._captureNewControllerName2,onKeyUp:this._handleKeyUp,className:"form-control"}))))}return t},render:function(){if(this.state.editingName){return s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"row-list-cell row-list-cell-xs"}),this._renderNameCells(this.props.system.controllers||[]),s.createElement("div",{className:"row-list-cell row-list-cell-s"}),s.createElement("div",{className:"toolstrip"},s.createElement(n,{faglyph:"check",title:"save changes to project name",onClick:this._saveNewName,extraClasses:{"btn-success":true,"no-border":true}}),s.createElement(n,{faglyph:"times",title:"cancel changes to project name",onClick:this._cancelEditName,extraClasses:{"btn-danger":true,"no-border":true}})))}else{var e=i.clone(this.props.selector),t=i.assign(e,{hagroup:{_id:this.props.system._id}}),r=this.props.guard.deletingSystem(t),a=i.last(r),o=a?a.newVersion:undefined,l=i.partial(this._deleteSystem,o);return s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"row-list-cell row-list-cell-xs"}),s.createElement("div",{className:"row-list-cell row-list-cell-nopad"},s.createElement(n,{faglyph:"trash",title:"remove this system",onClick:l,extraClasses:{"btn-default":true,"no-border":true}})),s.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-middle"},s.createElement("span",null,this._getControllerPairName())),s.createElement("div",{className:"row-list-cell row-list-cell-s row-list-cell-middle hide-contracted"},this._getRawCapacity()),s.createElement("div",{className:"row-list-cell row-list-cell-s"}),s.createElement("span",{className:"toolstrip"},s.createElement(n,{faglyph:"pencil",title:"edit the name of your system",onClick:this._editName,extraClasses:{"btn-default":true,"no-border":true}})))}}});var d=s.createClass({displayName:"NodeCountRow",propTypes:{count:s.PropTypes.number.isRequired,model:s.PropTypes.string.isRequired},render:function(){return s.createElement("div",{className:"row-list-item header"},s.createElement("div",{className:"row-list-cell row-list-cell-m"},s.createElement("div",{className:"drive-summary-block no-overflow emphasize"},s.createElement("span",{className:"drive-count"},this.props.count),s.createElement("span",{className:"fa fa-netapp-controller fa-fw"}),s.createElement("span",{className:"drive-label"},this.props.model))),s.createElement("div",{className:"row-list-cell row-list-cell-m"}))}});var f=s.createClass({displayName:"ModelGroup",propTypes:{modelGroup:s.PropTypes.object.isRequired,guard:s.PropTypes.object.isRequired,selector:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired},_getNodeCounts:function(){var e={};i.forEach(this.props.modelGroup,function(t){var r=e[t.model]||0,i=r+t.controllers.length;e[t.model]=i});return e},_renderRows:function(e,t){return s.createElement(d,{count:e,model:t})},render:function(){return s.createElement("div",null,i.map(this._getNodeCounts(),this._renderRows),s.createElement(u,{seq:this.props.modelGroup,prop:"system"},s.createElement(p,{guard:this.props.guard,selector:this.props.selector,fire:this.props.fire})))}});var h=s.createClass({displayName:"ClusterDetails",propTypes:{cluster:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func,fire:s.PropTypes.func.isRequired,col3View:s.PropTypes.string.isRequired},getInitialState:function(){return{editingName:false,newClusterName:""}},componentWillReceiveProps:function(e){if(this.props.cluster._id!==e.cluster._id){this.setState({editingName:false,newClusterName:e.cluster.name||""})}},_editName:function(){this.setState({editingName:true,newClusterName:this.props.cluster.name||""},function(){this.refs.clusterNameInput.getDOMNode().select()})},_saveNewName:function(){this.setState({editingName:false,newClusterName:""});this.props.fire("PROJECT_NAME_CLUSTER",this.props.cluster._id,this.state.newClusterName)},_cancelEditName:function(){this.setState({editingName:false,newClusterName:this.props.cluster.name||""})},_captureNewName:function(e){if(!e.target.value){this.setState({newClusterName:""})}else if(e.target.value.search("^[A-Za-z0-9_-]+$")!==-1){this.setState({newClusterName:e.target.value})}},_delete:function(e){e.stopPropagation();e.preventDefault();i.forEach(this.props.cluster.hagroups,function(e){this.props.fire("PROJECT_REMOVE_SYSTEM",e._id)},this);this.props.clearSelection()},_handleKeyUp:function(e){if(e.key==="Enter"){this._saveNewName()}else if(e.key==="Escape"){this._cancelEditName()}},_renderNameOrNameInput:function(){if(this.state.editingName){return s.createElement("div",{className:"row-list-item-grouping"},s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"row-list-cell row-list-cell-xs row-list-cell-middle"},s.createElement("span",{className:"emphasize"},"Name")),s.createElement("div",{className:"row-list-cell row-list-cell-m"},s.createElement("div",{className:"edit-name-box"},s.createElement("input",{type:"text",ref:"clusterNameInput",value:this.state.newClusterName,placeholder:"Name the cluster",onChange:this._captureNewName,onKeyUp:this._handleKeyUp,className:"form-control"}))),s.createElement("div",{className:"toolstrip"},s.createElement(n,{faglyph:"check",title:"save changes to cluster name",onClick:this._saveNewName,extraClasses:{"btn-success":true,"no-border":true}}),s.createElement(n,{faglyph:"times",title:"cancel changes to cluster name",onClick:this._cancelEditName,extraClasses:{"btn-danger":true,"no-border":true}}))))}else{return s.createElement("div",{className:"row-list-item-grouping"},s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"row-list-cell row-list-cell-xs row-list-cell-middle"},s.createElement("span",{className:"emphasize"},"Name")),s.createElement("div",{className:"row-list-cell row-list-cell-m"},s.createElement("span",null,this.props.cluster.name||"un-named")),s.createElement("div",{className:"toolstrip"},s.createElement(n,{faglyph:"pencil",title:"edit the name of your cluster",onClick:this._editName,extraClasses:{"btn-default":true,"no-border":true}}))))}},add:function(e){e.stopPropagation();e.preventDefault();var t={productLine:a.PRODUCTLINE_FAS,productSubLine:a.PRODUCTLINE_SUBTYPE_CDOT};this.props.select(t,a.UI_SELECT_ADD_CHANGE_SYSTEMS)},render:function(){var e=i.groupBy(this.props.cluster.hagroups,function(e){return e.model}),t=!i(this.props.cluster.hagroups).any(function(e){return e.controllers.length===1}),r=s.addons.classSet({"row-list-item":true,"new":true,selectable:t,disabled:!t,selected:t&&this.props.col3View===a.UI_SELECT_ADD_CHANGE_SYSTEMS}),n=s.addons.classSet({"row-list-cell":true,"row-list-cell-middle":true,"text-muted":!t}),p=t?this.add:undefined;var d=i.first(this.props.cluster.hagroups),h=d._policies||{},m=h.version||{},g=m.pin?{version:d.version}:{};var y=this.props.map.inspect(this.props.cluster),v={installation:{_id:y.installation._id},cluster:{_id:y.cluster._id}},_=this.props.map.guard(v,g);return s.createElement("div",null,s.createElement(o,{columnTitle:"Cluster Details"},s.createElement(l,{isToggle:false,select:this._delete,selected:false,enabled:true},"Delete")),s.createElement(c,null,s.createElement("div",{className:"hc-cluster"},this._renderNameOrNameInput(),s.createElement("div",{className:"row-list-item-grouping"},s.createElement("div",{className:r,onClick:p},s.createElement("div",{className:"row-list-cell row-list-cell-xs row-list-cell-middle"}),s.createElement("div",{className:n},"Add a new system",s.createElement("span",{className:"hide-contracted"}," to this cluster")),s.createElement("span",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-plus"}))),s.createElement(u,{seq:e,prop:"modelGroup"},s.createElement(f,{guard:_,selector:v,fire:this.props.fire}))))))}});t.exports=h},{"./button":8,"./constants":14,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./repeat":34}],11:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./repeat"),a=e("./system-summary");var o=s.createClass({displayName:"ClusterList",propTypes:{clusters:s.PropTypes.array.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired,fire:s.PropTypes.func.isRequired},render:function(){return s.createElement(n,{seq:this.props.clusters,prop:"cluster",className:"clusters"},s.createElement(l,{currentSelection:this.props.currentSelection,select:this.props.select}))}});var l=s.createClass({displayName:"Cluster",propTypes:{cluster:s.PropTypes.object.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},isSelected:function(e,t){var r=false,s=i(e).has("cluster")?e.cluster._id:"";if(s){var n=t._id||"";r=s===n?true:false}return i(e).has("hagroup")?false:r},selectCluster:function(e){e.stopPropagation();e.preventDefault();var t={cluster:{_id:this.props.cluster._id}};this.props.select(t,"ClusterGrouping")},selectClusterGroup:function(e,t,r){var s={cluster:{_id:this.props.cluster._id}};this.props.select(i.merge(s,e),t,r)},render:function(){var e=this.props.cluster,t=this.props.currentSelection,r=this.isSelected(t,e),o=i.groupBy(e.hagroups,function(e){return e._model}),l=s.addons.classSet({cluster:true,selectable:true,selected:r});return s.createElement("div",{className:l},s.createElement("span",{className:"sub-grouping-label",onClick:this.selectCluster},e.name||"un-named",s.createElement("span",{className:"pull-right action"},"Edit")),s.createElement(n,{seq:i.map(o),prop:"hagroups",className:"standalones"},s.createElement(a,{isGrouped:false,currentSelection:t,select:this.selectClusterGroup})))}});t.exports=o},{"./repeat":34,"./system-summary":44}],12:[function(e,t,r){"use strict";var i=window.React,s=e("../faglyph"),n=e("../button"),a=e("./spinner");var o=i.createClass({displayName:"OptionRow",propTypes:{type:i.PropTypes.string.isRequired,action:i.PropTypes.func,optionName:i.PropTypes.string.isRequired,optionValue:i.PropTypes.any,readOnly:i.PropTypes.bool,minValue:i.PropTypes.any,maxValue:i.PropTypes.any,hide:i.PropTypes.bool},render:function(){var e;if(!!this.props.hide){return null}switch(this.props.type){case"extended":e=i.createElement(l,{optionName:this.props.optionName,readOnly:this.props.readOnly,action:this.props.action});break;case"radio":e=i.createElement(c,{optionName:this.props.optionName,optionValue:this.props.optionValue,readOnly:this.props.readOnly,action:this.props.action});break;case"spinner":e=i.createElement(u,{optionName:this.props.optionName,optionValue:this.props.optionValue,readOnly:this.props.readOnly,action:this.props.action,maxValue:this.props.maxValue,minValue:this.props.minValue});break;case"text":e=i.createElement(p,{optionName:this.props.optionName,readOnly:this.props.readOnly,action:this.props.action});break;default:return null}return e}});var l=i.createClass({displayName:"ExtendedOption",propTypes:{action:i.PropTypes.func,optionName:i.PropTypes.string.isRequired,readOnly:i.PropTypes.bool},render:function(){var e=i.addons.classSet({"row-list-item":true,"row-list-item-option":true,selectable:!!this.props.action&&!this.props.readOnly});return i.createElement("div",{className:e,onClick:!this.props.readOnly?this.props.action:null},i.createElement("div",{className:"row-list-cell"},this.props.optionName),i.createElement("span",{className:"chevron"},i.createElement(s,{name:!this.props.readOnly?"chevron-right":null,hideIfUnnamed:true})))}});var c=i.createClass({displayName:"RadioOption",propTypes:{action:i.PropTypes.func,optionName:i.PropTypes.string.isRequired,optionValue:i.PropTypes.any,readOnly:i.PropTypes.bool},render:function(){var e=i.addons.classSet({"row-list-item":true,"row-list-item-option":true,selectable:!!this.props.action&&!this.props.readOnly});return i.createElement("div",{className:e,onClick:!this.props.readOnly?this.props.action:null},i.createElement("div",{className:"row-list-cell"},this.props.optionName),i.createElement("span",{className:"chevron"},i.createElement(s,{name:!!this.props.optionValue?"check":null,hideIfUnnamed:true,title:"Selected"})))}});var u=i.createClass({displayName:"SpinnerOption",propTypes:{action:i.PropTypes.func.isRequired,optionName:i.PropTypes.string.isRequired,optionValue:i.PropTypes.any,readOnly:i.PropTypes.bool,minValue:i.PropTypes.number,maxValue:i.PropTypes.number},render:function(){var e=i.addons.classSet({"row-list-item":true,"row-list-item-option":true,selectable:false});return i.createElement("div",{className:e},i.createElement("div",{className:"row-list-cell"},this.props.optionName),i.createElement(a,{readOnly:this.props.readOnly,applyValue:this.props.action,value:this.props.optionValue,minValue:this.props.minValue,maxValue:this.props.maxValue}))}});var p=i.createClass({displayName:"TextOption",propTypes:{action:i.PropTypes.func,optionName:i.PropTypes.string.isRequired,readOnly:i.PropTypes.bool},getInitialState:function(){return{editMode:false}},render:function(){var e=i.addons.classSet({"row-list-item":true,"row-list-item-option":true,selectable:!!this.props.action&&!this.props.readOnly});if(this.state.editMode){return i.createElement("div",{className:e},i.createElement("div",{className:"row-list-cell"},i.createElement("input",{onChange:this.props.action,onKeyUp:this.handleKeyUp,type:"text",ref:"textInput",value:this.props.optionName,placeholder:"name",className:"form-control ae-option-input"})),i.createElement("div",{className:"toolstrip"},i.createElement(n,{faglyph:"check",onClick:this.closeEditMode,extraClasses:{"btn-success":true,"no-border":true}})))}return i.createElement("div",{className:e,onClick:!this.props.readOnly?this.openEditMode:null},i.createElement("div",{className:"row-list-cell"},this.props.optionName),i.createElement("span",{className:"chevron"},i.createElement(s,{name:!this.props.readOnly?"pencil":null,hideIfUnnamed:true,title:"Edit"})))},closeEditMode:function(e){if(e){e.stopPropagation();e.preventDefault()}this.setState({editMode:false})},handleKeyUp:function(e){if(e.key==="Enter"||e.key==="Escape"){this.closeEditMode(e)}},openEditMode:function(e){if(e){e.stopPropagation();e.preventDefault()}this.setState({editMode:true},function(){this.refs.textInput.getDOMNode().select()})}});t.exports=o},{"../button":8,"../faglyph":16,"./spinner":13}],13:[function(e,t,r){"use strict";var i=window.React,s=e("../button");var n=i.createClass({displayName:"Spinner",propTypes:{applyValue:i.PropTypes.func.isRequired,value:i.PropTypes.any,readOnly:i.PropTypes.bool,minValue:i.PropTypes.number,maxValue:i.PropTypes.number},render:function(){if(this.props.readOnly){return i.createElement("div",{className:"toolstrip"},i.createElement("div",{className:"row-list-cell"},i.createElement("span",{className:"read-only-value"},this.props.value)))}var e=this.props.maxValue!==undefined?this.props.maxValue:Infinity,t=this.props.minValue!==undefined?this.props.minValue:0;return i.createElement("div",{className:"toolstrip"},i.createElement(s,{faglyph:"minus",onClick:this.decrementValue,extraClasses:{"btn-default":true,"no-border":true,"no-pad-right":true,disabled:this.props.value<=t}}),i.createElement("input",{onChange:this.setValue,type:"text",value:this.props.value,className:"input-count"}),i.createElement(s,{faglyph:"plus",onClick:this.incrementValue,extraClasses:{"btn-default":true,"no-border":true,"no-pad-left":true,disabled:this.props.value>=e}}))},applyValue:function(e){var t=e>this.props.maxValue?this.props.maxValue:e<this.props.minValue?this.props.minValue:e;this.props.applyValue(t)},decrementValue:function(e){if(e){e.stopPropagation();e.preventDefault()}var t=this.props.increment||1;this.applyValue(this.props.value-t)},incrementValue:function(e){if(e){e.stopPropagation();e.preventDefault()}var t=this.props.increment||1;this.applyValue(this.props.value+t)},setValue:function(e){if(e){e.stopPropagation();e.preventDefault()}this.applyValue(e.target.value)}});t.exports=n},{"../button":8}],14:[function(e,t,r){"use strict";t.exports={PRODUCTLINE_FAS:"FAS",PRODUCTLINE_PERF:"Performance",PRODUCTLINE_FLASH:"Enterprise All-Flash",PRODUCTLINE_SUBTYPE_CDOT:"c-mode",PRODUCTLINE_SUBTYPE_7MODE:"7-mode",PRODUCTLINE_SUBTYPE_MCC:"MCC",PRODUCTLINE_SUBTYPE_MC:"MetroCluster",UI_SELECT_ADD_CHANGE_SYSTEMS:"ProductConfigs",UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST:"ShelfList",UI_SELECT_ADD_CHANGE_AGGREGATE:"AggregateBuilder"}},{}],15:[function(e,t,r){"use strict";var i=window.React;var s="drive counts and total raw capacity by type";var n=i.createClass({displayName:"DriveEntry",render:function(){var e=this.props,t="fa fa-fw fa-"+e.glyph,r,s,n,a,o=e.dclassCSS;if(e.rawtb){s=Math.round(e.rawtb);n=Math.abs(e.rawtb-s)>.01&&s<1e3;s=n?"~"+s:s}else{s="";n=""}if(e.count){r=[e.count,e.dclass,"drives;",e.rawtb,"TB total"]}else{r=["No",e.dclass,"drives"]}function l(t){return e.count?t:t+" text-mute"}function c(t){var r=t+" hide";if(e.hideCapacity||e.count===0){return r}else{return t}}if(e.hideIfZero&&!e.count){a="drive-summary-block no-overflow hide"}else{a="drive-summary-block no-overflow"}a=a+" "+o;return i.createElement("div",{className:a,title:r.join(" ")},i.createElement("span",{className:l("drive-count")},e.count||0),i.createElement("span",{className:t}),i.createElement("span",{className:l("drive-label")},e.dclass),i.createElement("span",{className:c("drive-rawtb")},s),i.createElement("span",{className:c("text-mute")},"TB"))}});var a=i.createClass({displayName:"DriveSummary",propTypes:{hideCapacity:i.PropTypes.bool},render:function(){var e=this.props.drives.count,t=this.props.drives.rawtb;return i.createElement("div",{className:this.props.className,title:this.props.title||s},i.createElement(n,{hideIfZero:this.props.hideIfZero,hideCapacity:this.props.hideCapacity,dclass:"Solid-State Drive",glyph:"hdd-o",dclassCSS:"drive-ssd",count:e.SSD,rawtb:t.SSD}),i.createElement(n,{hideIfZero:this.props.hideIfZero,hideCapacity:this.props.hideCapacity,dclass:"Performance HDD",glyph:"hdd-o",dclassCSS:"drive-performance",count:e.performance,rawtb:t.performance}),i.createElement(n,{hideIfZero:this.props.hideIfZero,hideCapacity:this.props.hideCapacity,dclass:"Capacity HDD",glyph:"hdd-o",dclassCSS:"drive-capacity",count:e.capacity,rawtb:t.capacity}))}});t.exports=a},{}],16:[function(e,t,r){"use strict";var i=window.React,s=window._;var n=i.createClass({displayName:"FAGlyph",propTypes:{name:i.PropTypes.string,title:i.PropTypes.string,extraClasses:i.PropTypes.object,spin:i.PropTypes.bool,hideIfUnnamed:i.PropTypes.bool},render:function(){var e={fa:true,"fa-spin":this.props.spin,"fa-fw":true,hide:this.props.hideIfUnnamed&&!this.props.name};s.merge(e,this.props.extraClasses||{});e["fa-"+this.props.name]=true;return i.createElement("span",{title:this.props.title,className:i.addons.classSet(e)})}});t.exports=n},{}],17:[function(e,t,r){"use strict";var i=e("assert"),s=window.React,n=s.addons.classSet,a=e("./button"),o=e("./repeat"),l=e("./faglyph"),c=e("../../lib/model/aggregates/raid-types"),u=e("../../lib/feature-toggles"),p=window._;var d=28,f=2;var h={aggregate:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired,hagi:s.PropTypes.object.isRequired,log:s.PropTypes.func.isRequired};var m=s.createClass({displayName:"AggregateFlashPoolEditor",propTypes:h,render:function(){var e=this.props.aggregate;var t=this.props.hagi.allPhysicalDevices(),r=p(t).map("spec").where({fp_support:true}).where({type:"SSD"}).any();var i=p(e._raid_groups).map("__deviceSpecs").flatten().where("count").map("spec").value(),n=p.filter(i,y),a=p.where(n,{fp_support:false});if(p.all(i,g)){return s.createElement(E,s.__spread({},this.props),s.createElement("p",null,"Flash Pool™ is not required on all-SSD"+" "+"aggregates."))}else if(p.any(a)){var o=p.map(a,v);return s.createElement(E,s.__spread({},this.props),s.createElement("p",null,"The ",_(o)," drives in this"+" "+"aggregate are not supported for Flash Pool™."+" "+"Please select storage showing the flash symbol:",s.createElement(l,{name:"flash",title:"Supports Flash Pool"})))}else if(!r){return s.createElement(E,s.__spread({},this.props),s.createElement("p",null,"None of the shelves in this system contain SSD"+" "+"supported for Flash Pool™. Please select"+" "+"storage showing the flash symbol:",s.createElement(l,{name:"flash",title:"Supports Flash Pool"})))}else{return s.createElement(b,s.__spread({},this.props))}}});function g(e){return e.type==="SSD"}function y(e){return e.type!=="SSD"}function v(e){return e.rawgb+"GB"}function _(e){i(e instanceof Array,"81f97cd7");i.notEqual(e.length,0,"5e008ca5");if(e.length===1){return e}else{e=p.clone(e);var t=e.pop();return[e.join(", "),t].join(" and ")}}var E=s.createClass({displayName:"AggregateFlashPoolEditorDisabled",propTypes:{children:s.PropTypes.element.isRequired},render:function(){return s.createElement("div",{id:"fp-editor"},s.createElement("div",{className:"row-list-item-option-header"},"Flash Pools"),s.createElement(M,null,this.props.children),s.createElement(T,s.__spread({warnIfNone:false},this.props)))}});var b=s.createClass({displayName:"AggregateFlashPoolEditorEnabled",propTypes:{aggregate:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired,hagi:s.PropTypes.object.isRequired,log:s.PropTypes.func.isRequired},getInitialState:function(){return{adding:false}},render:function(){var e=n({"option-header-link":true,disabled:!this._canAdd()}),t=this.state.adding?"Cancel":"Add Storage Pool";return s.createElement("div",{id:"fp-editor"},s.createElement(S,s.__spread({isOpen:this.state.adding,cancel:this._close,fire:w(this.props.fire,this._close)},p.omit(this.props,"fire"))),s.createElement("div",{className:"row-list-item-option-header"},"Flash Pools",this.state.adding?null:s.createElement("a",{className:e,href:"#",onClick:this._toggle},t)),s.createElement(T,s.__spread({warnIfNone:true},this.props)))},_canAdd:function(){return u.FEATURE_FP_MANUAL_ENABLED},_toggle:function(e){e.stopPropagation();e.preventDefault();if(this._canAdd()){this.setState({adding:!this.state.adding})}},_close:function(){this.setState({adding:false})}});function w(e,t){return function r(){try{t.apply(this,arguments)}catch(r){try{console.error("hookFn",t.name,"failed:",r)}catch(i){}}return e.apply(this,arguments)}}var S=s.createClass({displayName:"NewPoolDriveSelector",propTypes:p.merge({cancel:s.PropTypes.func.isRequired,isOpen:s.PropTypes.bool},h),_findAvailableFlashPoolDeviceSpecs:function(){var e=this.props.hagi,t=e.allPhysicalDevices(),r=e.unlockedPhysicalDevices(),i=p.filter(t,A),s=p.filter(r,A);this.props.log.debug("NewPoolDriveSelector",{all:i,available:s});return s},_cancel:function(e){e.stopPropagation();e.preventDefault();this.props.cancel()},render:function(){if(!this.props.isOpen){return null}var e=this._findAvailableFlashPoolDeviceSpecs();return s.createElement("div",null,s.createElement("div",{className:"row-list-item-option-header"},"New Flash Pool",s.createElement("a",{className:"option-header-link",href:"#",onClick:this._cancel},"Cancel")),s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"fp-drive-choice"},s.createElement("table",null,s.createElement("thead",null,s.createElement("tr",{className:"row-list-item"},s.createElement("th",{className:"row-list-cell right"},"Size"),s.createElement("th",{className:"row-list-cell right"},"Count"),s.createElement("th",{className:"row-list-cell right"},"Available",s.createElement("sup",null," *")))),s.createElement(o,{type:"tableRow",seq:e,prop:"deviceSpec"},s.createElement(C,s.__spread({},this.props))),s.createElement("tfoot",null,s.createElement("tr",{className:"row-list-item no-border"},s.createElement("td",{className:"row-list-cell",colSpan:"3"},s.createElement("p",{className:"fp-foot"},s.createElement("span",{className:"fp-foot-hang-left"},"*"),"SSDs used by an auto-filled aggregate"+" "+"are considered available."))))))))
}});function A(e){return e.spec.fp_support&&e.spec.type==="SSD"}var C=s.createClass({displayName:"FlashPoolDriveRow",propTypes:p.merge({deviceSpec:s.PropTypes.object.isRequired},h),_addStoragePool:function(e){e.stopPropagation();e.preventDefault();var t=this.props.deviceSpec.devices.length,r=Math.min(t-1,d),i=r>2?(new c).RAID_DP:(new c).RAID_4;this.props.fire("PROJECT_FP_ADD_POOL",this.props.aggregate._controller,this.props.deviceSpec.spec,i,r)},render:function(){var e=this.props.deviceSpec.devices.length,t={"row-list-item":true,selectable:e>=3};return s.createElement("tr",{className:n(t),onClick:this._addStoragePool},s.createElement("td",{className:"row-list-cell right"},this.props.deviceSpec.spec.rawgb+"GB "+this.props.deviceSpec.spec.type),s.createElement("td",{className:"row-list-cell right"},e),s.createElement("td",{className:"row-list-cell right"},e))}});var T=s.createClass({displayName:"FlashPools",propTypes:p.merge({warnIfNone:s.PropTypes.bool},h),render:function(){var e=p(this.props.hagi.hagroup.controllers).where("storage_pools").flatten("storage_pools").value(),t=p(this.props.hagi.hagroup.controllers).map("aggregates").filter().flatten().map("_raid_groups").filter().flatten().where({cache:true}).where(function i(e){var t=e.__deviceSpecs[0].spec,r=t._slice_name||t.slice;return!r}).value(),r=e.concat(t);this.props.log.debug("FlashPools.render",{pools:e,olds:t,all:r});if(r.length){return s.createElement(o,{id:"fp-existing-pools",seq:r,key:R,prop:"item"},s.createElement(k,s.__spread({},this.props)))}else if(this.props.warnIfNone){return s.createElement(M,null,s.createElement("p",null,"There are no Flash Pool™ aggregates or"+" "+"storage pools on this system."))}else{return null}}});function R(e){return e._id}var P=s.createClass({displayName:"AllocationUnit",propTypes:p.merge({allocation:s.PropTypes.object.isRequired},h),_getAggregateName:function(e){if(!e){return"unclaimed"}try{var t=this.props.hagi.inspect({_type:"aggregate",_id:e});return t.aggregate.name}catch(r){this.props.log(["fp","aggregate-find"],{err:r,id:e});return"?"}},render:function(){var e=this.props.allocation.aggr_id,t=this._getAggregateName(e),r=!!e,i=e===this.props.aggregate._id,n=this.props.aggregate._manual;var a=s.addons.classSet({"fp-allocation-slice-claimed-manual":r&&n,"fp-allocation-slice-claimed-unclaimed":!r,"fp-allocation-slice-claimed-current":i,"fp-allocation-slice-claimed-auto":r&&!n,"fp-allocation-slice":true});return s.createElement("div",{className:a},s.createElement("span",{className:"inner"},t))}});var N=s.createClass({displayName:"AllocationClaimer",propTypes:p.merge({allocations:s.PropTypes.array.isRequired,isSliced:s.PropTypes.bool.isRequired},h),render:function(){var e="fp-allocation-block",t,r=p.pick(this.props,p.keys(h));if(this.props.isSliced){t=s.createElement(o,{seq:this.props.allocations,prop:"allocation"},s.createElement(P,s.__spread({},r)))}else{t=s.createElement("div",{className:"fp-allocation-unsliced"},s.createElement("p",null,"?"))}return s.createElement("div",{className:e},t)}});var D=s.createClass({displayName:"PoolAdjuster",propTypes:p.merge({item:s.PropTypes.object.isRequired,canExpand:s.PropTypes.func.isRequired,canShrink:s.PropTypes.func.isRequired,expand:s.PropTypes.func.isRequired,shrink:s.PropTypes.func.isRequired},h),render:function(){var e=this.props.item,t=e.__deviceSpecs[0].spec,r=t.rawgb+"GB "+t.type,i=this.props.canExpand(),n=this.props.canShrink(),o=i?this.props._expand:this._noop,l=n?this.props._shrink:this._noop,c=s.addons.classSet({fa:true,"fa-fw":true,"fa-toggle-on":true}),u=null;if(e._type==="storage_pool"){u=s.createElement("div",{className:"fp-allocation-option"},s.createElement("span",{className:"option-title"},"Partitioned "),s.createElement("span",{className:c}))}return s.createElement("div",{className:"fp-allocation-options"},s.createElement(a,{onClick:l,faglyph:"minus",extraClasses:{"btn-default":true,"no-border":true,"no-pad-right":true,disabled:!n}}),s.createElement("input",{type:"text",value:e._devices.length,readOnly:"true",className:"input-count"}),s.createElement(a,{onClick:o,faglyph:"plus",extraClasses:{"btn-default":true,"no-border":true,"no-pad-left":true,disabled:!i}}),s.createElement("div",{className:"fp-allocation-option"},r),u)},_noop:function(e){e.stopPropagation();e.preventDefault()},_shrink:function(e){e.stopPropagation();e.preventDefault();this.props.shrink()},_expand:function(e){e.stopPropagation();e.preventDefault();this.props.expand()}});var x=s.createClass({displayName:"PoolDeleter",propTypes:p.merge({allocationType:s.PropTypes.string.isRequired,deleteMe:s.PropTypes.func.isRequired},h),render:function(){if(this.props.allocationType==="manual"){return s.createElement("div",{className:"fp-allocation-remove-block"},s.createElement(a,{onClick:this._deletePool,faglyph:"trash",extraClasses:{"btn-default":true,"no-border":true,"no-pad-left":true,"no-pad-right":true}}))}else{return s.createElement("div",{className:"fp-allocation-remove-block"})}},_deletePool:function(e){e.stopPropagation();e.preventDefault();this.props.deleteMe()}});var k=s.createClass({displayName:"AppropriateRow",propTypes:p.merge({item:s.PropTypes.object.isRequired},h),render:function(){var e=this.props.item,t=p.omit(this.props,"item");switch(e._type){case"storage_pool":return s.createElement(I,s.__spread({pool:e},t));case"raidgroup":return s.createElement(O,s.__spread({raidGroup:e},t));default:this.props.log.debug("missing _type; bad raid group?");return null}}});var O=s.createClass({displayName:"RaidGroupRow",propTypes:p.merge({raidGroup:s.PropTypes.object.isRequired},h),render:function(){var e=this.props.raidGroup,t=this.props.hagi.inspect(e),r=t.aggregate,i=r._manual,a=i?"manual":"auto",o=r._id===this.props.aggregate._id,l=n({"fp-allocation-unsliced":true,"fp-allocation-slice-claimed-manual":i,"fp-allocation-slice-claimed-current":o,"fp-allocation-slice-claimed-auto":!i,"fp-allocation-slice":true});return s.createElement("div",{className:"row-list-item fp-allocation-row"},s.createElement(x,s.__spread({allocationType:a,deleteMe:this._deleteMe},this.props)),s.createElement("div",{className:"fp-allocation-block"},s.createElement("div",{className:l},s.createElement("span",{className:"inner"},r.name))),s.createElement(D,s.__spread({item:this.props.raidGroup,canExpand:this._canExpand,canShrink:this._canShrink,expand:this._expand,shrink:this._shrink},this.props)))},_deleteMe:function(){this.props.fire("PROJECT_FP_DEL_AGGR_RG",this.props.raidGroup._id)},_canExpand:function(){return u.FEATURE_FP_MANUAL_ENABLED&&this.props.pool._devices.length<d&&this._anyMoreOfTheseDrivesAvailable()},_canShrink:function(){return u.FEATURE_FP_MANUAL_ENABLED&&false},_anyMoreOfTheseDrivesAvailable:function(){return false},_expand:function(){if(!this._canExpand()){return}this.props.log.error("expanding FP raid groups not implemented");return},_shrink:function(){if(!this._canShrink()){return}this.props.log.error("shrinking FP raid groups not implemented");return}});var I=s.createClass({displayName:"PoolRow",propTypes:p.merge({pool:s.PropTypes.object.isRequired},h),render:function(){var e=this.props.pool,t=e._manual===false?"auto":"manual",r=true;this.props.log.debug("PoolRow: this.props.pool",this.props.pool);return s.createElement("div",{className:"row-list-item fp-allocation-row"},s.createElement(x,s.__spread({allocationType:t,deleteMe:this._deleteMe},this.props)),s.createElement(N,s.__spread({isSliced:r,allocations:e._allocations},this.props)),s.createElement(D,s.__spread({item:this.props.pool,canExpand:this._canExpand,canShrink:this._canShrink,expand:this._expand,shrink:this._shrink},this.props)))},_deleteMe:function(){this.props.fire("PROJECT_FP_DEL_POOL",this.props.pool._id)},_canExpand:function(){return u.FEATURE_FP_MANUAL_ENABLED&&this.props.pool._devices.length<d&&this._anyMoreOfTheseDrivesAvailable()},_canShrink:function(){return u.FEATURE_FP_MANUAL_ENABLED&&false},_anyMoreOfTheseDrivesAvailable:function(){return false},_expand:function(){if(!this._canExpand()){return}var e=this.props.pool,t=e._devices.length,r=t+1;i(r<=d,"You cannot expand the pool above threshold");this.props.fire("PROJECT_FP_RESIZE_POOL",e._id,r)},_shrink:function(){if(!this._canShrink()){return}var e=this.props.pool,t=e._devices.length,r=t-1;i(r>=f,"You cannot shrink the pool below threshold");this.props.fire("PROJECT_FP_RESIZE_POOL",e._id,r)}});var M=s.createClass({displayName:"SingleCellOrganism",propTypes:{children:s.PropTypes.element.isRequired},render:function(){return s.createElement("div",{className:"row-list-item"},s.createElement("div",{className:"row-list-cell"},this.props.children))}});t.exports=m},{"../../lib/feature-toggles":71,"../../lib/model/aggregates/raid-types":86,"./button":8,"./faglyph":16,"./repeat":34,assert:127}],18:[function(e,t,r){"use strict";var i=window.React;var s=i.createClass({displayName:"Footer",render:function(){return i.createElement("div",{id:"footer"},i.createElement("div",{className:"container-fluid"},i.createElement("p",null,i.createElement("strong",null,"PRE-ALPHA. IN EARLY DEVELOPMENT. "),"Contacts: Changjie Sun, Mark Sibert, Garth Kidd.")))}});t.exports=s},{}],19:[function(e,t,r){"use strict";var i=window.React,s=window._;var n=i.createClass({displayName:"Glyph",propTypes:{name:i.PropTypes.string,title:i.PropTypes.string,extraClasses:i.PropTypes.object,spin:i.PropTypes.bool},render:function(){var e={glyphicon:true,spin:this.props.spin};s.merge(e,this.props.extraClasses||{});e["glyphicon-"+this.props.name]=true;return i.createElement("span",{title:this.props.title,className:i.addons.classSet(e)})}});t.exports=n},{}],20:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/column"),a=e("./aggregate-editor"),o=e("./cluster-details"),l=e("./installation-list"),c=e("./placeholder"),u=e("./product-configs"),p=e("./product-lines"),d=e("./reports"),f=e("./shelf-list"),h=e("./system-overview"),m=e("./version-list"),g=e("../usual-props"),y=e("./constants"),i=window._;var v=s.createClass({displayName:"Hardware",propTypes:i.defaults({projectId:s.PropTypes.string.isRequired,selected:s.PropTypes.object.isRequired,productInfo:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired},g.isRequired),componentDidMount:function(){window.addEventListener("keyup",this.handleKeyUp)},componentWillUnmount:function(){window.removeEventListener("keyup",this.handleKeyUp)},handleKeyUp:function(e){if(e.which===27){this.closeCol3(e)}},closeCol3:function(e){e.stopPropagation();e.preventDefault();var t=this.props.selected.selector,r=i.pick(t,["installation","cluster","hagroup"]),s=this.props.selected.col2View;this.props.fire("HARDWARE_SELECT",this.props.projectId,r,s,null)},resolveCol2Selection:function(){var e=this.props.selected.selector;var t=i.pick(e,["installation","cluster","hagroup"]);var r=this.props.map.resolveSelection(t);return r.length?r:null},resolveCol3Selection:function(){var e=this.props.map.resolveSelection(this.props.selected.selector);return e.length?e:null},render:function(){var e=this.resolveCol2Selection(),t=this.resolveCol3Selection(),r=!!(t&&this.props.selected.col3View);var a=i.isEmpty(t)?null:this.props.selected.col3View;return s.createElement("div",{id:"hardware-view"},s.createElement(n,{expanded:true,lightTheme:true,expandedWidth:"2",collapsedWidth:"2",zIndex:3},s.createElement(l,s.__spread({installations:this.props.map.installations,selected:this.props.selected,projectId:this.props.projectId},g(this.props)))),s.createElement(n,{expanded:!r,lightTheme:false,expandedWidth:"6",collapsedWidth:"3",onClick:this.closeCol3,zIndex:2},s.createElement(_,s.__spread({items:e,selected:this.props.selected,projectId:this.props.projectId,userPreferences:this.props.userPreferences,platformConfig:this.props.productInfo,col3View:a},g(this.props)))),s.createElement(n,{expanded:r,lightTheme:!r,expandedWidth:"7",collapsedWidth:"4",zIndex:3},s.createElement(E,s.__spread({items:t,installations:this.props.map.installations,selectedItem:e,selected:this.props.selected,projectId:this.props.projectId,userPreferences:this.props.userPreferences,platformConfig:this.props.productInfo,closeSelf:this.closeCol3,view:a},g(this.props)))))}});var _=s.createClass({displayName:"DetailsLevel2",propTypes:i.defaults({items:s.PropTypes.array.isRequired,selected:s.PropTypes.object.isRequired,projectId:s.PropTypes.string.isRequired,userPreferences:s.PropTypes.object.isRequired,platformConfig:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired,col3View:s.PropTypes.string},g),clearSelection:function(){this.props.fire("HARDWARE_CLEAR")},selectHardware:function(e,t){var r=i.pick(this.props.selected.selector,["installation","cluster","hagroup"]),s=i.merge(i.clone(r),e),n=this.props.selected.col2View;var a=t&&t===this.props.selected.col3View,o=i.isEqual(this.props.selected.selector,s);t=a&&o?null:t;s=t?s:r;this.props.fire("HARDWARE_SELECT",this.props.projectId,s,n,t)},selectCol2View:function(e){var t=this.props.selected.selector,r=this.props.selected.col3View;this.props.fire("HARDWARE_SELECT",this.props.projectId,t,e,r)},render:function(){var e=this.props.items,t=i.isEmpty(e)?null:this.props.selected.col2View;console.log("DetailsLevel2 items:",e,"view:",t);if(t==="SystemOverview"||t==="Aggregates"||t==="Policies"){return s.createElement(h,s.__spread({systems:e,select:this.selectHardware,clearSelection:this.clearSelection,selectDetails:this.props.selected.selector,userPreferences:this.props.userPreferences,col3View:this.props.col3View,col2Tab:t,selectCol2View:this.selectCol2View},g(this.props)))}else if(t==="ClusterGrouping"){return s.createElement(o,s.__spread({cluster:e[0],select:this.selectHardware,clearSelection:this.clearSelection,col3View:this.props.col3View},g(this.props)))}else if(t==="ProductLines"){return s.createElement(p,s.__spread({installation:e[0],productInfo:this.props.platformConfig,select:this.selectHardware,clearSelection:this.clearSelection},g(this.props)))}else{return s.createElement(c,null)}}});var E=s.createClass({displayName:"DetailsLevel3",propTypes:i.defaults({items:s.PropTypes.array.isRequired,installations:s.PropTypes.array.isRequired,selectedItem:s.PropTypes.array.isRequired,selected:s.PropTypes.object.isRequired,projectId:s.PropTypes.string.isRequired,userPreferences:s.PropTypes.object.isRequired,platformConfig:s.PropTypes.object.isRequired,closeSelf:s.PropTypes.func.isRequired,view:s.PropTypes.string},g),render:function(){var e=this.props.items,t=this.props.view;console.log("DetailsLevel3 items:",e,"view:",t);if(t===y.UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST){return s.createElement(f,s.__spread({selection:e,selectedItem:this.props.selectedItem,selectDetails:this.props.selected.selector,onClose:this.props.closeSelf},g(this.props)))}else if(t===y.UI_SELECT_ADD_CHANGE_SYSTEMS){return s.createElement(u,s.__spread({selection:e[0],selectDetails:this.props.selected.selector,productInfo:this.props.platformConfig,projectId:this.props.projectId,onClose:this.props.closeSelf},g(this.props)))}else if(t===y.UI_SELECT_ADD_CHANGE_AGGREGATE){return s.createElement(a,s.__spread({selection:e,platformConfig:this.props.platformConfig,selectedItem:this.props.selectedItem,selected:this.props.selected,onClose:this.props.closeSelf,userPreferences:this.props.userPreferences,installations:this.props.installations},g(this.props)))}else if(t==="VersionList"){return s.createElement(m,s.__spread({hagroups:e,hardwareSelector:this.props.selected.selector,handleClose:this.props.closeSelf},g(this.props)))}else{return s.createElement(d,s.__spread({selectedItem:this.props.selectedItem,installations:this.props.installations,userPreferences:this.props.userPreferences,projectId:this.props.projectId},g(this.props)))}}});t.exports=v},{"../usual-props":51,"./aggregate-editor":5,"./cluster-details":10,"./constants":14,"./installation-list":22,"./layout/column":25,"./placeholder":29,"./product-configs":30,"./product-lines":31,"./reports":35,"./shelf-list":39,"./system-overview":42,"./version-list":46}],21:[function(e,t,r){"use strict";var i=window.React,s=e("./faglyph");var n=i.createClass({displayName:"ShelfDriveGroupSummary",propTypes:{driveGroup:i.PropTypes.object.isRequired,fpSupport:i.PropTypes.bool.isRequired,shelfCount:i.PropTypes.number.isRequired},_shortenedCapacityString:function(e){return e>999?e/1e3+"TB":e+"GB"},_iconForDriveType:function(e){switch(e.type){case"SATA":return"hdd-o";case"FC":return"hdd-o";case"SAS":return"hdd-o";case"SSD":return"hdd-o";case"MSATA":return"hdd-o";case"NL-SAS":return"hdd-o";default:return"hdd-o"}},_classNameForDriveType:function(e){switch(e.rpm){case 10:return"text-blue";case 15:return"text-green";case 50:return"text-purple";default:return""}},render:function(){var e=this.props.shelfCount,t=this.props.driveGroup,r=t.encrypted?"key":"",n=this.props.fpSupport?"flash":"";console.log("DEBUG: shelfDrivesGroup",t);return i.createElement("div",{className:"drive-summary-block"},i.createElement("span",{className:"drive-count"},t.quantity*e),i.createElement("span",{className:this._classNameForDriveType(t)},i.createElement(s,{name:this._iconForDriveType(t)})),i.createElement("span",{className:"drive-label-size"},this._shortenedCapacityString(t.rawgb),i.createElement("span",{className:"hide-contracted drive-type"},t.type)),i.createElement("span",{className:"hide-contracted"},i.createElement(s,{name:n,hideIfUnnamed:"true",title:"Supports Flash Pool"}),i.createElement(s,{name:r,hideIfUnnamed:"true",title:"Encrypted"})))}});t.exports=n},{"./faglyph":16}],22:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/column-header"),a=e("./layout/action-link"),o=e("./layout/scrollable-region"),l=e("./repeat"),c=e("./cluster-list"),u=e("./system-list");var p=s.createClass({displayName:"InstallationList",propTypes:{installations:s.PropTypes.array.isRequired,selected:s.PropTypes.object.isRequired,projectId:s.PropTypes.string.isRequired,fire:s.PropTypes.func.isRequired},selectSystems:function(e,t,r){this.props.fire("HARDWARE_SELECT",this.props.projectId,e,t,r)},addSystem:function(e){e.stopPropagation();e.preventDefault();var t={installation:{_id:this.props.installations[0]._id}},r="ProductLines";this.selectSystems(t,r)},render:function(){return s.createElement("div",null,s.createElement(n,{columnTitle:"Systems"},s.createElement(a,{isToggle:false,select:this.addSystem,selected:false,enabled:true},"Add")),s.createElement(o,null,s.createElement(l,{seq:this.props.installations,prop:"installation",className:"installations"},s.createElement(d,{currentSelection:this.props.selected.selector||{},select:this.selectSystems,fire:this.props.fire}))))}});var d=s.createClass({displayName:"Installation",propTypes:{installation:s.PropTypes.object.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired,fire:s.PropTypes.func.isRequired},selectInstallation:function(e,t,r){var s={installation:{_id:this.props.installation._id}};this.props.select(i.merge(s,e),t,r)},render:function(){return s.createElement("div",{className:"installation"},s.createElement("span",{className:"group-type-label"},"Clusters"),s.createElement(c,{clusters:this.props.installation.clusters,currentSelection:this.props.currentSelection,select:this.selectInstallation,fire:this.props.fire}),s.createElement("span",{className:"group-type-label"},"Non-Clusters"),s.createElement(u,{hagroups:this.props.installation.hagroups,isStandAlone:true,currentSelection:this.props.currentSelection,select:this.selectInstallation}))}});t.exports=p},{"./cluster-list":11,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./repeat":34,"./system-list":40}],23:[function(e,t,r){"use strict";var i=window.React;var s=i.createClass({displayName:"ActionLink",propTypes:{isToggle:i.PropTypes.bool.isRequired,select:i.PropTypes.func.isRequired,selected:i.PropTypes.bool.isRequired,enabled:i.PropTypes.bool.isRequired},render:function(){var e=i.addons.classSet({"action-link":true,selected:this.props.selected,disabled:!this.props.enabled,toggle:this.props.isToggle,"hide-contracted":this.props.hideContracted});if(this.props.enabled){return i.createElement("span",{className:e,onClick:this.props.select},this.props.children)}else{return i.createElement("span",{className:e},this.props.children)}}});t.exports=s},{}],24:[function(e,t,r){"use strict";var i=window.React;var s=i.createClass({displayName:"ColumnHeader",propTypes:{columnTitle:i.PropTypes.string},render:function(){return i.createElement("div",{className:"column-header"},i.createElement("h1",null,this.props.columnTitle),i.createElement("div",{className:"action-links"},this.props.children))}});t.exports=s},{}],25:[function(e,t,r){"use strict";var i=window.React;var s=i.createClass({displayName:"Column",propTypes:{expanded:i.PropTypes.bool,expandedWidth:i.PropTypes.string,collapsedWidth:i.PropTypes.string,lightTheme:i.PropTypes.bool,onClick:i.PropTypes.func,zIndex:i.PropTypes.number},render:function(){var e="col-xs-"+this.props.expandedWidth,t="col-xs-"+this.props.collapsedWidth,r={column:true,"contracted-view":!this.props.expanded,"expanded-view":this.props.expanded,"column-light":this.props.lightTheme};if(this.props.expanded){r[e]=true}else{r[t]=true}var s=i.addons.classSet(r),n={zIndex:this.props.zIndex};return i.createElement("div",{className:s,style:n,onClick:this.props.onClick},this.props.children)}});t.exports=s},{}],26:[function(e,t,r){"use strict";var i=window.React;var s=i.createClass({displayName:"ScrollableRegion",propTypes:{top:i.PropTypes.string},render:function(){var e={top:this.props.top};return i.createElement("div",{className:"scrollable",style:e},this.props.children)}});t.exports=s},{}],27:[function(e,t,r){"use strict";var i=window.React,s={branch:"develop",revision:"f0ddda9b12d8",dirty:"unknown",datetime:"Tue, 17 Mar 2015 02:26:01 GMT"},n=e("react-router").Link;var a=i.createClass({displayName:"Masthead",propTypes:{title:i.PropTypes.string,store:i.PropTypes.object.isRequired},getInitialState:function(){return this.props.store.getState()},componentDidMount:function(){this.props.store.watch(this._onChange)},componentWillUnmount:function(){this.props.store.unwatch(this._onChange)},_onChange:function(){this.setState(this.props.store.getState())},_title:function(){if(this.props.title){return i.createElement("span",{className:"current"},this.props.title)}},render:function(){var e="",t="";if(s.branch==="master"){e=i.createElement("div",{className:"beta-text"},"BETA 3")}if(this.state.firstName!==""){t=i.createElement("div",{className:"user-info"},"Welcome, ",this.state.firstName)}return i.createElement("header",{id:"masthead"},i.createElement("div",{className:"logo"},i.createElement("img",{src:"/media/img/na_logo.png",alt:"Logo"})),i.createElement("div",{className:"breadcrumb-nav"},i.createElement(n,{title:"Return to Synergy: My Portfolio",to:"/",className:"home-link"},"Synergy 6"),this._title()),e,i.createElement("div",{id:"headerUtilitiesDiv",className:"headerUtilities header-nav"},i.createElement("ul",null,i.createElement("li",null,i.createElement(n,{title:"Return to Synergy: My Portfolio",to:"/",className:"headerButtonIcon"},i.createElement("span",{className:"fa fa-home fa-fw"}))),i.createElement("li",null,i.createElement("a",{id:"informationSection",href:"#",title:"Information",className:"infoCls headerButtonIcon"},i.createElement("span",{className:"fa fa-info-circle fa-fw"})),i.createElement("div",{className:"headerSubMenu"},i.createElement("div",{className:"subMenuHeader"}," Information "),i.createElement("ul",null,i.createElement("li",null,i.createElement("a",{href:"https://private-communities.netapp.com/docs/DOC-35424",target:"_blank"},"Release Notes")),i.createElement("li",null,i.createElement("a",{href:"http://www.netapp.com/us/communities/subscriptions.aspx",target:"_blank"},"Subscription Center"))),i.createElement("div",{className:"subMenuHeader"},"Quick Links"),i.createElement("ul",null,i.createElement("li",null,i.createElement("a",{href:"https://fieldportal.netapp.com/funded-tools-a-z.aspx",target:"_blank"},"NetApp Funded Technical Tools")),i.createElement("li",null,i.createElement("a",{href:"http://synergy5.netapp.com/",target:"_blank"},"Synergy 5"))))),i.createElement("li",null,i.createElement("a",{id:"communitySection",href:"https://communities.netapp.com/community/netapp_partners_network/netapp_tools/synergy",title:"Community",className:"commCls headerButtonIcon",target:"_blank"},i.createElement("span",{className:"fa fa-users fa-fw"})),i.createElement("div",{className:"headerSubMenu"},i.createElement("ul",null,i.createElement("li",null,i.createElement("a",{href:"https://communities.netapp.com/community/netapp_partners_network/netapp_tools/synergy",target:"_blank"},"Community")),i.createElement("li",null,i.createElement("a",{href:"https://twitter.com/netapptools",target:"_blank"},"@NetApp Tools")),i.createElement("li",null,i.createElement("a",{href:"https://www.surveymonkey.com/s/QP83YWB",target:"_blank"},"Rate This Tool"))))),i.createElement("li",null,i.createElement("a",{id:"faqSection",href:"#",className:"faqCls headerButtonIcon",title:"FAQ"},i.createElement("span",{className:"fa fa-book fa-fw"})),i.createElement("div",{className:"headerSubMenu"},i.createElement("ul",null,i.createElement("li",null,i.createElement("a",{href:"https://private-communities.netapp.com/docs/DOC-35044",target:"_blank"},"Synergy 6 FAQ")),i.createElement("li",null,i.createElement("a",{href:"#"},"User Guide (coming soon)"))))),i.createElement("li",null,i.createElement("a",{id:"supportSection",href:"https://track.netapp.com/Ticket/synergyweb/42",className:"contactCls headerButtonIcon",title:"Support",target:"_blank"},i.createElement("span",{className:"fa fa-headphones fa-fw"})),i.createElement("div",{className:"headerSubMenu"},i.createElement("ul",null,i.createElement("li",null,i.createElement("a",{href:"https://track.netapp.com/Ticket/synergyweb/42",target:"_blank"},"Support")))))),t))}});t.exports=a},{"react-router":162}],28:[function(e,t,r){"use strict";var i=window.React,s=e("./glyph");var n=i.createClass({displayName:"MOTD",propTypes:{stores:i.PropTypes.object.isRequired},getInitialState:function(){return this.props.stores.motd.getState()},componentDidMount:function(){this.props.stores.motd.watch(this._onChange)},componentWillUnmount:function(){this.props.stores.motd.unwatch(this._onChange)},_glyph:function(){if(!this.state.fetching){return null}return i.createElement(s,{name:"refresh",spin:true,extraClasses:{"pull-right":true}})},_content:function(){if(this.state.fetching){return this._glyph()}if(this.state.err){console.log("MOTD error:",this.state.err.message);return i.createElement("div",null,i.createElement("p",null,"Welcome to the fully redesigned Synergy. Being a BETA, this version will undergo a bit more change prior to GA release.",i.createElement("br",null),i.createElement("br",null),"Please explore the tool and provide ",i.createElement("a",{href:"https://track.netapp.com/Ticket/synergyweb/42",target:"_blank"},"feedback"),".",i.createElement("br",null),i.createElement("br",null),"Be aware that projects in the BETA version of My Portfolio may or may not transition into the final release."+" "+"Click ",i.createElement("a",{href:"https://private-communities.netapp.com/docs/DOC-35044",target:"_blank"},"here")," for more information."),"Known Bugs:",i.createElement("ul",null,i.createElement("li",null,"Session expires after 1 hour. If Synergy becomes unresponsive, click Refresh to login and reestablish a session."),i.createElement("li",null,'When "Automatically fill system with aggregates" is disabled,  Auto-aggregates are still created when new drives are added.'),i.createElement("li",null,"Shelves/drives are not allowed to be deleted if a manual aggregate is assigned to it. Ideally we should allow user to do that and reassign the aggregate to other free drives."),i.createElement("li",null,"Firefox browsers yield an “Unresponsive script” message upon first access. Click the Continue button to access Synergy for full functionality.")),i.createElement("p",null,"Click ",i.createElement("a",{href:"https://private-communities.netapp.com/docs/DOC-35424",target:"_blank"},"release notes")," for more details."))}return i.createElement("div",null,this.state.content||i.createElement("p",null,"No news is good news."))},render:function(){return i.createElement("div",null,i.createElement("strong",null,"Message of the Day"),this._glyph(),i.createElement("br",null),this._content())},_onChange:function(){this.setState(this.props.stores.motd.getState())}});t.exports=n},{"./glyph":19}],29:[function(e,t,r){"use strict";var i=window.React,s={branch:"develop",revision:"f0ddda9b12d8",dirty:"unknown",datetime:"Tue, 17 Mar 2015 02:26:01 GMT"};var n=i.createClass({displayName:"Placeholder",render:function(){var e=s.branch,t=s.datetime,r=s.revision.substring(0,12);var n=e==="master"?"":t+" "+e+":"+r;return i.createElement("div",{className:"placeholder-pane"},"Make a selection to the left to get started.",i.createElement("br",null),i.createElement("span",{className:"version-info-text"},n))}});t.exports=n},{}],30:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/column-header"),a=e("./layout/action-link"),o=e("./layout/scrollable-region"),l=e("./constants"),c=e("./tooltip"),u=e("./button"),p=e("../../lib/constants.js");var d=p.CONFIG_GROUPS;var f=s.createClass({displayName:"ProductConfigs",propTypes:{selection:s.PropTypes.object.isRequired,selectDetails:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired,productInfo:s.PropTypes.object.isRequired,projectId:s.PropTypes.string.isRequired,onClose:s.PropTypes.func},getInitialState:function(){return{showEoa:false,configFilters:{isSellable:true,isHA:true}}},componentWillReceiveProps:function(e){if(!i.isEqual(this.props.selectDetails,e.selectDetails)){this.setState({showEoa:false,configFilters:{isSellable:true,isHA:true}})}},componentDidMount:function(){if(this.refs.FilterFasMultiNodeCluster){this.refs.FilterFasMultiNodeCluster.getDOMNode().setAttribute("checked","checked")}else if(this.refs.filterESeriesDuplex){this.refs.filterESeriesDuplex.getDOMNode().setAttribute("checked","checked")}},_filterConfigs:function(e,t){return i.isEmpty(t)?i.where(e):i.where(e,t)},_fixSelectionAfterAdd:function(e,t){if(e){return console.error(e)}var r=i.pick(this.props.selectDetails,"installation"),s=i.merge(r,{hagroup:{_id:t._id}}),n="SystemOverview";if(t.cluster&&t.cluster._id){s=i.merge(s,{cluster:{_id:t.cluster._id},hagroup:{_model:t._model}})}this.props.fire("HARDWARE_SELECT",this.props.projectId,s,n,null)},addSystem:function(e,t,r,s){s.stopPropagation();var n=e.buildSpec(t,r),a=n[0];if(e.groupId===l.PRODUCTLINE_SUBTYPE_CDOT){var o=this.props.fire,c=i(this.props.selectDetails).has("cluster")?true:false;if(c){o("PROJECT_EXPAND_CLUSTER",this.props.selection._id,a);this._close(s)}else{o("PROJECT_ADD_CLUSTER",a,this._fixSelectionAfterAdd)}}else{this.props.fire("PROJECT_ADD_STANDALONE",a,this._fixSelectionAfterAdd)}},changeSystem:function(e,t,r,s){s.stopPropagation();var n=this.props,a=e.buildSpec(t,r),o=i.merge(n.selectDetails,{hagroup:{_model:e.configModel}});n.fire("PROJECT_CHANGE_SYSTEMS",a);n.fire("HARDWARE_SELECT",n.projectId,o,"SystemOverview",null)},_close:function(e){this.props.onClose(e)},_showDetails:function(e,t){t.stopPropagation();this.setState({currentSystemHover:e})},render:function(){var e=this.props,t=e.selectDetails,r=i(t).has("hagroup")?true:false,l=i(t).has("cluster")?true:false,u=r?this.changeSystem:this.addSystem;var f,h,m,g,y,v,_;var E=this._showDetails;if(r){var b=e.selection,w=l?{cluster:{_id:b.cluster._id}}:{},S={hagroup:{_id:b._id}},A=b._model;v=b._policies||{};_=v.version||{};y=_.pin?{version:b.version}:{};f=i.merge(i.pick(t,"installation"),w);h=i.merge(i.pick(t,["installation","cluster"]),S);g="Change "+b._model+" System";if(l){m=this.renderClusteredFilters}else if(A.substring(0,3)==="FAS"){m=this.renderFasFilters}else if(A.substring(0,1)==="V"){m=this.renderFasFilters
}else if(A.substring(0,2)==="EF"){m=this.renderEFSeriesFilters}else if(A.substring(0,1)==="E"){m=this.renderESeriesFilters}}else{if(l){var C=i.first(e.selection.hagroups);v=C._policies||{};_=v.version||{};y=_.pin?{version:C.version}:{};f=t;g="Add System to "+(e.selection.name||"Cluster");m=i.partial(this.renderClusteredFilters,true)}else{var T=t.productLine,R=t.productSubLine,P=e.productInfo.getConfigGroup(T,R);f=P;g="Add "+P.title+" System";if(P.id===d.FAS_CMODE_NORMAL){m=this.renderClusteredFilters}else if(P.id===d.FAS_7MODE_NORMAL){m=this.renderFasFilters}else if(P.id===d.E_NORMAL){m=this.renderESeriesFilters}else if(P.id===d.EF_NORMAL){m=this.renderEFSeriesFilters}}}var N=e.map.guard(f,y),D=N.addingSystem(h),x=this._filterConfigs(D,this.state.configFilters),k=this._filterConfigs(x,{isEnabled:true}),O=this._filterConfigs(x,{isEnabled:false});var I=i(k).map(function(e){return s.createElement("div",{className:"row-list-item selectable",onClick:i.partial(u,e,f,h),onMouseOver:i.partial(E,e)},s.createElement("div",{className:"row-list-cell"},e.configModel),s.createElement("div",{className:"row-list-cell"},!e.isSellable?"(EOA)":""))}).value();var M=i(O).map(function(e){var t;var r=i.map(e.conflicts,function(e){var t=e.attribute.toUpperCase().replace(".","_"),r=p.LIMIT_TYPES[t],i=p.LIMIT_REASONS[r];return s.createElement("div",null,i)});t=s.createElement(c,{title:"Disabled",position:"top",titleClassName:"right strong"},r);return s.createElement("div",{className:"row-list-item disabled-selection",onMouseOver:i.partial(E,e)},s.createElement("div",{className:"row-list-cell"},e.configModel),s.createElement("div",{className:"row-list-cell"},!e.isSellable?"(EOA)":""),t)}).value();return s.createElement("div",null,s.createElement(n,{columnTitle:g},s.createElement(a,{isToggle:false,select:this._close,selected:false,enabled:true},"Close")),m(),s.createElement(o,{top:"80"},I,M))},noOpFilter:function(){return true},renderClusteredFilters:function(e){var t=e?"disabled":false;return s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group"},s.createElement("input",{onChange:i.partial(this._chainFilters,{isHA:true}),type:"radio",name:"filterFas",ref:"FilterFasMultiNodeCluster",id:"FilterFasMultiNodeCluster"}),s.createElement("label",{htmlFor:"FilterFasMultiNodeCluster",className:"btn btn-default"},s.createElement("span",null," Multi-Node")),s.createElement("input",{disabled:t,onChange:i.partial(this._chainFilters,{isHA:false}),type:"radio",name:"filterFas",ref:"FilterFasSingleNodeCluster",id:"FilterFasSingleNodeCluster"}),s.createElement("label",{disabled:t,htmlFor:"FilterFasSingleNodeCluster",className:"btn btn-default"},s.createElement("span",null," Single-Node"))),s.createElement("div",{className:"btn-group pull-right"},s.createElement(u,{onClick:this._filterShowEoa,title:"toggle show end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:this.state.showEoa}},"Show EOA"),s.createElement(u,{onClick:this._filterHideEoa,title:"toggle hide end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:!this.state.showEoa}},"Hide EOA")))},renderFasFilters:function(){return s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group"},s.createElement("input",{onChange:i.partial(this._chainFilters,{isHA:true}),type:"radio",name:"filterFas",ref:"FilterFasMultiNodeCluster",id:"FilterFasMultiNodeCluster"}),s.createElement("label",{htmlFor:"FilterFasMultiNodeCluster",className:"btn btn-default"},s.createElement("span",null," HA Pair")),s.createElement("input",{onChange:i.partial(this._chainFilters,{isHA:false}),type:"radio",name:"filterFas",id:"FilterFasStandalone"}),s.createElement("label",{htmlFor:"FilterFasStandalone",className:"btn btn-default"},s.createElement("span",null," Standalone")),s.createElement("input",{onChange:i.partial(this._chainFilters,{isEmbedded:true}),type:"radio",name:"filterFas",id:"FilterFasEmbedded"}),s.createElement("label",{htmlFor:"FilterFasEmbedded",className:"btn btn-default"},s.createElement("span",null," Internal Disk"))),s.createElement("div",{className:"btn-group pull-right"},s.createElement(u,{onClick:this._filterShowEoa,title:"toggle show end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:this.state.showEoa}},"Show EOA"),s.createElement(u,{onClick:this._filterHideEoa,title:"toggle hide end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:!this.state.showEoa}},"Hide EOA")))},renderESeriesFilters:function(){return s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group"},s.createElement("input",{onChange:i.partial(this._chainFilters,{isHA:true}),type:"radio",name:"filterE",ref:"filterESeriesDuplex",id:"filterESeriesDuplex"}),s.createElement("label",{htmlFor:"filterESeriesDuplex",className:"btn btn-default"},s.createElement("span",null," Duplex")),s.createElement("input",{onChange:i.partial(this._chainFilters,{isHA:false}),type:"radio",name:"filterE",ref:"filterESeriesSimplex",id:"filterESeriesSimplex"}),s.createElement("label",{htmlFor:"filterESeriesSimplex",className:"btn btn-default"},s.createElement("span",null," Simplex"))),s.createElement("div",{className:"btn-group pull-right"},s.createElement(u,{onClick:this._filterShowEoa,title:"toggle show end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:this.state.showEoa}},"Show EOA"),s.createElement(u,{onClick:this._filterHideEoa,title:"toggle hide end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:!this.state.showEoa}},"Hide EOA")))},renderEFSeriesFilters:function(){return s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group pull-right"},s.createElement(u,{onClick:this._filterShowEoa,title:"toggle show end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:this.state.showEoa}},"Show EOA"),s.createElement(u,{onClick:this._filterHideEoa,title:"toggle hide end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:!this.state.showEoa}},"Hide EOA")),s.createElement("div",{className:"clearfix"}))},_applyFiltersAndSetState:function(e,t){var r=!t?{isSellable:true}:{};i.merge(r,e);this.setState({showEoa:t,configFilters:r})},_chainFilters:function(e){this._applyFiltersAndSetState(e,this.state.showEoa)},_filterShowEoa:function(){var e=i.clone(this.state.configFilters);delete e.isSellable;this._applyFiltersAndSetState(e,true)},_filterHideEoa:function(){var e=i.clone(this.state.configFilters);delete e.isSellable;this._applyFiltersAndSetState(e,false)}});t.exports=f},{"../../lib/constants.js":65,"./button":8,"./constants":14,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./tooltip":45}],31:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./constants"),a=e("./layout/column-header"),o=e("./layout/action-link"),l=e("./layout/scrollable-region"),c=e("./repeat");var u=s.createClass({displayName:"ProductLines",propTypes:{installation:s.PropTypes.object.isRequired,productInfo:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func.isRequired},close:function(e){e.stopPropagation();e.preventDefault();this.props.clearSelection()},render:function(){var e=this.props,t=e.productInfo.getConfigGroups()||[];return s.createElement("div",null,s.createElement(a,{columnTitle:"Add System"},s.createElement(o,{isToggle:false,select:this.close,selected:false,enabled:true},"Close")),s.createElement(l,null,s.createElement(c,{seq:t,prop:"line"},s.createElement(p,{installation:e.installation,select:e.select}))))}});var p=s.createClass({displayName:"ProductLine",propTypes:{line:s.PropTypes.object.isRequired,installation:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},render:function(){var e=this.props,t=e.line,r=typeof t.title==="string"?t.title.trim():"",i=typeof t.subtitle==="string"?t.subtitle.trim():"",n=i?" ("+i+")":"";if(t.enabled){return s.createElement(d,{image:t.img,title:r,subtitle:n,subGroups:t.subGroups||[],lineId:t.id,installation:e.installation,select:e.select})}else{return s.createElement(f,{image:t.img,title:r,subtitle:n})}}});var d=s.createClass({displayName:"EnabledLineEntry",propTypes:{image:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,subtitle:s.PropTypes.string.isRequired,subGroups:s.PropTypes.array.isRequired,lineId:s.PropTypes.string.isRequired,installation:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},render:function(){var e=this.props,t=i.where(e.subGroups,{enabled:true});return s.createElement("div",{className:"product-grouping"},s.createElement("div",{className:"product-image hide-contracted-full"},s.createElement("img",{src:e.image,className:"controller-img",alt:e.title})),s.createElement("div",{className:"product-links"},s.createElement("div",{className:"row-list-item no-border no-color"},s.createElement("div",{className:"row-list-cell"},s.createElement("span",{className:"emphasize"},e.title,s.createElement("span",{className:"hide-contracted-full"},e.subtitle)))),s.createElement(c,{seq:t,prop:"subLine"},s.createElement(h,{lineId:e.lineId,installation:e.installation,select:e.select}))))}});var f=s.createClass({displayName:"DisabledLineEntry",propTypes:{image:s.PropTypes.string.isRequired,title:s.PropTypes.string.isRequired,subtitle:s.PropTypes.string.isRequired},render:function(){var e=this.props;return s.createElement("div",{className:"product-grouping",title:"coming soon"},s.createElement("div",{className:"product-image hide-contracted-full disabled"},s.createElement("img",{src:e.image,className:"controller-img",alt:e.title})),s.createElement("div",{className:"product-links"},s.createElement("div",{className:"row-list-item no-border no-color"},s.createElement("div",{className:"row-list-cell"},s.createElement("span",{className:"text-muted"},e.title,s.createElement("span",{className:"hide-contracted-full"},e.subtitle))))))}});var h=s.createClass({displayName:"ProductSubLine",propTypes:{lineId:s.PropTypes.string.isRequired,subLine:s.PropTypes.object.isRequired,installation:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},render:function(){var e=this.props,t=e.subLine,r=typeof t.title==="string"?t.title.trim():"";return s.createElement(m,{title:r,lineId:e.lineId,subLine:t,installation:e.installation,select:e.select})}});var m=s.createClass({displayName:"EnabledSubLineEntry",propTypes:{title:s.PropTypes.string.isRequired,lineId:s.PropTypes.string.isRequired,subLine:s.PropTypes.object.isRequired,installation:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},add:function(e){e.stopPropagation();e.preventDefault();var t={installation:{_id:this.props.installation._id},productLine:this.props.lineId,productSubLine:this.props.subLine.id};this.props.select(t,n.UI_SELECT_ADD_CHANGE_SYSTEMS)},render:function(){return s.createElement("div",{className:"row-list-item no-border no-color selectable",onClick:this.add},s.createElement("div",{className:"row-list-cell row-list-cell-m"},s.createElement("span",null,this.props.title)),s.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-img hide-contracted-full"}),s.createElement("span",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-chevron-right"})))}});t.exports=u},{"./constants":14,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./repeat":34}],32:[function(e,t,r){"use strict";var i=window.React,s=e("moment"),n=e("./drive-summary"),a=e("./button"),o=e("react-router").Link,l=e("./separated-list"),c=e("./faglyph"),u=e("./glyph"),p=window._;var d="Loading…",f="Search by project name, project ID, part number, configuration, drive capacity, drive speed, drive type, version, or mode",h="Unnamed Project";var m=i.createClass({displayName:"ProjectAutoDesc",propTypes:{project:i.PropTypes.object.isRequired},_toModelEntries:function(e){if(!e){return null}else{var t=[];for(var r in e){t.push({model:r,count:e[r]})}return t}},_renderModelEntry:function(e){return i.createElement("div",{className:"count-of"},i.createElement("span",{className:"count-num"},e.count,"x "),i.createElement("span",{className:"count-what"},e.model))},_renderModels:function(e,t,r){var s=i.createElement("span",{className:"pad-header"},e);return i.createElement(l,{className:r,seq:this._toModelEntries(t),head:s,render:this._renderModelEntry})},_renderGood:function(e){return i.createElement("div",{className:"project-auto-description"},i.createElement(n,{drives:e.drives,className:"pull-right"}),this._renderModels("Nodes: ",e.nodes,"pad-nodes"),this._renderModels("Shelves: ",e.shelves,"pad-shelves"))},_renderBad:function(){return i.createElement("div",{className:"project-auto-description hide"})},render:function(){var e=this.props.project._x_autodesc;if(e&&e.modes&&e.modes.length){return this._renderGood(e)}else{return this._renderBad()}}});var g=[/^X/,/^[0-9.]+K/],y=["nodes","shelves"];var v=i.createClass({displayName:"ProjectEntry",propTypes:{project:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired,inEditMode:i.PropTypes.bool.isRequired},getInitialState:function(){return{editingName:false,newName:null}},componentDidMount:function(){if(this.props.inEditMode){this.setState({editingName:true,newName:this.props.project._x_project_name||""});if(this.refs.projectNameInput){this.refs.projectNameInput.getDOMNode().select()}}},_filterAutoTag:function(e){for(var t in g){if(e.match(g[t])){return false}}if(this.props.project._x_autodesc){for(var r in y){var i=y[r],s=this.props.project._x_autodesc[i];if(s){if(p.has(s,e)){return false}}}}return true},_gatherTags:function(e){var t=p.filter(e._x_autotags||[],this._filterAutoTag),r=t.concat(e._x_usertags||[]);if(r.length>0){r.sort();return r}else{return null}},_renderTag:function(e){return i.createElement("span",{className:"pad-tag"},e)},_editName:function(){this.setState({editingName:true,newName:this.props.project._x_project_name||""},function(){if(this.refs.projectNameInput){this.refs.projectNameInput.getDOMNode().select()}})},_archiveProject:function(){this.setState({archivingProject:true})},_confirmArchiveProject:function(){this.setState({archivingProject:false});this.props.fire("PORTFOLIO_ARCHIVE",this.props.project._uuid,this.props.project._version)},_cancelArchiveProject:function(){this.setState({archivingProject:false})},_captureNewName:function(e){this.setState({newName:e.target.value||""})},_saveNewName:function(){this.setState({editingName:false,newName:null});this.props.fire("PORTFOLIO_SET_NAME",this.props.project._uuid,this.props.project._version,this.state.newName);this.props.fire("PROJECT_UNLOAD",this.props.project._uuid)},_cancelEditName:function(){this.setState({editingName:false,newName:this.props.project._x_project_name||""})},_renderStateGlyph:function(){if(this.props.project._X_STATE.adjusting){return i.createElement(a,{faglyph:"refresh",title:"saving",spin:true,extraClasses:{"btn-default":true,"no-border":true}})}else if(this.props.project._X_STATE.err){return i.createElement(a,{title:"an error occurred amending your project",glyph:"warning-sign",spin:false,onClick:this._editName,extraClasses:{"btn-default":true,"no-border":true}})}else{return i.createElement("ul",{className:"edit-strip"},i.createElement("li",null,i.createElement(c,{name:"chevron-down",title:"project options"}),i.createElement("ul",{className:"edit-strip-items"},i.createElement("li",null,i.createElement(a,{faglyph:"pencil",title:"edit the name of your project",onClick:this._editName,alignRight:true,extraClasses:{"btn-default":true,"no-border":true}},"Edit project title")),i.createElement("li",null,i.createElement(a,{faglyph:"trash",title:"delete this project",onClick:this._archiveProject,alignRight:true,extraClasses:{"btn-default":true,"no-border":true}},"Delete project")))))}},_handleKeyUp:function(e){if(e.key==="Enter"){this._saveNewName()}else if(e.key==="Escape"){this._cancelEditName()}},_renderArchiveProjectOverlay:function(){if(this.state.archivingProject){return i.createElement("div",{className:"archive-project-overlay"},i.createElement("div",{className:"inner"},"Delete this project?",i.createElement("div",{className:"archive-project-buttons"},i.createElement(a,{faglyph:"check",title:"confirm deleting of project",onClick:this._confirmArchiveProject,extraClasses:{"btn-success":true,"no-border":true}}),i.createElement(a,{faglyph:"times",title:"cancel deleting of project",onClick:this._cancelArchiveProject,extraClasses:{"btn-danger":true,"no-border":true}}))))}else{return null}},_renderNameOrNameInput:function(){var e=this.props.project,t=this.state.newName||e._x_project_name||h,r=t.length>80?t.slice(0,80)+"…":t;if(this.state.editingName){return i.createElement("div",{className:"project-title edit-mode"},i.createElement("div",{className:"edit-title"},i.createElement("input",{type:"text",ref:"projectNameInput",value:this.state.newName,placeholder:"Name the project",onChange:this._captureNewName,onKeyUp:this._handleKeyUp,className:"form-control"}),i.createElement("span",{className:"toolstrip"},i.createElement(a,{faglyph:"check",title:"save changes to project name",onClick:this._saveNewName,extraClasses:{"btn-success":true,"no-border":true}}),i.createElement(a,{faglyph:"times",title:"cancel changes to project name",onClick:this._cancelEditName,extraClasses:{"btn-danger":true,"no-border":true}}))))}else{return i.createElement("div",{className:"project-title"},i.createElement("span",null,i.createElement("span",{className:"project-title-name"},i.createElement(o,{title:e._x_project_name||h,to:"project",params:{uuid:e._uuid},className:"pad-tlink"},r)),i.createElement("span",{className:"toolstrip pull-right"},this._renderStateGlyph())),i.createElement("span",{className:"project-date"},"Created: ",s.unix(e._x_original_timestamp/1e3).calendar()," | Last Modified: ",s.unix(e._timestamp/1e3).calendar()))}},render:function(){var e=this.props.project;return i.createElement("div",{key:e._uuid,className:"project-entry"},this._renderArchiveProjectOverlay(),this._renderNameOrNameInput(),i.createElement("div",{className:"project-info"},i.createElement(m,{project:e})))}});var _=i.createClass({displayName:"ProjectList",propTypes:{projects:i.PropTypes.array.isRequired,fire:i.PropTypes.func.isRequired,projectIdsInEditMode:i.PropTypes.object.isRequired},_addButtonClick:function(){this.props.fire("PORTFOLIO_ADD_NEW")},render:function(){var e=[];p.forEach(this.props.projects,function t(r){if(!r._x_archived){e.push(i.createElement(v,{key:r._uuid,project:r,fire:this.props.fire,inEditMode:p.has(this.props.projectIdsInEditMode,r._uuid)}))}},this);return i.createElement("div",{className:"project-list"},i.createElement("div",{className:"row-list-item selectable new",onClick:this._addButtonClick},i.createElement("div",{className:"row-list-cell"},"Add a new project"),i.createElement("span",{className:"chevron"},i.createElement("span",{className:"fa fa-fw fa-plus"}))),e)}});var E=i.createClass({displayName:"ProjectListPanel",propTypes:{stores:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired},getInitialState:function(){return this.props.stores.portfolio.getState()},componentWillMount:function(){if(!this.state.fetching&&!this.state.fetched){this.props.fire("PORTFOLIO_FETCH")}},componentDidMount:function(){this.props.stores.portfolio.watch(this._onChange);var e=this.refs.projectSearch.getDOMNode();if(e){e.focus()}},componentWillUnmount:function(){this.props.stores.portfolio.unwatch(this._onChange)},_searchChange:function(e){this.props.fire("PORTFOLIO_SEARCH",e.target.value)},_searchClear:function(){this.props.fire("PORTFOLIO_SEARCH","")},_handleKeyUp:function(e){if(e.key==="Escape"){this._searchClear()}},_content:function(){if(this.state.fetching){return i.createElement("div",{className:"placeholder-pane"},i.createElement(u,{name:"refresh",spin:true,extraClasses:{pad1em:true}}),i.createElement("span",{className:"placeholder-loading-text"},"Loading your projects…"))}return i.createElement(_,{projects:this.state.projects,fire:this.props.fire,projectIdsInEditMode:this.state.projectIdsInEditMode})},render:function(){var e=this.state.fetching?d:f;return i.createElement("div",{className:"col-sm-8 project-pane"},i.createElement("div",{className:"project-search"},i.createElement("input",{type:"text",ref:"projectSearch",value:this.state.search,placeholder:e,onChange:this._searchChange,onKeyUp:this._handleKeyUp,className:"form-control"}),i.createElement(a,{faglyph:this.state.search.length?"times":"search",title:"clear search text",onClick:this._searchClear,extraClasses:{disabled:this.state.search.length===0,"no-border":true}})),this._content())},_onChange:function(){this.setState(this.props.stores.portfolio.getState())}});t.exports=E},{"./button":8,"./drive-summary":15,"./faglyph":16,"./glyph":19,"./separated-list":36,moment:134,"react-router":162}],33:[function(e,t,r){"use strict";var i=window.React,s=e("./glyph"),n=e("./hardware"),a=e("../retitle");var o=i.createClass({displayName:"Project",propTypes:{stores:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired,log:i.PropTypes.func.isRequired,uuid:i.PropTypes.string.isRequired,version:i.PropTypes.string},_getUpdatedStateFromStores:function(){return{project:this.props.stores.project.getState(),productInfo:this.props.stores.productInfo.getState(),userPreferences:this.props.stores.userPreferences.getState(),hardware:this.props.stores.hardware.getState()}},getInitialState:function(){return this._getUpdatedStateFromStores()},componentWillMount:function(){if(this.state.project.fetched&&this.state.productInfo.fetched){if(this.state.project.uuid!==this.props.uuid){this._requestLoad()}}else if(!this.state.project.fetching&&!this.state.project.fetched){this._requestLoad()}},_requestLoad:function(){this.props.fire("PROJECT_LOAD",this.props.uuid,this.props.version);this.setState(this.getInitialState())},componentDidMount:function(){this.props.stores.project.watch(this._onChange);this.props.stores.productInfo.watch(this._onChange);this.props.stores.userPreferences.watch(this._onChange);this.props.stores.hardware.watch(this._onChange);a(this._title(true))},componentWillUnmount:function(){this.props.stores.project.unwatch(this._onChange);this.props.stores.productInfo.unwatch(this._onChange);this.props.stores.userPreferences.unwatch(this._onChange);this.props.stores.hardware.unwatch(this._onChange)},_title:function(e){if(this.state.project.fetching){return"Opening Project…"}else if(this.state.productInfo.fetching){return"Loading platform information…"}else if(this.state.project.fetched&&this.state.productInfo.fetched){if(this.state.project.name){return this.state.project.name}else{if(e){return this.state.project.uuid}return i.createElement("span",{className:"mono"},this.state.project.uuid)}}else if(this.state.project.err||this.state.productInfo.err){return"Error"}else{return"SHOULD NOT BE DISPLAYED"}},_content:function(){if(this.state.project.fetching||this.state.productInfo.fetching){return i.createElement("div",{className:"placeholder-pane"},i.createElement(s,{name:"refresh",spin:true,extraClasses:{pad1em:true}}),i.createElement("span",{className:"placeholder-loading-text"},"Loading your project…"))}if(this.state.project.err){return i.createElement("pre",null,this.state.project.err.message)}var e={};if(this.state.project.uuid===this.state.hardware.uuid){e=this.state.hardware}var t=this.state.project.map();t.rehydrate();return i.createElement(n,{map:t,projectId:this.state.project.uuid,selected:e,productInfo:this.state.productInfo.productInfo,userPreferences:this.state.userPreferences,fire:this.props.fire,log:this.props.log})},render:function(){return i.createElement("div",{id:"main-panel"},i.createElement("div",{id:"content"},this._content()))},_onChange:function(){this.setState(this._getUpdatedStateFromStores());a(this._title(true))}});t.exports=o},{"../retitle":50,"./glyph":19,"./hardware":20}],34:[function(e,t,r){"use strict";var i=window.React,s=e("assert"),n=window._;var a=i.createClass({displayName:"Repeat",propTypes:{className:i.PropTypes.string,seq:i.PropTypes.array.isRequired,prop:i.PropTypes.string.isRequired,type:i.PropTypes.string,key:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.func]),children:i.PropTypes.element.isRequired},_getKeyExtractor:function(){var e=this.props.key;switch(typeof e){case"function":return e;case"string":return function(t){return t[e]};default:s.equal(typeof e,"undefined");return null}},render:function(){s(!n.isArray(this.props.children));var e=this.props.children,t=this.props.prop,r=this._getKeyExtractor(),a=n.map(this.props.seq,function(s,n){var a={};a[t]=s;if(r){a.key=r(s,n)}return i.addons.cloneWithProps(e,a)});if(this.props.type&&this.props.type==="tableRow"){return i.createElement("tbody",{className:this.props.className},a)}else{return i.createElement("div",{className:this.props.className},a)}}});t.exports=a},{assert:127}],35:[function(e,t,r){"use strict";var i=window.React,s=e("./repeat"),n=e("./button"),a=e("./layout/column-header"),o=e("./layout/action-link"),l=e("./layout/scrollable-region"),c=e("./capacity-tooltip"),u=e("../../lib/model/aggregates/systemSummary.js"),p=e("../../lib/model/inspect/environmental-summary"),d=e("../../lib/units.js"),f=e("./faglyph"),h=window._;var m=i.createClass({displayName:"DriveTypeRow",propTypes:{driveType:i.PropTypes.object.isRequired},render:function(){return i.createElement("tr",null,i.createElement("td",null,i.createElement("div",{className:"drive-summary-block no-overflow drive-breakdown"},i.createElement("span",{className:"drive-count"},this.props.driveType.count),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label-size"},new d(this.props.driveType.rawgb,"GB").to("TB").makeHappyFriendly(null,null,"%d%s"),i.createElement("span",{className:"drive-type"},this.props.driveType.type)))))}});var g=i.createClass({displayName:"GroupedCapacitySummary",propTypes:{summary:i.PropTypes.object.isRequired,useBase10Yields:i.PropTypes.bool.isRequired},render:function(){var e=this.props.summary.performanceSummary,t=this.props.summary.capacitySummary,r=this.props.summary.ssdSummary,s=this.props.summary,n=this.props.useBase10Yields?"TB":"TiB";return i.createElement("div",{className:"capacity-summary"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("td",null),i.createElement("th",{scope:"col",className:"numeric"},"Raw"),i.createElement("th",{scope:"col",className:"numeric"},"Usable"))),i.createElement("tbody",{className:"last-row"},i.createElement("tr",{className:"drive-class-row"},i.createElement("td",null,i.createElement("div",{className:"drive-summary-block no-overflow drive-performance"},i.createElement("span",{className:"drive-count"},e.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Performance HDD"))),i.createElement("td",{className:"numeric"},new d(e.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Performance HDD)",inputValue:e.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(e.usableCapacity,"GiB").to(n).friendly(2),i.createElement(c,{title:"Usable Capacity (Performance HDD)",inputValue:e.usableCapacity,displayUnitsFrom:"GiB"}))),i.createElement("tr",{className:"drive-class-row"},i.createElement("td",null,i.createElement("div",{className:"drive-summary-block no-overflow drive-capacity"},i.createElement("span",{className:"drive-count"},t.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Capacity HDD"))),i.createElement("td",{className:"numeric"},new d(t.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Capacity HDD)",inputValue:t.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(t.usableCapacity,"GiB").to(n).friendly(2),i.createElement(c,{title:"Usable Capacity (Capacity HDD)",inputValue:t.usableCapacity,displayUnitsFrom:"GiB"}))),i.createElement("tr",{className:"drive-class-row"},i.createElement("td",null,i.createElement("div",{className:"drive-summary-block no-overflow drive-ssd"},i.createElement("span",{className:"drive-count"},r.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Solid-State Drive"))),i.createElement("td",{className:"numeric"},new d(r.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (SSD)",inputValue:r.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(r.usableCapacity,"GiB").to(n).friendly(2),i.createElement(c,{title:"Usable Capacity (SSD)",inputValue:r.usableCapacity,displayUnitsFrom:"GiB"})))),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row drive-total"},i.createElement("td",null,i.createElement("div",{className:"drive-summary-block no-overflow"},i.createElement("span",{className:"drive-count"},s.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Total"))),i.createElement("td",{className:"numeric"},new d(s.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Total)",inputValue:s.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(s.usableCapacity,"GiB").to(n).friendly(2),i.createElement(c,{title:"Usable Capacity (Total)",inputValue:s.usableCapacity,displayUnitsFrom:"GiB"}))))))}});var y=i.createClass({displayName:"ExpandedCapacitySummary",propTypes:{summary:i.PropTypes.object.isRequired,useBase10Yields:i.PropTypes.bool.isRequired},render:function(){var e=this.props.summary.performanceSummary,t=this.props.summary.capacitySummary,r=this.props.summary.ssdSummary,n=this.props.summary,a=this.props.useBase10Yields?"TB":"TiB";console.log("Capacity",t);return i.createElement("div",{className:"capacity-summary"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("td",null),i.createElement("th",{scope:"col",className:"numeric"},"Raw"),i.createElement("th",{scope:"col",className:"numeric"},"Usable"))),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow drive-performance"},i.createElement("span",{className:"drive-count"},e.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Performance HDD"))),i.createElement("td",{className:"numeric"},new d(e.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Performance HDD)",inputValue:e.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(e.usableCapacity,"GiB").to(a).friendly(2),i.createElement(c,{title:"Usable Capacity (Performance HDD)",inputValue:e.usableCapacity,displayUnitsFrom:"GiB"})))),i.createElement(s,{seq:e.driveCapacitySummaryByType,prop:"driveType",type:"tableRow"},i.createElement(m,null)),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block drive-capacity"},i.createElement("span",{className:"drive-count"},t.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Capacity HDD"))),i.createElement("td",{className:"numeric"},new d(t.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Capacity HDD)",inputValue:t.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(t.usableCapacity,"GiB").to(a).friendly(2),i.createElement(c,{title:"Usable Capacity (Capacity HDD)",inputValue:t.usableCapacity,displayUnitsFrom:"GiB"})))),i.createElement(s,{seq:t.driveCapacitySummaryByType,prop:"driveType",type:"tableRow"},i.createElement(m,null)),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow drive-ssd"},i.createElement("span",{className:"drive-count"},r.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Solid-State Drive"))),i.createElement("td",{className:"numeric"},new d(r.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (SDD)",inputValue:r.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(r.usableCapacity,"GiB").to(a).friendly(2),i.createElement(c,{title:"Usable Capacity (SDD)",inputValue:r.usableCapacity,displayUnitsFrom:"GiB"})))),i.createElement(s,{seq:r.driveCapacitySummaryByType,prop:"driveType",type:"tableRow",className:"last-row"},i.createElement(m,null)),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row drive-total"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow"},i.createElement("span",{className:"drive-count"},n.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",{className:"drive-label"},"Total"))),i.createElement("td",{className:"numeric"},new d(n.rawCapacity,"GB").to("TB").friendly(2),i.createElement(c,{title:"Raw Capacity (Total)",inputValue:n.rawCapacity,displayUnitsFrom:"GB"})),i.createElement("td",{className:"numeric"},new d(n.usableCapacity,"GiB").to(a).friendly(2),i.createElement(c,{title:"Usable Capacity (Total)",inputValue:n.usableCapacity,displayUnitsFrom:"GiB"}))))))
}});var v=i.createClass({displayName:"CapacitySummary",propTypes:{grouped:i.PropTypes.bool.isRequired,summary:i.PropTypes.object.isRequired,useBase10Yields:i.PropTypes.bool.isRequired},render:function(){if(this.props.grouped){return i.createElement(g,{summary:this.props.summary,useBase10Yields:this.props.useBase10Yields})}else{return i.createElement(y,{summary:this.props.summary,useBase10Yields:this.props.useBase10Yields})}}});var _=i.createClass({displayName:"EnvironmentalSummaryView",render:function(){var e=this.props.hagroups,t=this.props.map,r=new p(t,e),s=r.create(),n=this.props.voltageDisplay,a=s.power_spec[n];return i.createElement("div",{className:"environmental-summary"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("td",null),i.createElement("th",{scope:"col",className:"numeric"},"Typical"),i.createElement("th",{scope:"col",className:"numeric"},"Worst Case*"))),i.createElement("tbody",null,i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-dashboard"})," Current Draw"),i.createElement("td",{className:"numeric"},o(a.typical.amps,1)," A"),i.createElement("td",{className:"numeric"},o(a.worst.amps,1)," A")),i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-bolt"})," AC Power"),i.createElement("td",{className:"numeric"},o(r.powerWattsToVoltAmps(a.typical.watts))," VA"+" "+" / ",o(a.typical.watts)," W"),i.createElement("td",{className:"numeric"},o(r.powerWattsToVoltAmps(a.worst.watts)),"  VA"+" "+" / ",o(a.worst.watts)," W")),i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-fire"})," BTU / hr"),i.createElement("td",{className:"numeric"},o(a.typical.BTU)),i.createElement("td",{className:"numeric"},o(a.worst.BTU))),i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-lightbulb-o"})," kWh / year"),i.createElement("td",{className:"numeric"},o(r.powerWattsToKWhPerYear(a.typical.watts))),i.createElement("td",{className:"numeric"},o(r.powerWattsToKWhPerYear(a.worst.watts))))),i.createElement("tbody",null,i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-server"})," Rack Units"),i.createElement("td",{className:"numeric"},s.rack_units," U"),i.createElement("td",null)),i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-plug"})," Outlets"),i.createElement("td",{className:"numeric"},s.max_psu),i.createElement("td",null)),i.createElement("tr",null,i.createElement("th",{scope:"row"},i.createElement("span",{className:"fa fa-fw fa-anchor"})," Weight"),i.createElement("td",{className:"numeric"},o(r.weightGtoLbs(s.weight_g))," lbs"+" "+" / ",o(r.weightGtoKg(s.weight_g))," kg"),i.createElement("td",null)))),i.createElement("p",null,s.completeStatsAvailable?i.createElement("div",null):i.createElement("div",{className:"headroom"},i.createElement("span",{className:"fa fa-fw fa-warning"}),"Complete environmental data unavailable. Some devices not accounted for.")),i.createElement("p",{className:"footnote"},"*Power consumption with system running on one PSU, high fan speed and power distributed over one power cord."+" "+"DS4xxx disk shelves are an exception, in that they require two PSUs."));function o(e,t){return e.toFixed(t||0).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}}});var E=i.createClass({displayName:"DriveSummary",propTypes:{summary:i.PropTypes.object.isRequired},render:function(){var e=this.props.summary.driveRoleSummary;console.log("Drive Role Summary",e);return i.createElement("div",{className:"drive-summary"},i.createElement("table",null,i.createElement("thead",null,i.createElement("tr",null,i.createElement("td",null),i.createElement("th",{scope:"col",className:"numeric"},"Data"),i.createElement("th",{scope:"col",className:"numeric"},"Parity"),i.createElement("th",{scope:"col",className:"numeric"},"Spare"),i.createElement("th",{scope:"col",className:"numeric"},"Root"),i.createElement("th",{scope:"col",className:"numeric"},"Cache"))),i.createElement("tbody",null,i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow"},i.createElement("span",{className:"drive-count"},e.physical.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",null,"Dedicated"))),i.createElement("td",{className:"numeric"},e.physical.data),i.createElement("td",{className:"numeric"},e.physical.parity+e.physical.dparity),i.createElement("td",{className:"numeric"},e.physical.spare),i.createElement("td",{className:"numeric"},e.physical.root),i.createElement("td",{className:"numeric"},e.physical.cache)),i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow"},i.createElement("span",{className:"drive-count"},this.props.summary.total-e.physical.total),i.createElement("span",{className:"fa fa-fw fa-hdd-o"}),i.createElement("span",null,"Partitioned")))),i.createElement("tr",{className:"drive-class-row"},i.createElement("th",{scope:"row"},i.createElement("div",{className:"drive-summary-block no-overflow"},i.createElement("span",{className:"drive-count"}),i.createElement("span",{className:"fa fa-fw fa-pie-chart"}),i.createElement("span",null,"Partitions"))),i.createElement("td",{className:"numeric"},e.virtual.data),i.createElement("td",{className:"numeric"},e.virtual.parity+e.virtual.dparity),i.createElement("td",{className:"numeric"},e.virtual.spare),i.createElement("td",{className:"numeric"},e.virtual.root),i.createElement("td",{className:"numeric"},e.virtual.cache)))))}});var b=i.createClass({displayName:"Reports",propTypes:{selectedItem:i.PropTypes.any.isRequired,fire:i.PropTypes.func.isRequired,map:i.PropTypes.object.isRequired,installations:i.PropTypes.array.isRequired,userPreferences:i.PropTypes.object.isRequired,projectId:i.PropTypes.string.isRequired},_showSolutionView:function(){this.props.fire("USER_PREFERENCES_ADJUST",{currentSystemsView:false})},_showCurrentView:function(){this.props.fire("USER_PREFERENCES_ADJUST",{currentSystemsView:true})},_groupAll:function(){this.props.fire("USER_PREFERENCES_ADJUST",{collapseCapacity:true})},_expandAll:function(){this.props.fire("USER_PREFERENCES_ADJUST",{collapseCapacity:false})},_showUnitBase2:function(){this.props.fire("USER_PREFERENCES_ADJUST",{useBase10Yields:false})},_showUnitBase10:function(){this.props.fire("USER_PREFERENCES_ADJUST",{useBase10Yields:true})},_setMainsVoltageTo_v_100:function(){this.props.fire("USER_PREFERENCES_ADJUST",{mainsVoltage:"v_100"})},_setMainsVoltageTo_v_200:function(){this.props.fire("USER_PREFERENCES_ADJUST",{mainsVoltage:"v_200"})},_getHaGroups:function(e,t){if(!e||!t){var r=[];h.forEach(this.props.installations,function(e){if(e.clusters){h.forEach(e.clusters,function(e){r.push(e.hagroups)})}if(e.hagroups){r.push(e.hagroups)}});r=h.flatten(r);return r}var i=this.props.selectedItem,s=h.where(i,{_type:"cluster"}),n=h.reduce(s,a,h.where(i,{_type:"hagroup"}));function a(e,t){Array.prototype.push.apply(e,t.hagroups);return e}return n},render:function(){var e;if(this.props.selectedItem){e=true}else{e=false}var t=this.props.userPreferences.collapseCapacity||false,r=this.props.userPreferences.currentSystemsView||false,s=this._getHaGroups(r,e),c=new u(this.props.map,s).createSystemSummary(),p=h.first(this.props.installations);var d=this.props.userPreferences.useBase10Yields||false,m=this.props.userPreferences.mainsVoltage==="v_200"?"v_200":"v_100";var g;if(p&&(!h.isEmpty(p.clusters)||!h.isEmpty(p.hagroups))){g=i.createElement("a",{href:"../qadr/"+this.props.projectId,title:"generate word document",className:"btn btn-default results-subheading-button",alignRight:true},i.createElement(f,{name:"file-word-o"}),"Word")}else{g=i.createElement(n,{title:"generate word document",faglyph:"file-word-o",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,disabled:true,"results-subheading-button":true}},"Word")}var y;if(p&&(!h.isEmpty(p.clusters)||!h.isEmpty(p.hagroups))){y=i.createElement("a",{href:"../qadv/"+this.props.projectId,title:"generate visio diagram",className:"btn btn-default results-subheading-button",alignRight:true},i.createElement(f,{name:"sitemap"}),"Visio")}else{y=i.createElement(n,{title:"generate visio diagram",faglyph:"file-powerpoint-o",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,disabled:true,"results-subheading-button":true}},"Visio")}return i.createElement("div",null,i.createElement(a,{columnTitle:"Results"},i.createElement(o,{isToggle:true,select:this._showCurrentView,selected:r&&e,enabled:e},"Selected Systems"),i.createElement(o,{isToggle:true,select:this._showSolutionView,selected:!r||!e,enabled:true},"All Systems")),i.createElement(l,null,i.createElement("div",{className:"filter-pane"},i.createElement("div",{className:"btn-group"},g,y),i.createElement("div",{className:"btn-group pull-right"},i.createElement(n,{onClick:this._showUnitBase10,title:"toggle base 10",alignRight:true,extraClasses:{"results-subheading-button":true,"btn-default":true,"no-border":false,toggled:d}},"Base 10"),i.createElement(n,{onClick:this._showUnitBase2,title:"toggle base 2",alignRight:true,extraClasses:{"results-subheading-button":true,"btn-default":true,"no-border":false,toggled:!d}},"Base 2"))),i.createElement("div",{className:"group-type-label"},i.createElement("span",null,"Capacity"),i.createElement("span",{className:"pull-right action"},i.createElement("span",{title:t?"click to see drive size details":"click to hide drive size details",onClick:t?this._expandAll:this._groupAll,className:"expand-collapse-toggle"},t?"Expand":"Collapse"))),i.createElement(v,{grouped:t,summary:c,useBase10Yields:d}),i.createElement("br",null),i.createElement("div",{className:"group-type-label"},i.createElement("span",null,"Drives")),i.createElement(E,{summary:c}),i.createElement("br",null),i.createElement("div",{className:"group-type-label"},i.createElement("span",null,"Environmental"),i.createElement("div",{className:"btn-group pull-right results-subheading-button-group"},i.createElement(n,{onClick:this._setMainsVoltageTo_v_100,title:"toggle mains voltage to 110V",alignRight:true,extraClasses:{"results-subheading-button":true,"btn-default":true,"no-border":false,toggled:m!=="v_200"}},"110 V"),i.createElement(n,{onClick:this._setMainsVoltageTo_v_200,title:"toggle mains voltage to 220V",alignRight:true,extraClasses:{"results-subheading-button":true,"btn-default":true,"no-border":false,toggled:m==="v_200"}},"220 V"))),i.createElement(_,{hagroups:s,map:this.props.map,voltageDisplay:m})))}});t.exports=b},{"../../lib/model/aggregates/systemSummary.js":87,"../../lib/model/inspect/environmental-summary":97,"../../lib/units.js":123,"./button":8,"./capacity-tooltip":9,"./faglyph":16,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./repeat":34}],36:[function(e,t,r){"use strict";var i=window.React,s=e("assert");function n(e,t,r){s(e instanceof Array);s(typeof t==="function");s(typeof r==="function"||r===undefined);var i=[],n=e.length-1;for(var a=0;a<n;a++){i.push(t(e[a]));if(r){i.push(r())}}if(e.length>0){i.push(t(e[n]))}return i}var a=i.createClass({displayName:"SeparatedList",propTypes:{seq:i.PropTypes.array,render:i.PropTypes.func.isRequired,className:i.PropTypes.string.isRequired},_renderSeparator:function(){var e=this.props.sep;if(e===undefined){return i.createElement("span",{className:"sep"},"; ")}else if(typeof e==="function"){return e()}else{return e}},render:function(){if(this.props.seq&&this.props.seq.length>0){return i.createElement("div",{className:this.props.className},this.props.head,n(this.props.seq,this.props.render,this._renderSeparator),this.props.tail)}else{return i.createElement("div",{className:this.props.className+" hide"},null)}}});t.exports=a},{assert:127}],37:[function(e,t,r){"use strict";var i=window.React,s=e("./button");var n=i.createClass({displayName:"SessionExpirationOverlay",propTypes:{store:i.PropTypes.object.isRequired},getInitialState:function(){return this.props.store.getState()},componentDidMount:function(){this.props.store.watch(this.getSessionData);this.interval=setInterval(this.getSessionData,1e3)},componentWillUnmount:function(){this.props.store.unwatch(this.getSessionData);clearInterval(this.interval)},getSessionData:function(){this.setState(this.props.store.getState())},reloadPage:function(){location.reload()},render:function(){if(!this.state.isExpired){return null}else{return i.createElement("div",{className:"session-expire-overlay"},i.createElement("div",{className:"inner"},i.createElement("span",{className:"session-expire-message"},"Your session has expired."),i.createElement("br",null),i.createElement(s,{title:"login",name:"redirectToAuthnode",id:"REDIRECT_TO_AUTHNODE",onClick:this.reloadPage,extraClasses:{"btn-default":true,"no-border":false}},"Login")))}}});t.exports=n},{"./button":8}],38:[function(e,t,r){"use strict";var i=window.React,s=e("../../lib/model/util"),n=e("./hw-shelf-drive-group"),a=window._,o=e("./constants"),l=e("../../lib/constants.js");var c=i.createClass({displayName:"ShelfDetails",propTypes:{systems:i.PropTypes.array.isRequired,selected:i.PropTypes.object.isRequired,select:i.PropTypes.func.isRequired,fire:i.PropTypes.func.isRequired,col3View:i.PropTypes.string.isRequired},_getWrappedSystems:function(){var e=this.props,t=Array.isArray(e.systems),r=t?e.systems:[e.systems];return r},selectShelf:function(e,t){t.stopPropagation();t.preventDefault();var r={shelf:{model:e.model,_isembedded:false,_x_bom:{drive_specs:[]}}};a.forEach(e._x_bom.drive_specs,i);function i(e){r.shelf._x_bom.drive_specs.push({model:e.model,quantity:e.quantity})}this.props.select(r,o.UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST)},addShelf:function(e){e.stopPropagation();e.preventDefault();this.props.select({},o.UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST)},_isAddNewSelected:function(){if(this.props.col3View===o.UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST){if(a.isEmpty(this.props.selected.shelf)){return true}}return false},render:function(){var e=this;var t=this.props.systems;var r=s.groupShelves(a(t).flatten("shelves").where(function(e){return!e._isembedded}).value());var n=a.map(Object.keys(r).sort(),function(s){var n=a.find(r[s],o)||r[s][0];function o(t){return!e.props.map.inspect(t).isUsedByManualAggregate()}var l=a.partial(e.selectShelf,n);return i.createElement(u,{shelf:n,map:e.props.map,count:r[s].length,fire:e.props.fire,selected:e.props.selected,selectDetails:l,systems:t})});var o=i.addons.classSet({"row-list-item":true,selectable:true,"new":true,selected:this._isAddNewSelected()});return i.createElement("div",{className:"row-list-item-grouping"},i.createElement("div",{className:o,onClick:this.addShelf},i.createElement("div",{className:"row-list-cell row-list-cell-s"}),i.createElement("div",{className:"row-list-cell"},"Add a new shelf"),i.createElement("span",{className:"chevron"},i.createElement("span",{className:"fa fa-fw fa-plus"}))),n)}});var u=i.createClass({displayName:"ShelfGroupEditor",propTypes:{fire:i.PropTypes.func.isRequired,selectDetails:i.PropTypes.func.isRequired,selected:i.PropTypes.object.isRequired,shelf:i.PropTypes.object.isRequired,count:i.PropTypes.number.isRequired,systems:i.PropTypes.array.isRequired},getInitialState:function(){return{showLimitReason:false,limitReasonToDisplay:""}},componentWillReceiveProps:function(){this.setState({showLimitReason:false,limitReasonToDisplay:""})},_getByMatchingShelfCount:function(e){var t=a.groupBy(this.props.systems,function(t){return a.reduce(t.shelves,function(t,r){return t+(s.shelfDriveComboEquals(r,e)?1:0)},0)});return t},_addShelf:function(e,t){t.stopPropagation();t.preventDefault();this.props.fire("PROJECT_CHANGE_SYSTEMS",e)},_deleteShelf:function(e,t){t.stopPropagation();t.preventDefault();var r=this.props;if(r.systems&&r.shelf){var i=this._getByMatchingShelfCount(r.shelf);var s=a.max(Object.keys(i));var n=i[s];r.fire("PROJECT_DELETE_SHELF",n[0]._id,r.shelf);if(n[0].is_clustered){r.fire("PROJECT_SET_CLUSTER_VERSION",n[0].cluster._id,e)}else{r.fire("PROJECT_SET_SYSTEM_VERSION",n[0]._id,e)}}},_displayLimitReason:function(e,t){t.stopPropagation();t.preventDefault();var r=l.LIMIT_TYPES.DRIVE_TOTAL,i=a.first(e?e.conflicts||[]:[]);if(!a.isEmpty(i)){var s=i.attribute.toUpperCase().replace(".","_");r=l.LIMIT_TYPES[s]}this.setState({showLimitReason:true,limitReasonToDisplay:r})},_isSelected:function(){var e=this.props.selected.shelf,t=a.first(this.props.shelf)||this.props.shelf;if(e&&t){if(a.has(e,"_x_bom")&&a.has(t,"_x_bom")){return s.shelfDriveComboEquals(e,t)}else{return false}}else{return false}},render:function(){var e=this.props,t=e.systems.length===1?e.systems[0]:e.systems,r=e.map.inspect(t).config.matrix,o=t.version;var c=e.shelf,u=this.props.count,p="../media/img/"+c.model.replace(" ","")+"_front_view.png",d=a.isEmpty(c._x_bom)?[]:c._x_bom.drive_specs,f=a(d).map(function(e){var t=r.checkVersionShelfDrive(o,c.model,e.model);return i.createElement(n,{driveGroup:e,fpSupport:t.fp_support_drive,shelfCount:u})}).value(),h=i.addons.classSet({"row-list-item":true,selectable:true,selected:this._isSelected()});var m=t._policies||{},g=m.version||{},y=g.pin?{version:o}:{};var v=a.pick(this.props.selected,["installation","cluster","hagroup"]),_=this.props.map.guard(v,y),E=_.addingShelf(),b=a.find(E,function M(e){return s.isConfigForShelf(e,c)}),w;var S=a.merge({shelf:{_id:c._id}},v),A=_.deletingShelf(S),C=a.last(A),T;if(C&&C.isEnabled){var R=a.partial(this._deleteShelf,C.newVersion);T=i.createElement("span",{className:"fa fa-fw fa-minus",onClick:R})}else{var P=a.partial(this._displayLimitReason,C);T=i.createElement("span",{className:"fa fa-fw fa-lock disabled",onClick:P})}if(b&&b.isEnabled){var N=b.buildSpec(v),D=a.partial(this._addShelf,N);w=i.createElement("div",{className:"row-list-cell row-list-cell-s"},T,i.createElement("input",{type:"text",value:this.props.count,className:"input-count"}),i.createElement("span",{className:"fa fa-fw fa-plus",onClick:D}))}else{var x=a.partial(this._displayLimitReason,b);w=i.createElement("div",{className:"row-list-cell row-list-cell-s"},T,i.createElement("input",{type:"text",value:this.props.count,className:"input-count"}),i.createElement("span",{className:"fa fa-fw fa-warning disabled",onClick:x}))}var k;if(this.state.showLimitReason){var O=l.LIMIT_REASONS[this.state.limitReasonToDisplay],I="";switch(this.state.limitReasonToDisplay){case l.LIMIT_TYPES.AGGR_MANUAL:I="fa-lock";break;default:I="fa-warning";break}k=i.createElement("div",{className:"headroom"},i.createElement("span",{className:"fa fa-fw "+I})," ",O)}return i.createElement("div",null,k,i.createElement("div",{className:h,onClick:this.props.selectDetails},w,i.createElement("div",{className:"row-list-cell row-list-cell-l"},i.createElement("span",{className:"emphasize"},c.model),f),i.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-img hide-contracted-full"},i.createElement("img",{src:p,alt:c.model,className:"shelf-img"})),i.createElement("span",{className:"chevron"},i.createElement("span",{className:"fa fa-fw fa-chevron-right"}))))}});t.exports=c},{"../../lib/constants.js":65,"../../lib/model/util":104,"./constants":14,"./hw-shelf-drive-group":21}],39:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/column-header"),a=e("./layout/action-link"),o=e("./layout/scrollable-region"),l=e("./faglyph"),c=e("./button"),u=e("./tooltip"),p=e("../../lib/constants.js");var d=s.createClass({displayName:"ShelfSpecRow",fireOnClick:function(e){if(this.props.enabled){this.props.fire(e)}},render:function(){var e=this.props;var t=s.createElement("span",null);var r=s.createElement("span",null);var n=s.createElement("span",null);var a=s.addons.classSet({"row-list-item":true,"ssp-selected":e.selected,selectable:!e.conflicts||e.conflicts.length===0,"disabled-selection":e.conflicts&&e.conflicts.length>0});if(e.dnB){t=s.createElement("div",{className:"count-icon-grouping"},s.createElement("span",{className:"count"},e.dnB),s.createElement("span",{className:"icon"},s.createElement("span",{className:"fa fa-fw fa-hdd-o "+e.dcssB})),s.createElement("span",{className:"item"},s.createElement("span",{className:"capacity-count"},e.dcB>999?e.dcB/1e3+"TB ":e.dcB+"GB "),e.dtB));r=s.createElement("div",null,s.createElement("span",null,e.dmB),s.createElement("span",null,e.doB));n=s.createElement("div",null,s.createElement(l,{name:"flash",extraClasses:e.dfB,title:"Supports Flash Pool"}),s.createElement(l,{name:"key",extraClasses:e.deB,title:"Encrypted"}),s.createElement(l,{name:"clock-o",extraClasses:e.doB,title:"End of Availability"}))}var o;if(e.conflicts&&e.conflicts.length>0){var c=i.map(e.conflicts,function(e){var t=e.attribute.toUpperCase().replace(".","_"),r=p.LIMIT_TYPES[t],i=p.LIMIT_REASONS[r];return s.createElement("div",null,i)});o=s.createElement(u,{title:"Disabled",position:"top",titleClassName:"right strong"},c)}return s.createElement("div",null,s.createElement("div",{className:a,onClick:this.fireOnClick},s.createElement("div",{className:"row-list-cell row-list-cell-s"},s.createElement("span",{className:"emphasize"},e.sm)),s.createElement("div",{className:"row-list-cell row-list-cell-m"},s.createElement("div",{className:"count-icon-grouping"},s.createElement("span",{className:"count"},e.dnA),s.createElement("span",{className:"icon"},s.createElement("span",{className:"fa fa-fw fa-hdd-o "+e.dcssA})),s.createElement("span",{className:"item"},s.createElement("span",{className:"capacity-count"},e.dcA>999?e.dcA/1e3+"TB":e.dcA+"GB"),e.dtA)),t),s.createElement("div",{className:"row-list-cell row-list-cell-s"},s.createElement("span",null,e.dmA),r),s.createElement("div",{className:"row-list-cell icon-tag-grouping"},s.createElement("div",null,s.createElement(l,{name:"flash",extraClasses:e.dfA,title:"Supports Flash Pool"}),s.createElement(l,{name:"key",extraClasses:e.deA,title:"Encrypted"}),s.createElement(l,{name:"clock-o",extraClasses:e.doA,title:"End of Availability"})),n)),o)}});var f=s.createClass({displayName:"ShelfList",propTypes:{selection:s.PropTypes.object.isRequired,selectDetails:s.PropTypes.object.isRequired,selectedItem:s.PropTypes.array.isRequired,fire:s.PropTypes.func.isRequired,onClose:s.PropTypes.func,map:s.PropTypes.object.isRequired},getInitialState:function(){return{speedFilter:false,modelFilter:false,showEoa:false}},componentWillReceiveProps:function(e){if(!i.isEqual(this.props.selectDetails,e.selectDetails)){this.setState({speedFilter:false,modelFilter:false,showEoa:false})}},componentDidMount:function(){this.refs.FilterSpeedNone.getDOMNode().setAttribute("checked","checked");this.refs.FilterModelNone.getDOMNode().setAttribute("checked","checked")},_getShelfDriveCombos:function(e){var t=[],r=this.props.selectedItem.length?this.props.selectedItem[0]:this.props.selectedItem,s=this.props.map.inspect(r).config.matrix;i.forEach(e,function(e){var r,n,a,o;if(e.drives&&e.drives.length){r=e.drives[0].drive;n=e.drives[0].quantity;if(e.drives.length>1){a=e.drives[1].drive;o=e.drives[1].quantity}}var l=e.shelf.model,c=r&&r.model,u=r?s.checkVersionShelfDrive(e.newVersion,l,c):{};var p=a&&a.model,d=a?s.checkVersionShelfDrive(e.newVersion,l,p):{};t.push({config:e,shelf:e.shelf.model,_isSellable:e.shelf.sellable,_isembedded:e.isEmbedded,isMixed:i.isEmpty(a)?false:true,drive1DriveType:r&&r.type,drive1MarketingCapacity:r&&r.capacity&&r.capacity.marketing,drive1Model:r&&r.model,drive1Quantity:n||0,drive1Speed:r&&r.speed,drive1Encrypted:r&&r.encrypted,drive1FlashPool:r&&u.fp_support_drive||false,drive1Sellable:r&&r.sellable,drive2DriveType:a&&a.type,drive2MarketingCapacity:a&&a.capacity&&a.capacity.marketing,drive2Model:a&&a.model,drive2Quantity:o||0,drive2Speed:a&&a.speed,drive2Encrypted:a&&a.encrypted,drive2FlashPool:a&&d.fp_support_drive||false,drive2Sellable:a&&a.sellable||true})});t=i.uniq(t,function(e){return JSON.stringify(i.omit(e,"config"))});t=i.sortBy(t,["drive1Model","drive2Model"]);t=i.sortBy(t,["drive1Encrypted","drive2Encrypted"]).reverse();t=i.sortBy(t,["drive1MarketingCapacity","drive2MarketingCapacity"]);t=i.sortBy(t,["drive1Quantity","drive2Quantity"]);t=i.sortBy(t,["drive1DriveType","drive2DriveType"]).reverse();t=i.sortBy(t,["drive1Speed","drive2Speed"]).reverse();t=i.sortBy(t,"shelf").reverse();t=i.sortBy(t,"isMixed");return t},_stop:function(e){if(e){e.stopPropagation()}},_filterSpeedChange:function(e){this._stop(e);if(e.target.checked){this._filterChange(e.target.value,this.state.modelFilter,this.state.showEoa)}},_filterChangeModel:function(e){this._stop(e);if(e.target.checked){this._filterChange(this.state.speedFilter,e.target.value,this.state.showEoa)}},_filterShowEoa:function(e){this._stop(e);this._filterChange(this.state.speedFilter,this.state.modelFilter,true)},_filterHideEoa:function(e){this._stop(e);this._filterChange(this.state.speedFilter,this.state.modelFilter,false)},_applyFilter:function(e,t,r,i){return this._applyFilterWithProps(e,t,r,i,this.props)},_applyFilterWithProps:function(e,t,r,s,n){var a=n.selection.length===1?n.selection[0]:n.selection,o=i(n.selectDetails).has("shelf")?true:false;return i(e).filter(p).filter(u).filter(c).filter(l).value();function l(e){return!o&&!e._isembedded||o&&(a._isembedded===e._isembedded||!a._isembedded&&!e._isembedded)}function c(e){return!t||t==="split"&&e.drive2Speed||e.drive1Speed===Number(t)||e.drive2Speed===Number(t)}function u(e){return!r||e.shelf===r}function p(e){return s||e._isSellable&&e.drive1Sellable&&e.drive2Sellable}},_filterChange:function(e,t,r){this.setState({speedFilter:e,modelFilter:t,showEoa:r})},_deleteShelf:function(e,t){this._stop(t);var r=this.props,s=r.selection.length?r.selection[0]:r.selection;if(s){i.forEach(r.selectedItem,function(t){r.fire("PROJECT_DELETE_SHELVES",t._id,s);if(t.is_clustered){r.fire("PROJECT_SET_CLUSTER_VERSION",t.cluster._id,e)}else{r.fire("PROJECT_SET_SYSTEM_VERSION",t._id,e)}})}this._close(t)},_addShelf:function(e,t,r,i){this._stop(i);var s=this.props.fire,n=e.config.buildSpec(t,r);s("PROJECT_CHANGE_SYSTEMS",n);this._close(i)},_close:function(e){this.props.onClose(e)},_renderShelfFilter:function(){var e=["DE6600","DE5600","DE1600"],t=["DS2246","DS4243","DS4246","DS4486"];var r=this.props,i=[],n=r.selection.length?r.selection[0]:r.selection;var a=this._filterChangeModel;function o(e){var t="Filter"+e,r=[];r.push(s.createElement("input",{onChange:a,type:"radio",name:"filterShelvesByModel",value:e,id:t}));r.push(s.createElement("label",{htmlFor:t,className:"btn btn-default"},s.createElement("span",null,e)));return r}if(n.model.substring(0,1)==="E"){for(var l=0;l<e.length;l++){var c=e[l];i.push(o(c))}}else{for(var u=0;u<t.length;u++){var p=t[u];i.push(o(p))}}return i},render:function(){var e=this.props,t=e.selection,r=e.selectDetails;var u=i.has(r,"shelf")?true:false,p=t.length?t[0]:t,f=this._addShelf;var h,m;if(u){h=i.pick(r,["installation","cluster","hagroup"]);m=r}else{h=r}var g=e.selectedItem.length?e.selectedItem[0]:e.selectedItem,y=g._policies||{},v=y.version||{},_=v.pin?{version:g.version}:{};var E=e.map.guard(h,_),b=u?E.addingShelf(m):E.addingShelf();var w=this.state.speedFilter||false,S=this.state.modelFilter||false,A=this.state.showEoa||false;var C=this._getShelfDriveCombos(b),T=this._applyFilterWithProps(C,w,S,A,e);var R=[],P=[],N="",D="";i.forEach(T,function L(e){switch(e.drive1Speed){case 10:N="text-blue";break;case 15:N="text-green";break;case 50:N="text-purple";break;default:N=""}switch(e.drive2Speed){case 10:D="text-blue";break;case 15:D="text-green";break;case 50:D="text-purple";break;default:D=""}if(e.config.isEnabled){R.push(s.createElement(d,{enabled:true,fire:i.partial(f,e,h,m),sm:e.shelf,dcssA:N,dgA:e.drive1DriveType==="SSD"?"hdd-o":"hdd-o",dmA:e.drive1Model,dnA:e.drive1Quantity,dcA:e.drive1MarketingCapacity,dtA:e.drive1DriveType,deA:{"disable-tag":!e.drive1Encrypted},dfA:{"disable-tag":!e.drive1FlashPool},doA:{"disable-tag":e.drive1Sellable},dcssB:D,dgB:e.drive2DriveType==="SSD"?"hdd-o":"hdd-o",dmB:e.drive2Model,dnB:e.drive2Quantity,dcB:e.drive2MarketingCapacity,dtB:e.drive2DriveType,deB:{"disable-tag":!e.drive2Encrypted},dfB:{"disable-tag":!e.drive2FlashPool},doB:{"disable-tag":e.drive2Sellable},conflicts:e.config.conflicts}))}else{P.push(s.createElement(d,{enabled:false,sm:e.shelf,dcssA:N,dgA:e.drive1DriveType==="SSD"?"hdd-o":"hdd-o",dmA:e.drive1Model,dnA:e.drive1Quantity,dcA:e.drive1MarketingCapacity,dtA:e.drive1DriveType,deA:{"disable-tag":!e.drive1Encrypted},dfA:{"disable-tag":!e.drive1FlashPool},doA:{"disable-tag":e.drive1Sellable},dcssB:D,dgB:e.drive2DriveType==="SSD"?"hdd-o":"hdd-o",dmB:e.drive2Model,dnB:e.drive2Quantity,dcB:e.drive2MarketingCapacity,dtB:e.drive2DriveType,deB:{"disable-tag":!e.drive2Encrypted},dfB:{"disable-tag":!e.drive2FlashPool},doB:{"disable-tag":e.drive2Sellable},conflicts:e.config.conflicts}))}});var x,k,O;if(u){if(p._isembedded){x="Change Internal Drives";k={display:"none;"}}else{var I=E.deletingShelf(m),M=i.last(I),F=i.partial(this._deleteShelf,M.newVersion);x="Change Shelf";k={};O=s.createElement(a,{isToggle:false,select:F,selected:false,enabled:M&&M.isEnabled},"Delete")}}else{x="Add Shelf";k={}}var q;if(P.length>0){q=s.createElement("div",null,P)}else{q=null}return s.createElement("div",null,s.createElement(n,{columnTitle:x},O,s.createElement(a,{isToggle:false,select:this._close,selected:false,enabled:true},"Close")),s.createElement("div",null,s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group"},s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"",ref:"FilterSpeedNone",id:"FilterSpeedNone"}),s.createElement("label",{htmlFor:"FilterSpeedNone",className:"btn btn-default"},s.createElement("span",null," All")),s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"7.2",id:"FilterSpeed72"}),s.createElement("label",{htmlFor:"FilterSpeed72",className:"btn btn-default"},s.createElement("span",null," 7.2K",s.createElement(l,{name:"hdd-o"}))),s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"10",id:"FilterSpeed10"}),s.createElement("label",{htmlFor:"FilterSpeed10",className:"btn btn-default"},s.createElement("span",{className:"text-blue"}," 10K",s.createElement(l,{name:"hdd-o"}))),s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"15",id:"FilterSpeed15"}),s.createElement("label",{htmlFor:"FilterSpeed15",className:"btn btn-default"},s.createElement("span",{className:"text-green"}," 15K",s.createElement(l,{name:"hdd-o"}))),s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"50",id:"FilterSpeed50"}),s.createElement("label",{htmlFor:"FilterSpeed50",className:"btn btn-default"},s.createElement("span",{className:"text-purple"}," SSD",s.createElement(l,{name:"hdd-o"}))),s.createElement("input",{onChange:this._filterSpeedChange,type:"radio",name:"filterShelvesBySpeed",value:"split",id:"FilterSpeedSplit"}),s.createElement("label",{htmlFor:"FilterSpeedSplit",className:"btn btn-default"},s.createElement("span",{className:"text-orange"}," Mixed",s.createElement(l,{name:"code-fork"})))),s.createElement("div",{className:"btn-group pull-right"},s.createElement(c,{onClick:this._filterShowEoa,title:"toggle show end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:this.state.showEoa}},"Show EOA"),s.createElement(c,{onClick:this._filterHideEoa,title:"toggle hide end of availability",alignRight:true,extraClasses:{"btn-default":true,"no-border":false,toggled:!this.state.showEoa}},"Hide EOA"))),s.createElement("div",{className:"filter-pane"},s.createElement("div",{className:"btn-group",style:k},s.createElement("input",{onChange:this._filterChangeModel,type:"radio",name:"filterShelvesByModel",value:"",ref:"FilterModelNone",id:"FilterModelNone"}),s.createElement("label",{htmlFor:"FilterModelNone",className:"btn btn-default"},s.createElement("span",null," All")),this._renderShelfFilter())),s.createElement(o,{top:"130"},R,q)))
}});t.exports=f},{"../../lib/constants.js":65,"./button":8,"./faglyph":16,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./tooltip":45}],40:[function(e,t,r){"use strict";var i=window.React,s=e("./repeat"),n=e("./system-listed");var a=i.createClass({displayName:"SystemList",propTypes:{hagroups:i.PropTypes.array.isRequired,isStandAlone:i.PropTypes.bool.isRequired,currentSelection:i.PropTypes.object.isRequired,select:i.PropTypes.func.isRequired},render:function(){return i.createElement(s,{seq:this.props.hagroups,prop:"hagroup",className:this.props.isStandAlone?"hc-standalones":""},i.createElement(n,{isStandAlone:this.props.isStandAlone,currentSelection:this.props.currentSelection,select:this.props.select}))}});t.exports=a},{"./repeat":34,"./system-listed":41}],41:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./drive-summary"),a=e("../../lib/clip/util");var o=s.createClass({displayName:"ListedSystem",propTypes:{hagroup:s.PropTypes.object.isRequired,isStandAlone:s.PropTypes.bool.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},isSelected:function(e,t,r){var s=false,n=false;var a=i(e).has("cluster")?e.cluster._id:"",o=i(e).has("hagroup")?e.hagroup._id:"";if(a){var l=t.cluster&&t.cluster._id||"";s=a===l?true:false}if(o){var c=t._id||"";n=o===c?true:false}return r?n:s&&n},selectSystem:function(e){e.stopPropagation();e.preventDefault();var t={hagroup:{_id:this.props.hagroup._id}};this.props.select(t,"SystemOverview")},render:function(){var e=this.props.hagroup,t=this.props.currentSelection,r=this.props.isStandAlone,o=this.isSelected(t,e,r);var l=e.controllers||[],c=r?l.length:"",u=r?e.model:e._model;var p=a.getDriveDescriptionsFromXboms([e]),d=s.addons.classSet({system:true,selectable:true,selected:o});return s.createElement("div",{className:d,onClick:this.selectSystem},s.createElement("span",{className:r?"name":"sub-name"},i(l).flatten("name").compact().join(" / ")||"un-named"),s.createElement("div",{className:"system-components"},s.createElement("div",{className:"drive-summary-block controller no-overflow"},s.createElement("span",{className:"drive-count"},c),s.createElement("span",{className:"fa fa-fw fa-netapp-controller"}),s.createElement("span",{className:"drive-label"},u)),s.createElement(n,{hideIfZero:true,hideCapacity:true,drives:p})))}});t.exports=o},{"../../lib/clip/util":64,"./drive-summary":15}],42:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/column-header"),a=e("./layout/action-link"),o=e("./layout/scrollable-region"),l=e("./shelf-details"),c=e("./aggregate-details"),u=e("./system-policies"),p=e("./hw-shelf-drive-group"),d=e("../usual-props"),f=e("./constants");var h=s.createClass({displayName:"HardwareDisplay",propTypes:i.merge({systems:s.PropTypes.any.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func,selectDetails:s.PropTypes.object.isRequired,col3View:s.PropTypes.string},d.isRequired),_addSystem:function(e,t){t.stopPropagation();t.preventDefault();this.props.select();var r=this._getFirstSystem();this.props.fire("PROJECT_EXPAND_CLUSTER",r.cluster._id,e)},_removeSystem:function(e){e.stopPropagation();e.preventDefault();this.props.select();var t=this._getFirstSystem();this.props.fire("PROJECT_REMOVE_SYSTEM",t._id)},_deleteSystem:function(e,t){t.stopPropagation();t.preventDefault();var r=this._getFirstSystem();this.props.fire("PROJECT_REMOVE_SYSTEM",r._id);if(e){if(r.is_clustered){this.props.fire("PROJECT_SET_CLUSTER_VERSION",r.cluster._id,e)}else{this.props.fire("PROJECT_SET_SYSTEM_VERSION",r._id,e)}}this.props.clearSelection()},_getWrappedSystems:function(){var e=this.props,t=Array.isArray(e.systems),r=t?e.systems:[e.systems];return r},_getFirstSystem:function(){var e=this.props,t=Array.isArray(e.systems),r=t?e.systems[0]:e.systems;return r},selectShelf:function(e,t){t.stopPropagation();t.preventDefault();var r={shelf:{_id:e._id}};this.props.select(r,f.UI_SELECT_ADD_CHANGE_SHELF_DRIVE_LIST)},changeSystem:function(e){e.stopPropagation();e.preventDefault();this.props.select({},f.UI_SELECT_ADD_CHANGE_SYSTEMS)},changeVersion:function(e){e.stopPropagation();e.preventDefault();this.props.select({},"VersionList")},_isSelected:function(e,t){if(e&&t){if(e._id===t._id){return true}}return false},renderEmbeddedShelfSummary:function(e){var t=i(e.shelves).find({_isembedded:true}),r=s.addons.classSet({"row-list-item":true,selectable:true,selected:this._isSelected(t,this.props.selectDetails.shelf)});if(!t){return s.createElement("div",null)}else{var n=this._getFirstSystem(),a=this.props.map.inspect(n).config.matrix,o=n.version;var l=i.partial(this.selectShelf,t),c=this.props.systems.length||1,u=c,d=i.isEmpty(t._x_bom)?[]:t._x_bom.drive_specs,f=i.map(d,function(e){var r=a.checkVersionShelfDrive(o,t.model,e.model);return s.createElement(p,{driveGroup:e,fpSupport:r.fp_support_drive,shelfCount:u})});return s.createElement("div",{className:r,onClick:l},s.createElement("div",{className:"row-list-cell row-list-cell-s"}),s.createElement("div",{className:"row-list-cell"},s.createElement("div",null,s.createElement("span",{className:"emphasize"},"Internal drives")),f),s.createElement("span",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-chevron-right"})))}},render:function(){var e=this.props,t=Array.isArray(e.systems),r=this._getFirstSystem(),n=r.model,a=t?"":i(r.controllers).map("name").join("/"),c;var u=this.props.map.inspect(r).config.matrix,p=u.getFullNameForVersion(r.version);var d=n.replace(" ",""),h=d.replace("V","FAS"),m="../media/img/"+h+"_front_view.png";var g=r._policies||{},y=g.version||{},v=y.pin?{version:r.version}:{};var _=i.pick(e.selectDetails,["installation","cluster"]),E=e.map.guard(_,v);if(t&&r.controllers.length>1){var b=E.addingSystem(),w=i.where(b,function q(e){return e.isEnabled&&e.configModel===r._model}),S=i.first(w);if(i.isEmpty(S)){c=s.createElement("div",{className:"row-list-cell row-list-cell-s"},s.createElement("span",{className:"fa fa-fw fa-minus",onClick:this._removeSystem}),s.createElement("input",{type:"text",value:e.systems.length,className:"input-count"}))}else{var A=S.buildSpec(e.selectDetails),C=i.partial(this._addSystem,i.first(A));c=s.createElement("div",{className:"row-list-cell row-list-cell-s"},s.createElement("span",{className:"fa fa-fw fa-minus",onClick:this._removeSystem}),s.createElement("input",{type:"text",value:e.systems.length,className:"input-count"}),s.createElement("span",{className:"fa fa-fw fa-plus",onClick:C}))}}else{var T=i.pick(e.selectDetails,["installation","cluster","hagroup"]),R=E.deletingSystem(T),P=i.last(R),N=P?P.newVersion:undefined,D=i.partial(this._deleteSystem,N);c=s.createElement("div",{className:"row-list-cell row-list-cell-s"},s.createElement("span",{className:"fa fa-fw fa-trash",onClick:D}))}var x=this.renderEmbeddedShelfSummary(r),k=i(r.shelves).find({_isembedded:true}),O=s.addons.classSet({"row-list-item":true,"row-list-item-group-next":k,selectable:true,selected:this.props.col3View===f.UI_SELECT_ADD_CHANGE_SYSTEMS});var I,M,F=s.addons.classSet({"row-list-item":true,selectable:true,selected:this.props.col3View==="VersionList"});if(!y.pin){I=s.createElement("div",null,p)}else{M=s.createElement("div",{className:F,onClick:this.changeVersion},s.createElement("div",{className:"row-list-cell row-list-cell-s"}),s.createElement("div",{className:"row-list-cell"},s.createElement("span",null,p),s.createElement("br",null)),s.createElement("span",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-chevron-right"})))}return s.createElement(o,null,s.createElement("div",{className:"row-list-item-grouping"},s.createElement("div",{className:O,onClick:this.changeSystem},c,s.createElement("div",{className:"row-list-cell row-list-cell-l"},s.createElement("span",{className:"emphasize"},r._model),s.createElement("br",null),I,s.createElement("span",null,a)),s.createElement("div",{className:"row-list-cell row-list-cell-m row-list-cell-img hide-contracted-full"},s.createElement("img",{src:m,className:"controller-img",alt:n})),s.createElement("span",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-chevron-right"}))),x,M),s.createElement(l,{systems:this._getWrappedSystems(),map:e.map,fire:e.fire,select:this.props.select,selected:this.props.selectDetails,className:"hw-details-level-1",col3View:this.props.col3View}))}});var m=s.createClass({displayName:"AggregatesDisplay",propTypes:i.merge({systems:s.PropTypes.any.isRequired,aggregateDisplayLanguage:s.PropTypes.string.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func,selectDetails:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired},d.isRequired),render:function(){return s.createElement(o,null,s.createElement(c,s.__spread({systems:this.props.systems,aggregateDisplayLanguage:this.props.aggregateDisplayLanguage,clearSelection:this.props.clearSelection,select:this.props.select,selectDetails:this.props.selectDetails,userPreferences:this.props.userPreferences},d(this.props))))}});var g=s.createClass({displayName:"CurrentTabDisplay",propTypes:i.merge({currentTab:s.PropTypes.string.isRequired,aggregateTabName:s.PropTypes.string.isRequired,systems:s.PropTypes.any.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func,selectDetails:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired,col3View:s.PropTypes.string},d.isRequired),render:function(){var e=this.props,t=e.aggregateTabName===e.currentTab?"Aggregates":e.currentTab;switch(t){case"Hardware":return s.createElement(h,s.__spread({systems:e.systems,clearSelection:e.clearSelection,select:e.select,selectDetails:e.selectDetails,col3View:e.col3View},d(this.props)));case"Aggregates":return s.createElement(m,s.__spread({systems:e.systems,aggregateDisplayLanguage:e.aggregateTabName,clearSelection:e.clearSelection,select:e.select,selectDetails:e.selectDetails,userPreferences:e.userPreferences},d(this.props)));case"Policies":return s.createElement(u,s.__spread({hagroups:[e.systems],hardwareSelector:e.selectDetails},d(this.props)))}}});var y=s.createClass({displayName:"SystemOverview",propTypes:i.merge({systems:s.PropTypes.any.isRequired,select:s.PropTypes.func.isRequired,clearSelection:s.PropTypes.func,selectDetails:s.PropTypes.object.isRequired,userPreferences:s.PropTypes.object.isRequired,col3View:s.PropTypes.string,col2Tab:s.PropTypes.string.isRequired,selectCol2View:s.PropTypes.func.isRequired},d.isRequired),getInitialState:function(){return{currentTab:this._convertViewtoTabUntilWeRefactor()}},_convertViewtoTabUntilWeRefactor:function(){switch(this.props.col2Tab){case"SystemOverview":return"Hardware";case"Aggregates":return this._aggregateTabName();case"Policies":return"Policies";default:return"Hardware"}},_changeTabHardware:function(e){e.stopPropagation();e.preventDefault();this.setState({currentTab:"Hardware"});this.props.selectCol2View("SystemOverview")},_changeTabAggregates:function(e){e.stopPropagation();e.preventDefault();this.setState({currentTab:this._aggregateTabName()});this.props.selectCol2View("Aggregates")},_aggregateTabName:function(){console.log("determining aggr tab name with systems: ",this.props.systems);var e=this.props.map,t=i.map(this.props.systems,function(t){return e.inspect(t).isESeries}),r=i.every(t);if(r){return"Storage Containers"}else{return"Aggregates"}},_changeTabPolicies:function(e){e.stopPropagation();e.preventDefault();this.setState({currentTab:"Policies"});this.props.selectCol2View("Policies")},render:function(){var e=this.props,t=this._aggregateTabName(),r=e.systems.length===1?e.systems[0]:e.systems,i=e.systems.length>1?"Systems Detail":"System Details",o="Options",l=this.state.currentTab;var c=l==="Hardware"?i:l==="Policies"?o:l;return s.createElement("div",null,s.createElement(n,{columnTitle:c},s.createElement(a,{isToggle:true,select:this._changeTabHardware,selected:l==="Hardware",enabled:true,hideContracted:true},"Hardware"),s.createElement(a,{isToggle:true,select:this._changeTabAggregates,selected:l===t,enabled:true,hideContracted:true},t),s.createElement(a,{isToggle:true,select:this._changeTabPolicies,selected:l==="Policies",enabled:true,hideContracted:true},"Options")),s.createElement(g,s.__spread({currentTab:l,aggregateTabName:t,systems:r,clearSelection:e.clearSelection,selectDetails:e.selectDetails,select:e.select,userPreferences:e.userPreferences,col3View:e.col3View},d(this.props))))}});t.exports=y},{"../usual-props":51,"./aggregate-details":2,"./constants":14,"./hw-shelf-drive-group":21,"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./shelf-details":38,"./system-policies":43}],43:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/scrollable-region"),a=e("./faglyph");var o=s.createClass({displayName:"SystemPolicies",propTypes:{map:s.PropTypes.object.isRequired,hagroups:s.PropTypes.array.isRequired,hardwareSelector:s.PropTypes.object.isRequired},render:function(){var e=i.first(this.props.hagroups)||{},t=e._policies||{};var r=i.pick(this.props.hardwareSelector,["installation","cluster","hagroup"]),a=this.props.map.guard(r),o=a.policies(),c=i.where(o,{isEnabled:true}),u=i.groupBy(c,"scope"),p=i.map(u,d,this);function d(e){return s.createElement(l,s.__spread({},this.props,{currentPolicies:t,optionGroup:e}))}return s.createElement(n,null,p)}});var l=s.createClass({displayName:"PolicyGroup",propTypes:{optionGroup:s.PropTypes.array.isRequired},render:function(){var e=i.map(this.props.optionGroup,t,this);function t(e){return s.createElement(c,s.__spread({},this.props,{scope:e.scope,policy:e.policy,label:e.label,defaultValue:e.defaultValue,invertedToggle:e.inverted,impactsCluster:e.impactsCluster,allowedValues:e.allowedValues}))}return s.createElement("div",{className:"row-list-item-grouping"},e)}});var c=s.createClass({displayName:"PolicyContainer",propTypes:{scope:s.PropTypes.string.isRequired,policy:s.PropTypes.string.isRequired,allowedValues:s.PropTypes.array,impactsCluster:s.PropTypes.bool.isRequired,map:s.PropTypes.object.isRequired,hagroups:s.PropTypes.array.isRequired,hardwareSelector:s.PropTypes.object.isRequired,fire:s.PropTypes.func.isRequired},render:function(){var e=this.props.currentPolicies[this.props.scope]||{},t=e[this.props.policy],r=!i.isEmpty(this.props.allowedValues),n;if(r){n=i.contains(this.props.allowedValues,t);return s.createElement(u,s.__spread({},this.props,{currentPolicy:t,isEnabled:n,handleClick:this.handleClick}))}else{n=t!==undefined?t:this.props.defaultValue;return s.createElement(d,s.__spread({},this.props,{isEnabled:n,handleClick:this.handleClick}))}},handleClick:function(e,t){t.stopPropagation();t.preventDefault();var r=this.props.fire,s=this.props.scope,n=i.first(this.props.hagroups),a={};a[this.props.policy]=e;if(this.props.impactsCluster&&n&&n.is_clustered){r("PROJECT_SET_CLUSTER_POLICY",n.cluster._id,s,a)}else{i.forEach(this.props.hagroups,o)}if(s==="version"&&this.props.policy==="pin"&&e===false){this.handleAutoVersion()}function o(e){r("PROJECT_SET_SYSTEM_POLICY",e._id,s,a)}},handleAutoVersion:function(){var e=i.pick(this.props.hardwareSelector,["installation","cluster"]),t=this.props.map.guard(e);var r=i.pick(this.props.hardwareSelector,["installation","cluster","hagroup"]),s=t.changingVersion(r),n=i.where(s,{isEnabled:true}),a=i.last(n),o=a?a.newVersion:undefined;var l=this.props.fire,c=i.first(this.props.hagroups);if(o){if(c&&c.is_clustered){l("PROJECT_SET_CLUSTER_VERSION",c.cluster._id,o)}else{i.forEach(this.props.hagroups,u)}}function u(e){l("PROJECT_SET_SYSTEM_VERSION",e._id,o)}}});var u=s.createClass({displayName:"SelectPolicy",propTypes:{defaultValue:s.PropTypes.string.isRequired,isEnabled:s.PropTypes.bool.isRequired,allowedValues:s.PropTypes.array.isRequired,handleClick:s.PropTypes.func.isRequired},render:function(){var e=i.map(this.props.allowedValues,t,this);function t(e){return s.createElement(p,s.__spread({},this.props,{optionValue:e,handleClick:this.props.handleClick}))}var r=this.props.isEnabled?"":this.props.defaultValue,n=i.partial(this.props.handleClick,r);return s.createElement(f,s.__spread({},this.props,{handleClick:n}),e)}});var p=s.createClass({displayName:"SelectOption",propTypes:{currentPolicy:s.PropTypes.string.isRequired,optionValue:s.PropTypes.string.isRequired,isEnabled:s.PropTypes.bool.isRequired,handleClick:s.PropTypes.func.isRequired},render:function(){var e=s.addons.classSet({"row-list-item":true,"row-list-item-loose":true,selectable:this.props.isEnabled,disabled:!this.props.isEnabled}),t=this.props.currentPolicy===this.props.optionValue?"check":"";var r=i.partial(this.props.handleClick,this.props.optionValue),n=this.props.isEnabled?r:this.suppressClick;return s.createElement("div",{className:e,onClick:n},s.createElement("div",{className:"row-list-cell"},this.props.optionValue),s.createElement("span",{className:"chevron"},s.createElement(a,{name:t})))},suppressClick:function(e){e.stopPropagation();e.preventDefault()}});var d=s.createClass({displayName:"BooleanPolicy",propTypes:{isEnabled:s.PropTypes.bool.isRequired,handleClick:s.PropTypes.func.isRequired},render:function(){var e=i.partial(this.props.handleClick,!this.props.isEnabled);return s.createElement(f,s.__spread({},this.props,{handleClick:e}))}});var f=s.createClass({displayName:"Policy",propTypes:{label:s.PropTypes.string.isRequired,invertedToggle:s.PropTypes.bool.isRequired,isEnabled:s.PropTypes.bool.isRequired,handleClick:s.PropTypes.func.isRequired},render:function(){var e="row-list-item selectable row-list-item-loose",t=this.props.invertedToggle?"toggle-off":"toggle-on",r=this.props.invertedToggle?"toggle-on":"toggle-off",i=this.props.isEnabled?t:r;return s.createElement("div",null,s.createElement("div",{className:e,onClick:this.props.handleClick},s.createElement("div",{className:"row-list-cell"},this.props.label),s.createElement("span",{className:"chevron"},s.createElement(a,{name:i}))),this.props.children)}});t.exports=o},{"./faglyph":16,"./layout/scrollable-region":26}],44:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./drive-summary"),a=e("./system-list"),o=e("../../lib/clip/util");var l=s.createClass({displayName:"SystemSummary",propTypes:{hagroups:s.PropTypes.array.isRequired,isGrouped:s.PropTypes.bool.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},render:function(){if(this.props.isGrouped){return s.createElement(c,{hagroups:this.props.hagroups,currentSelection:this.props.currentSelection,select:this.props.select})}else{return s.createElement(a,{hagroups:this.props.hagroups,isStandAlone:false,currentSelection:this.props.currentSelection,select:this.props.select})}}});var c=s.createClass({displayName:"GroupedSystemList",propTypes:{hagroups:s.PropTypes.array.isRequired,currentSelection:s.PropTypes.object.isRequired,select:s.PropTypes.func.isRequired},_getNodeCounts:function(){var e={};i.forEach(this.props.hagroups,function(t){var r=e[t.model]||0,i=r+t.controllers.length;e[t.model]=i});return e},_renderNodeCount:function(e,t){return s.createElement("div",{className:"drive-summary-block controller"},s.createElement("span",{className:"drive-count"},e),s.createElement("span",{className:"fa fa-netapp-controller fa-fw"}),s.createElement("span",{className:"drive-label"},t))},isSelected:function(e,t){var r=false,s=false;var n=i(e).has("cluster")?e.cluster._id:"",a=i(e).has("hagroup")?e.hagroup._model:"";if(n){var o=t.cluster&&t.cluster._id||"";r=n===o?true:false}if(a){var l=t._model||"";s=a===l?true:false}return r&&s},selectGroup:function(e){e.stopPropagation();e.preventDefault();var t={hagroup:{_model:this.props.hagroups[0]._model}};this.props.select(t,"SystemOverview")},render:function(){var e=this.props.hagroups,t=this.props.currentSelection,r=o.getDriveDescriptionsFromXboms(e),a=s.addons.classSet({selectable:true,selected:this.isSelected(t,e[0])});return s.createElement("div",{className:a,onClick:this.selectGroup},i.map(this._getNodeCounts(),this._renderNodeCount),s.createElement(n,{hideIfZero:true,hideCapacity:true,drives:r}))}});t.exports=l},{"../../lib/clip/util":64,"./drive-summary":15,"./system-list":40}],45:[function(e,t,r){"use strict";var i=window.React,s=i.addons.classSet,n=window._;var a={left:function c(e,t){return{left:e.left-t.width,top:e.top+e.height/2-t.height/2}},top:function u(e,t){return{left:e.left+e.width/2-t.width/2,top:e.top-t.height+16}}};var o=i.createClass({displayName:"Tooltip",propTypes:{position:function p(e,t){var r=e[t];if(!a[r]){throw new Error("unknown position: "+r)}},title:i.PropTypes.string,titleClassName:i.PropTypes.string},componentDidMount:function(){this.updatePosition();window.addEventListener("resize",this.updatePosition);var e=this.getDOMNode().parentNode;e.addEventListener("mouseenter",this._onMouseEnterParent);e.addEventListener("mouseleave",this._onMouseLeaveParent)},componentWillUnmount:function(){window.removeEventListener("resize",this.updatePosition);var e=this.getDOMNode().parentNode;e.removeEventListener("mouseenter",this._onMouseEnterParent);e.removeEventListener("mouseleave",this._onMouseLeaveParent)},updatePosition:function(){var e=this.getDOMNode(),t=e.getBoundingClientRect(),r=e.parentNode.getBoundingClientRect(),i=a[this.props.position],s=i(r,t);this.setState({left:s.left,top:s.top})},_onMouseEnterParent:function(){this.updatePosition();this.setState({visible:true})},_onMouseLeaveParent:function(){this.setState({visible:false})},getInitialState:function(){return{left:0,top:0,visible:false}},render:function(){var e=this.state,t={popover:true},r={"popover-title":true},a={display:"block",visibility:e.visible?"visible":"hidden",position:"fixed",left:e.left,top:e.top};t[this.props.position]=true;n.each((this.props.titleClassName||"").split(" "),function(e){r[e]=true});return i.createElement("div",{className:s(t),style:a},i.createElement("div",{className:"arrow"}),!this.props.title?null:i.createElement("div",{className:s(r)},l(this.props.title)),i.createElement("div",{className:"popover-content"},this.props.children))}});function l(e){var t=e.split("\\n"),r=[];for(var s in t){if(s>0){r.push(i.createElement("br",null))}r.push(t[s])}return r}t.exports=o},{}],46:[function(e,t,r){"use strict";var i=window._,s=window.React,n=e("./layout/action-link"),a=e("./layout/column-header"),o=e("./layout/scrollable-region"),l=e("./repeat");var c=s.createClass({displayName:"VersionList",propTypes:{hagroups:s.PropTypes.array.isRequired,map:s.PropTypes.object.isRequired,hardwareSelector:s.PropTypes.object.isRequired,handleClose:s.PropTypes.func.isRequired,fire:s.PropTypes.func.isRequired},render:function(){var e=i.pick(this.props.hardwareSelector,["installation","cluster"]),t=this.props.map.guard(e);var r=i.pick(this.props.hardwareSelector,["installation","cluster","hagroup"]),c=t.changingVersion(r);var p=i.first(this.props.hagroups),d=this.props.map.inspect(p).config.matrix;return s.createElement("div",null,s.createElement(a,{columnTitle:"Change OS Version"},s.createElement(n,{isToggle:false,select:this.props.handleClose,selected:false,enabled:true},"Close")),s.createElement(o,null,s.createElement(l,{seq:c,prop:"proposal"},s.createElement(u,{matrix:d,selectedVersion:this.getCurrentVersion(),handleSelect:this.handleVersionChange}))))},handleVersionChange:function(e,t){t.stopPropagation();t.preventDefault();var r=this.props.fire,s=i.first(this.props.hagroups);if(s&&s.is_clustered){r("PROJECT_SET_CLUSTER_VERSION",s.cluster._id,e)}else{i.forEach(this.props.hagroups,n)}this.props.handleClose(t);function n(t){r("PROJECT_SET_SYSTEM_VERSION",t._id,e)}},getCurrentVersion:function(){var e=i.first(this.props.hagroups);return e.version}});var u=s.createClass({displayName:"Proposal",propTypes:{matrix:s.PropTypes.object.isRequired,handleSelect:s.PropTypes.func.isRequired},render:function(){var e=this.props.proposal,t=s.addons.classSet({"row-list-item":true,selectable:e.isEnabled,disabled:!e.isEnabled}),r;if(this.props.selectedVersion===e.newVersion){r=s.createElement("div",{className:"chevron"},s.createElement("span",{className:"fa fa-fw fa-check"}))}var n=this.props.matrix.getFullNameForVersion(e.newVersion);if(e.isEnabled){var a=i.partial(this.props.handleSelect,e.newVersion);return s.createElement("div",{className:t,onClick:a},s.createElement("div",{className:"row-list-cell"},n),r)}else{return s.createElement("div",{className:t},s.createElement("div",{className:"row-list-cell"},n))}}});t.exports=c},{"./layout/action-link":23,"./layout/column-header":24,"./layout/scrollable-region":26,"./repeat":34}],47:[function(e,t,r){"use strict";var i=window.React,s=e("../components/masthead"),n=e("../components/footer"),a=e("../components/project-list"),o=e("../components/session-expiration-overlay"),l=e("../components/motd"),c=e("../retitle");var u=i.createClass({displayName:"PortfolioPage",propTypes:{stores:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired},componentDidMount:function(){c("My Portfolio")},_onPortfolioFetch:function(){this.props.dispatcher.act("PORTFOLIO_FETCH")},render:function(){return i.createElement("div",null,i.createElement(o,{store:this.props.stores.userSession}),i.createElement(s,{store:this.props.stores.userSession,title:"My Portfolio"}),i.createElement("div",{id:"main-panel"},i.createElement("div",{id:"content",className:"indented"},i.createElement("div",{className:"projects"},i.createElement(a,{stores:this.props.stores,fire:this.props.fire}),i.createElement("div",{className:"motd col-sm-4"},i.createElement(l,{stores:this.props.stores})))),i.createElement(n,null)))}});t.exports=u},{"../components/footer":18,"../components/masthead":27,"../components/motd":28,"../components/project-list":32,"../components/session-expiration-overlay":37,"../retitle":50}],48:[function(e,t,r){"use strict";var i=window.React,s=e("../components/masthead"),n=e("../components/footer"),a=e("../components/project"),o=e("../components/session-expiration-overlay");var l=i.createClass({displayName:"ProjectPage",propTypes:{stores:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired,log:i.PropTypes.func.isRequired},getInitialState:function(){return{project:this.props.stores.project.getState()}},componentDidMount:function(){this.props.stores.project.watch(this._onChange);this.setState({project:this.props.stores.project.getState()})},componentWillUnmount:function(){this.props.stores.project.unwatch(this._onChange)},_onChange:function(){this.setState({project:this.props.stores.project.getState()})},_title:function(){var e=this.state.project;if(e.fetching){return"Opening Project…"}else if(e.err){return"Error"}else if(e.name===""){return"Opening Project"}else{var t=e.name||e.uuid,r=t.length>40?t.slice(0,40)+"…":t;return this.state.project.queueStatus.writeQueueLength?r+" (Saving)":r}},render:function(){return i.createElement("div",null,i.createElement(o,{store:this.props.stores.userSession}),i.createElement(s,{store:this.props.stores.userSession,title:this._title()}),i.createElement(a,i.__spread({uuid:this.props.params.uuid,version:this.props.params.version},this.props)),i.createElement(n,null))}});t.exports=l},{"../components/footer":18,"../components/masthead":27,"../components/project":33,"../components/session-expiration-overlay":37}],49:[function(e,t,r){"use strict";var i=window.React,s=e("../components/masthead"),n=e("../retitle");var a=i.createClass({displayName:"ReleaseNotesPage",propTypes:{stores:i.PropTypes.object.isRequired,fire:i.PropTypes.func.isRequired},componentDidMount:function(){n("Release Notes")},render:function(){return i.createElement("div",null,i.createElement(s,{store:this.props.stores.userSession,title:"Release Notes"}),i.createElement("div",{id:"main-panel"},i.createElement("div",{className:"release-notes"},i.createElement("h2",null,"Release Notes Synergy 6 Beta-3 (February 9, 2015)"),i.createElement("h3",null,"Features:"),i.createElement("ul",null,i.createElement("li",null,"E Series Platform support"),i.createElement("li",null,"Flash Pool support"),i.createElement("li",null,"Report output in Word format"),i.createElement("li",null,"Enforce system limits and ensure configurations are always valid when shelves/drives are deleted"),i.createElement("li",null,"Root data partitioning for SSD on All Flash FAS (AFF)")),i.createElement("h3",null,"Known Bugs:"),i.createElement("ul",null,i.createElement("li",null,"Session expires after 1 hour. If Synergy becomes unresponsive, click Refresh to login and reestablish a session."),i.createElement("li",null,'When "Automatically fill system with aggregates" is disabled,  Auto- aggregates is still created when new drives are added.'),i.createElement("li",null,"Shelves/drives are not allowed to delete if manual aggregate is assigned to it. Ideally we should allow user to do that and reassigned aggregate to other free drives."),i.createElement("li",null,"Firefox browsers yield an “Unresponsive script” message upon first access. Click the Continue button to access Synergy for full functionality.")),i.createElement("hr",null),i.createElement("h2",null,"Release Notes Synergy 6 Beta-2 (December 23, 2014)"),i.createElement("h3",null,"Features:"),i.createElement("ul",null,i.createElement("li",null,"Support Root-Data HDD partition"),i.createElement("li",null,"Support manual aggregate"),i.createElement("li",null,"Project can be deleted"),i.createElement("li",null,"UI Enhancements based upon FAB and Insight Feedback")),i.createElement("h3",null,"Known Bugs:"),i.createElement("ul",null,i.createElement("li",null,"Cluster maximum node limit is not considered or restricted"),i.createElement("li",null,"System maximum storage limit is not considered or restricted"),i.createElement("li",null,"Aggregate maximum limit is not considered or restricted"),i.createElement("li",null,"Session expires after 1 hour.  If Synergy becomes unresponsive, click Refresh to login and reestablish a session.")),i.createElement("hr",null),i.createElement("h2",null,"Release Notes Synergy 6 Beta-1 (October 20, 2014)"),i.createElement("h3",null,"Features:"),i.createElement("ul",null,i.createElement("li",null,"Accessible by employees and partners (Windows/Mac desktop browsers only)"),i.createElement("li",null,"Persistent cloud storage of projects"),i.createElement("li",null,"Project search by name and metadata (tags)"),i.createElement("li",null,"User can add/edit/delete clustered and unclustered controllers to a project. "),i.createElement("li",null,"User can add/edit/delete shelves for a controller"),i.createElement("li",null,"User can specify drives for a shelf"),i.createElement("li",null,"Auto-aggregate creation according to best practices (TR-3838)"),i.createElement("li",null,"Usable capacity calculations are shown in a summary pane")),i.createElement("h3",null,"Known Bugs:"),i.createElement("ul",null,i.createElement("li",null,"Cluster maximum node limit is not considered or restricted"),i.createElement("li",null,"System maximum storage limit is not considered or restricted"),i.createElement("li",null,"Session expires after 1 hour.  If Synergy becomes unresponsive, click Refresh to login and reestablish a session.")),i.createElement("hr",null),i.createElement("h3",null,"Beta-1 Patch 1 (November 17, 2014)"),i.createElement("ul",null,i.createElement("li",null,"UI Enhancements based upon FAB and Insight Feedback"),i.createElement("li",null,"Fix incorrect drive count for NL-SAS in summary result")))))}});t.exports=a},{"../components/masthead":27,"../retitle":50}],50:[function(e,t,r){"use strict";var i="Synergy 6",s=" – ";function n(e){if(e){e=e+s+i}else{e=i}if(window&&window.document){window.document.title=e}}t.exports=n},{}],51:[function(e,t,r){"use strict";var i=e("../lib/xform"),s=e("assert"),n=e("../lib/model/map"),a=window.React,o=window._;var l={fire:u(p()),log:u(p()),map:u(d(n))};function c(e){return i(l,e,"props")}o.forEach(l,function(e,t){if(e.propCheck){c[t]=e.propCheck}});Object.defineProperty(c,"isRequired",{get:function h(){return o.mapValues(c,function e(t){if(typeof t.isRequired==="function"){return t.isRequired
}else{return t}})}});function u(e){return f(t,e.propCheck);function t(t,r){if(t===undefined){return undefined}else{return e(t,r)}}}function p(e){return f(t,a.PropTypes.func);function t(t,r){s.equal(typeof t,"function",r+": not function");if(typeof e==="number"){s.equal(t.length,e,r+": need "+e+"-arity")}return t}}function d(e){return f(t,a.PropTypes.object);function t(t,r){s(t instanceof e,"function",r+": not "+e.name);return t}}function f(e,t){if(t){e.propCheck=t}return e}t.exports=c},{"../lib/model/map":102,"../lib/xform":124,assert:127}],52:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("./lcprop");var a=["groupBy"],o={filter:true,map:false},l=["concat"];function c(e,t,r){i(e instanceof Array,"b7b22b45.0");t=t||{};i(typeof t==="object"&&!s.isArray(t),"b7b22b45.1");Object.defineProperty(e,"where",{get:s.constant(h),enumerable:false,configurable:true});s.forEach(a,u);s.forEach(o,p);s.forEach(l,d);if(r){Object.defineProperty(e,"and",{get:s.constant(h),enumerable:false,configurable:true})}s.forEach(t,f);return e;function u(t){var r=s[t];i.equal(typeof r,"function","b7b22b45.2: "+t);Object.defineProperty(e,t,{value:s.partial(r,e),enumerable:false,configurable:true})}function p(r,n){var a=s[n],o=r?t:{};i.equal(typeof a,"function","b7b22b45.2: "+n);Object.defineProperty(e,n,{value:function(){return m(a,arguments,o)},enumerable:false,configurable:true})}function d(r){var s=Array.prototype[r];i.equal(typeof s,"function","b7b22b45.3: "+r);Object.defineProperty(e,r,{value:function(){var r=s.apply(e,arguments);return c(r,t,false)},enumerable:false,configurable:true})}function f(r,i){n(h,i,a,true);function a(){return c(s.filter(e,r),t,true)}}function h(){return m(s.where,arguments)}function m(r,i,n){n=n||t;var a=[e].concat(s.toArray(i));return c(r.apply(e,a),n,true)}}t.exports=c},{"./lcprop":72,assert:127}],53:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=window._;function a(){i(this instanceof a,"use new");i(typeof this._init==="function","define _init");i(typeof this._get==="function","define _get");i(typeof this._set==="function","define _set");this.poisoned={}}a.prototype.init=function p(e){i(typeof e==="function");var t=this.constructor.name;function r(r,s){if(r){try{i(r instanceof Error);i(arguments.length===1)}catch(n){console.error("cache:",t,"_init mis-reports errors")}console.error("cannot initialise",t,r);e(r);return}else{try{i(typeof s==="boolean")}catch(a){console.error("cache:",t,"_init mis-reports success")}e(null,!!s)}}try{this._init(r)}catch(s){e(s)}};a.prototype.get=function d(e,t){i(typeof e==="string");i(typeof t==="function");var r;function s(r,i){if(r){console.error("cache: error getting",e,r);i=undefined}t(null,i);t=n.noop}if(this.poisoned[e]){t(null,undefined);return}try{r=this._get(e,s)}catch(a){console.error("cache: crash getting",e,a);t(null,undefined)}};a.prototype.set=function f(e,t,r){i(typeof e==="string");i(typeof r==="function");var s=this.poisoned;function a(t){if(t){console.error("cache: error setting",e,t);s[e]=true}else{delete s[e]}r(null);r=n.noop}try{this._set(e,t,a)}catch(o){console.error("cache: crash setting",e,o);s[e]=true;r(null)}};a.prototype.remove=function h(e,t){i(typeof e==="string");i(typeof t==="function");var r=this.poisoned;function s(i){if(i){console.error("cache: error removing",e,i);r[e]=true}else{delete r[e]}t(null);t=n.noop}try{this._remove(e,s)}catch(a){console.error("cache: crash removing",e,a);r[e]=true;t(null)}};function o(){i(this instanceof o,"use new");a.call(this);this.ok=true}s.inherits(o,a);o.prototype._init=function m(e){e(null,true)};o.prototype._get=function g(e,t){t(null,undefined)};o.prototype._set=function y(e,t,r){r(null)};o.prototype._remove=function v(e,t){t(null)};function l(){i(this instanceof l,"use new");a.call(this)}s.inherits(l,a);l.prototype._init=function _(e){var t=(new Date).toString(),r=false;try{this.storage=window.localStorage;this.storage.setItem(t,t);r=this.storage.getItem(t)===t?true:false;this.storage.removeItem(t)}catch(i){e(null,false);return}if(r){e(null,true)}else{e(new Error("sentinel mismatch"))}};l.prototype._get=function E(e,t){var r=this.storage.getItem(e),i=r===undefined?undefined:JSON.parse(r);t(null,i)};l.prototype._set=function b(e,t,r){this.storage.setItem(e,t===undefined?undefined:JSON.stringify(t));r(null)};l.prototype._remove=function w(e,t){this.storage.removeItem(e);t(null)};var c=[l,o];function u(e){i(typeof e==="function");var t=n.clone(c),r,s;function a(t,i){if(t){return o()}if(i){e(null,r)}else{o()}}function o(){s=n.first(t);i(typeof s==="function");t=n.rest(t);r=new s;r.init(a)}o()}t.exports=u},{assert:127,util:132}],54:[function(e,t,r){"use strict";var i=e("assert"),s=window._;function n(e){i(typeof e.rpm==="number");if(e.rpm>=50){return"SSD"}else if(e.rpm<9){return"capacity"}else{return"performance"}}function a(e){return s.reduce(e,function(e,t){var r=n(t),i=t.rawgb*t._count/1e3;e.count[r]=(e.count[r]||0)+t._count;e.rawtb[r]=(e.rawtb[r]||0)+i;return e},{rawtb:{},count:{}})}function o(e){i(typeof e==="function");function t(t,r){return s.reduce(e(t).matches,function(e,t){e[t[r]]=(e[t[r]]||0)+t._count;return e},{})}function r(e,r){return s.uniq(s.keys(t(e,r)))}return{nodes:t({_type:"node"},"model"),shelves:t({_type:"shelf"},"model"),versions:r({_type:"node"},"version"),modes:r({_type:"node"},"mode"),drives:a(e({_type:"drive"}).matches)}}t.exports=o},{assert:127}],55:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("../units.js"),a=e("../add-query-api");var o=/^(.*)(P[0-9]+)$/;var l=s.memoize(function b(e){i.equal(typeof e,"number","9c277e6d.t "+typeof e);i(e>0,"9c277e6d.v "+e);return new n(4,"KiB").mult(e).value_gb});function c(e){i.equal(e._type,"hagroup","c2b35515");var t={};var r=s.flatten([d(),h(),g()]);s.forEach(e.controllers||[],n);return a(r,p);function n(e){s.forEach(e.aggregates||[],t);function t(t){var r={_id:t._id,_manual:t._manual,_type:t._type,_root:t.is_root_aggregate,controller:e._id,name:t.name},i=t._raid_groups||[];s.forEach(i,s.partial(o,r));s.forEach(i,o)}}function o(e,t){if(arguments.length===1){t=e;e=s.pick(t,"_id","_type","cache","_manual")}s.forEach(t._devices,function(t){c(t,e)})}function c(e,r){i.equal(typeof e,"string","55da1eb8.1");i.equal(typeof r,"object","55da1eb8.2");var n=t[e];if(!n){return}r=s.defaults({},r,{direct:true});n.consumers.push(r);if(n.parentId){r=s.merge({},r,{direct:false});c(n.parentId,s.merge({},r,{direct:false}))}}function d(){return s(e.shelves).map(f).flatten().value()}function f(r){var i=r._x_bom,s=[];for(var n in i.drive_specs){var a=i.drive_specs[n],o=i.drive_spec_members[n];for(var l in o){var c=o[l],u={id:c,spec:a,virtual:false,shelf:r._id,hagroup:e._id,consumers:[]};t[c]=u;s.push(u)}}return s}function h(){return s(e.controllers).map(m).flatten().value()}function m(e){return s(e._assigned_storage||[]).map("slice_details").map(t).flatten().value();function t(t){return s.map(t.devices,r);function r(r){var i=t.slice,s=u(r),n=v(r,s,i,"root",t.used_blocks,e._id);c(s,{_type:"slice",_id:r,slice:i,sliceType:i==="P2"?"root":"data"});return n}}}function g(){return s(e.controllers).map(y).flatten().value()}function y(e){return s(e.storage_pools||[]).map(t).flatten().value();function t(e){o(e);return s(e._allocations).map(t).flatten().value();function t(e){return e.devices.map(t);function t(t){var r=e.slice,i=u(t),s=v(t,i,r,"fpsp",e.used_blocks);c(i,{_type:"slice",_id:t,slice:r,sliceType:"fp"});return s}}}}function v(r,n,a,o,c,u){i.equal(typeof r,"string","85724289.1");i.equal(typeof n,"string","85724289.2");i.equal(typeof a,"string","85724289.3");i.equal(typeof o,"string","85724289.4");i.equal(typeof c,"number","85724289.5");if(u){i.equal(typeof u,"string","85724289.6")}var p=t[n],d=s.omit(p.spec,"quantity","rsgb","slice","_from_parent"),f=s.merge({},d,{rsgb:l(c),slice:a,_from_parent:s.keys(d)}),h={id:r,spec:f,virtual:true,slice:a,why:o,parentId:n,shelf:p.shelf._id,hagroup:e._id,consumers:[]};if(u&&a==="P2"){f._for_controller=u}t[r]=h;return h}}function u(e){var t=e.match(o);if(t){return t[1]}else{return e}}var p={physical:d,virtual:f,spare:h,used:g,unused:m,locked:_,notroot:y,unlocked:v,storagepool:E};function d(e){return!e.virtual}function f(e){return!!e.virtual}function h(e){return e.consumers.length===0}function m(e){return h(e)}function g(e){return e.consumers.length>0}function y(e){return!s.any(e.consumers,{_root:true})}function v(e){return!s.any(e.consumers,{_manual:true})}function _(e){return s.any(e.consumers,{_manual:true})}function E(e){return!!e.virtual&&e.why==="fpsp"}t.exports={from:{hagroup:c},filters:p}},{"../add-query-api":52,"../units.js":123,assert:127}],56:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("../counting-bag"),a=e("../object-walker");function o(e,t){var r=t.maybe("_x_bom.drive_specs");if(r.exists){for(var i in r.value){var s=r.get(i),n={_type:"drive",model:s.get("model").value,rawgb:s.has("rawgb")?s.get("rawgb").value:0,type:s.get("type").value,rpm:s.get("rpm").value},a=s.has("quantity")?s.get("quantity").value:0;e(n,a)}}}function l(e,t){if(t.has("model")){e({_type:"shelf",model:t.get("model").value})}o(e,t)}function c(e,t){if(t.exists){for(var r in t.value){l(e,t.get(r))}}}function u(e,t){var r,n,o,l;function u(e,t,r){i(a.isWrapped(e));var s=e.maybe(t),n=e.maybe(r);if(s.exists&&n.exists){i(s.value===n.value,[s.path,"must match",n.path,"if both are present"])}}for(var p in t){var d=new a(t[p],["synergy_model","hagroups",p]);d.assert(s.isPlainObject,"expected object");r=null;n=null;o=null;l=undefined;if(d.has("_model")){e({_type:"config",config:d.value._model})}if(d.has("model")){n=d.get("model").value}if(d.has("is_clustered")){o=d.get("is_clustered").value?"c-mode":"7-mode"}if(d.has("controllers")&&d.value.controllers&&d.value.controllers.length){r=d.value.controllers.length}if(d.has("version")){l=d.get("version").value}if(d.has("_x_bom")&&!s.isEmpty(d.value._x_bom)&&d.value._x_bom.system){u(d,"model","_x_bom.system.system_model");u(d,"system_is_clustered","_x_bom.system.is_clustered")}i(r!==null,d.path+": could not determine node count");i(n!==null,d.path+": could not determine node model");i(o!==null,d.path+": could not determine node mode");e({_type:"node",model:n,version:l,mode:o},r);c(e,d.maybe("shelves"))}}function p(e,t){return e+t}function d(e){i(e);i(!("hagroups"in e),"repair");var t=new n,r=t.add.bind(t);if(e.synergy_model){if(e.synergy_model.hagroups){u(r,e.synergy_model.hagroups)}}var a=t.dump();function o(e){if(e){var t=s.where(a,e),r=s.reduce(s.pluck(t,"_count"),p);return{matches:t,_count:r}}else{return a}}return o}t.exports=d},{"../counting-bag":66,"../object-walker":105,assert:127}],57:[function(e,t,r){"use strict";var i=e("assert"),s=e("../xform"),n=e("./repair"),a=e("uuid"),o=e("../constants"),l=window._;function c(e){return function t(r,s){i(l.isArray(r),s+": not array; was "+typeof r);if(typeof e==="string"){l.forEach(r,function n(t){i.equal(typeof t,e,s+": not array of "+e)});return r}else if(typeof e==="function"){return l.map(r,function(t,r){return e(t,s+"["+r+"]")})}else{i(false,s+": invalid arrayOf argument")}}}function u(e,t){if(typeof e==="string"&&e.match(/^P[0-9]+$/)){return e}else{throw new Error(t+": not slice: "+e)}}var p=false,d=s.setdefault,f=s.constant,h=d(a,g);function m(e,t){if(!e){return undefined}else{return g(e,t)}}function g(e,t){try{a.parse(e);return e}catch(r){throw new Error(t+": invalid UUID: "+e)}}function y(e,t){if(typeof e==="number"){return!!e}if(l.has(y,e)){return y[e]}else{throw new Error(t+": can't fix to bool: "+e)}}l.merge(y,{undefined:false,"null":false,yes:true,no:false,"true":true,"false":false});var v={_x_project_name:true,_x_original_timestamp:true,_x_archived:true,_uuid:true,_version:true,_timestamp:true,_type:true,synergy_model:{clusters:[{_id:h,_type:f("cluster"),contact:false,location:false,name:true,serial_number:false,uuid:false,rdb_uuid:false}],hagroups:[{_id:h,_model:true,_type:f("hagroup"),_x_bom:{system:{_platformIndex:true,_configurationIndex:true,_version:true,_model:true,_family:true,_number:true,_config:true,_dedicated_root_aggregate:true,_spare_allocation_strategy:true,_messages:false},cards:[{count:true,card_model:true,description:true}],shelves:[{_id:false,_type:f("shelf"),_shelfIndex:true,_drive1Index:true,_drive2Index:true,count:true,model:true,_code:false,drive1count:true,drive1model:true,drive1rawgb:true,drive2count:true,drive2model:true,drive2rawgb:true,_description:true,_messages:false}]},_policies:{ADP:{prohibitedByUser:d(false)},Aggregates:{manual:d(false),ssdsForFlashPool:d(true)},storage_pools:{auto_fill:d(true)},version:{pin:d(true)},spare_allocation:{enforce:d(o.POLICIES.SPARES.DEFAULT)}},is_clustered:true,model:true,sys_version:true,cluster:{_id:h,_type:false,name:true},controllers:[{_id:true,_type:f("controller"),name:true,aggregates:[{_id:h,_strategy:false,_type:f("aggregate"),_manual:true,_controller:false,name:true,block_type:true,raid_type:true,cache_raid_type:true,is_hybrid:true,is_mirrored:true,is_root_aggregate:true,_snapreserve_proportion:true,_ddpreserve:true,_cache_storage_pool_id:p,_raid_groups:[{_id:h,_type:f("raidgroup"),name:true,_devices:c("string"),__deviceSpecs:false,cache:d(false),plex_number:true}]}],storage_pools:[{_id:h,_type:f("storage_pool"),name:true,type:d("ssd"),_manual:true,_controller:false,raid_type:true,_devices:c("string"),__deviceSpecs:false,_allocations:[{slice:u,used_blocks:true,devices:c("string"),__deviceSpecs:false,aggr_id:m}]}],_assigned_storage:[{slice_details:{slice:u,used_blocks:true,devices:c("string")}}]}],shelves:[{_id:h,_type:f("shelf"),_x_bom:{drive_specs:[{model:true,rawgb:true,rsgb:true,rpm:true,type:true,encrypted:true,fp_support:y,quantity:true}],drive_spec_members:c(c("string"))},_description:true,model:true,serial_number:true,bay_count:true,rack_units:false,type:true,_isembedded:true,channel_name:false,shelf_number:true,shelf_rack_number:false,shelf_rack_position:false}],version:true}]}};function _(e){i(e);return s(v,n(e),"clip")}t.exports=_},{"../constants":65,"../xform":124,"./repair":60,assert:127,uuid:183}],58:[function(e,t,r){"use strict";var i={"E-X4021A":true,"E-X4021B":true,"E-X4022A":true,"E-X4022B":true,"E-X4023A":true,"E-X4023B":true,"E-X4024A":true,"E-X4024B":true,"E-X4025A":true,"E-X4025B":true,"E-X4026A":true,"E-X4026B":true,"E-X4027A":true,"E-X4028A":false,"E-X4030A":false,"E-X4034A":false,"E-X4034B":false,"E-X4035A":false,"E-X4035B":false,"E-X4036A":false,"E-X4036B":false,"E-X4037B":false,"E-X4038A":false,"E-X4038B":false,"E-X4039A":true,"E-X4039B":true,"E-X4041B":false,"E-X4043B":false,"E-X4044B":false,"E-X4045A":true,"E-X4046A":false,"E-X4047A":true,"E-X4048A":false,"E-X4049B":true,"E-X4051B":false,"E-X4052B":true,"E-X4053B":false,"E-X4054B":true,"E-X4055B":false,"E-X4057A":false,"E-X4058A":true,"E-X4059A":false,"E-X4060A":false,"E-X4061A":true,"E-X4062A":false,X233A:false,X233B:false,X234A:false,X234B:false,X235A:false,X235B:false,X236A:false,X262A:false,X262B:false,X266A:false,X266B:false,X267A:false,X268A:false,X269A:false,X270A:false,X271A:false,X272A:false,X272B:false,X273A:false,X273B:false,X274A:false,X274B:false,X275A:false,X276A:false,X278A:false,X279A:false,X280B:false,X282B:false,X283B:false,X286A:false,X287A:false,X289A:false,X290A:false,X291A:false,X292A:false,X294A:false,X298A:false,X299A:false,X302A:false,X306A:false,X308A:false,X309A:true,X310A:false,X315A:true,X316A:false,X410A:false,X411A:false,X412A:false,X414A:true,X415A:true,X416A:true,X417A:true,X421A:false,X422A:false,X423A:false,X425A:false,X431A:false,X432A:false,X433A:false,X435A:false,X438A:false,X439A:false,X440A:true,X441A:false,X442A:false,X446A:false,X446B:false,X447A:false,X448A:false,X449A:false,X477A:false,X478A:false,X480A:false,X486A:false,X487A:false,X488A:false,X489A:false,X494A:true,X495A:true,X575A:false,X576A:false};t.exports=i},{}],59:[function(e,t,r){"use strict";var i={"E-X4021A":"no","E-X4021B":"no","E-X4022A":"no","E-X4022B":"no","E-X4023A":"no","E-X4023B":"no","E-X4024A":"no","E-X4024B":"no","E-X4025A":"no","E-X4025B":"no","E-X4026A":"no","E-X4026B":"no","E-X4027A":"no","E-X4028A":"no","E-X4030A":"no","E-X4034A":"no","E-X4034B":"no","E-X4035A":"no","E-X4035B":"no","E-X4036A":"no","E-X4036B":"no","E-X4037B":"no","E-X4038A":"no","E-X4038B":"no","E-X4039A":"no","E-X4039B":"no","E-X4041B":"no","E-X4043B":"no","E-X4044B":"no","E-X4045A":"no","E-X4046A":"no","E-X4047A":"no","E-X4048A":"no","E-X4049B":"no","E-X4051B":"no","E-X4052B":"yes","E-X4053B":"yes","E-X4054B":"yes","E-X4055B":"yes","E-X4057A":"no","E-X4058A":"no","E-X4059A":"no","E-X4060A":"no","E-X4061A":"no","E-X4062A":"no",X233A:"no",X233B:"no",X234A:"no",X234B:"no",X235A:"no",X235B:"no",X236A:"no",X262A:"no",X262B:"no",X266A:"no",X266B:"no",X267A:"no",X268A:"no",X269A:"no",X270A:"no",X271A:"no",X272A:"no",X272B:"no",X273A:"no",X273B:"no",X274A:"no",X274B:"no",X275A:"no",X276A:"no",X278A:"no",X279A:"no",X280B:"no",X282B:"no",X283B:"no",X286A:"no",X287A:"no",X289A:"no",X290A:"no",X291A:"no",X292A:"no",X294A:"no",X298A:"no",X299A:"no",X302A:"no",X306A:"no",X308A:"no",X309A:"no",X310A:"no",X315A:"no",X316A:"yes",X410A:"no",X411A:"no",X412A:"no",X414A:"no",X415A:"no",X416A:"no",X417A:"no",X421A:"no",X422A:"no",X423A:"no",X425A:"yes",X431A:"no",X432A:"no",X433A:"no",X435A:"no",X438A:"yes",X439A:"yes",X440A:"no",X441A:"yes",X442A:"no",X446A:"yes",X446B:"yes",X447A:"yes",X448A:"yes",X449A:"yes",X477A:"yes",X478A:"no",X480A:"no",X486A:"no",X487A:"no",X488A:"no",X489A:"yes",X494A:"no",X495A:"no",X575A:"yes",X576A:"yes"};t.exports=i},{}],60:[function(e,t,r){"use strict";var i=e("assert"),s=e("uuid"),n=e("./shelves"),a=e("../../constants"),o=window._;function l(e){i(e);if(!e.hagroups){return}i(!e.synergy_model,"clip has both hagroups AND synergy_model");e.synergy_model={hagroups:e.hagroups};delete e.hagroups}function c(e){if(typeof e.is_clustered==="string"){e.is_clustered=e.is_clustered==="true"}}function u(e){if(e._x_bom&&e._x_bom.system){c(e._x_bom.system);if(e.is_clustered===null||e.is_clustered===undefined){e.is_clustered=e._x_bom.system.is_clustered}}else{if(e.is_clustered===null||e.is_clustered===undefined){e.is_clustered=false}}c(e)}function p(e){if(e.is_clustered&&!o.has(e,"cluster")){e.cluster={_id:s()}}}function d(e,t,r,s){if(t in e){i.equal(e[t],r[s],s+" mismatch")}else{e[t]=r[s]}}function f(e){if(!(e.drives&&e._x_bom&&e._x_bom.shelves)){return}var t={};function r(e){var r=e.model;if(r&&!(r in t)){t[r]={rpm:e.rpm,type:e.type}}}function s(e){if(e.drive1model){var r=t[e.drive1model];d(e,"drive1rpm",r,"rpm");d(e,"drive1type",r,"type")}if(e.drive2model){var i=t[e.drive2model];d(e,"drive2rpm",i,"rpm");d(e,"drive2type",i,"type")}}i(e.drives instanceof Array);i(e._x_bom.shelves instanceof Array);o.forEach(e.drives,r);o.forEach(e._x_bom.shelves,s)}function h(e,t,r){if(o.has(e,t)){var s="renaming "+t+" to "+r;i.equal(o.hasOwnProperty(e,r),false,"clash "+s);e[r]=e[t];delete e[t]}}function m(e){if(!e.shelves){return}o.forEach(e.shelves,function t(e){h(e,"shelf_model","model");h(e,"serial_no","serial_number");delete e.shelf_type})}function g(e){if(!e.shelves){return}o.forEach(e.shelves,function t(e){e._type="shelf";var t=o.isEmpty(e._x_bom)?[]:e._x_bom.drive_specs;o.forEach(t,function r(e){h(e,"driveType","type");h(e,"marketingCapacity","rawgb");h(e,"rightSizedCapacity","rsgb");h(e,"speed","rpm")})})}function y(e){if(!e.drives){return}o.forEach(e.drives,function t(e){h(e,"disk_model","model");h(e,"disk_type","type")})}function v(e){e._type="controller";if(e.aggregates===null){delete e.aggregates}if(e.volumes===null){delete e.volumes}}function _(e){if(!e.controllers||!e._x_bom||!e._x_bom.system||!e._x_bom.system.names){return}var t=e._x_bom.system.names.split("/");o.forEach(e.controllers,function r(e,i){if(!e.name&&t[i]){e.name=t[i]}})}function E(e){if(e.version||!e._x_bom||!e._x_bom.system||!e._x_bom.system.version){return}e.version=e._x_bom.system.version}function b(e){if(typeof e.version!=="string"){return}var t=e.version.split(" ");t[0]=t[0].toUpperCase();e.version=t.join(" ")}function w(e){e._policies=e._policies||{};o.defaults(e._policies,{version:{pin:true},spare_allocation:{enforce:a.POLICIES.SPARES.DEFAULT}})}function S(e){e._type="hagroup";u(e);p(e);if(o.has(e,"system_model")){e.model=e.system_model;delete e.system_model}y(e);f(e);m(e);g(e);n.repairShelvesXboms(e);if(e.controllers){o.forEach(e.controllers,v)}_(e);E(e);b(e);w(e)}function A(e){e._type="cluster"}function C(e){e=o.cloneDeep(e);l(e);if(!(e.synergy_model&&e.synergy_model.hagroups)){return e}o.each(e.synergy_model.hagroups,S);o.each(e.synergy_model.clusters||[],A);return e}C.shelves=n;t.exports=C},{"../../constants":65,"./shelves":63,assert:127,uuid:183}],61:[function(e,t,r){"use strict";var i={"E-X4021A":7.2,"E-X4021B":7.2,"E-X4022A":7.2,"E-X4022B":7.2,"E-X4023A":7.2,"E-X4023B":7.2,"E-X4024A":7.2,"E-X4024B":7.2,"E-X4025A":10,"E-X4025B":10,"E-X4026A":10,"E-X4026B":10,"E-X4027A":15,"E-X4028A":50,"E-X4030A":50,"E-X4034A":7.2,"E-X4034B":7.2,"E-X4035A":7.2,"E-X4035B":7.2,"E-X4036A":10,"E-X4036B":10,"E-X4037B":7.2,"E-X4038A":10,"E-X4038B":10,"E-X4039A":10,"E-X4039B":10,"E-X4041B":50,"E-X4043B":50,"E-X4044B":7.2,"E-X4045A":7.2,"E-X4046A":7.2,"E-X4047A":7.2,"E-X4048A":7.2,"E-X4049B":10,"E-X4051B":10,"E-X4052B":10,"E-X4053B":10,"E-X4054B":10,"E-X4055B":10,"E-X4057A":50,"E-X4058A":50,"E-X4059A":50,"E-X4060A":50,"E-X4061A":50,"E-X4062A":50,X233A:10,X233B:10,X234A:10,X234B:10,X235A:10,X235B:10,X236A:10,X262A:7.2,X262B:7.2,X266A:5.4,X266B:7.2,X267A:7.2,X268A:7.2,X269A:7.2,X270A:10,X271A:15,X272A:10,X272B:10,X273A:15,X273B:15,X274A:10,X274B:10,X275A:15,X276A:10,X278A:15,X279A:15,X280B:7.2,X282B:7.2,X283B:7.2,X286A:15,X287A:15,X289A:15,X290A:15,X291A:15,X292A:15,X294A:7.2,X298A:7.2,X299A:7.2,X302A:7.2,X306A:7.2,X308A:7.2,X309A:7.2,X310A:7.2,X315A:7.2,X316A:7.2,X410A:15,X411A:15,X412A:15,X414A:15,X415A:15,X416A:10,X417A:10,X421A:10,X422A:10,X423A:10,X425A:10,X431A:7.2,X432A:7.2,X433A:7.2,X435A:50,X438A:50,X439A:50,X440A:50,X441A:50,X442A:50,X446A:50,X446B:50,X447A:50,X448A:50,X449A:50,X477A:7.2,X478A:7.2,X480A:7.2,X486A:10,X487A:10,X488A:10,X489A:10,X494A:10,X495A:10,X575A:50,X576A:50};t.exports=i},{}],62:[function(e,t,r){"use strict";var i={"E-X4021A":3000.016402432,"E-X4021B":3000.016402432,"E-X4022A":3000.016402432,"E-X4022B":3000.016402432,"E-X4023A":1999.8226718720002,"E-X4023B":1999.8226718720002,"E-X4024A":1999.8226718720002,"E-X4024B":1999.8226718720002,"E-X4025A":899.6088166400001,"E-X4025B":899.6088166400001,"E-X4026A":599.5505909760001,"E-X4026B":599.5505909760001,"E-X4027A":599.5505909760001,"E-X4028A":799.589766144,"E-X4030A":799.589766144,"E-X4034A":3000.016402432,"E-X4034B":3000.016402432,"E-X4035A":3000.016402432,"E-X4035B":3000.016402432,"E-X4036A":899.6088166400001,"E-X4036B":899.6088166400001,"E-X4037B":1999.8226718720002,"E-X4038A":899.6088166400001,"E-X4038B":899.6088166400001,"E-X4039A":899.6088166400001,"E-X4039B":899.6088166400001,"E-X4041B":799.6292055040001,"E-X4043B":799.6292055040001,"E-X4044B":1999.8226718720002,"E-X4045A":4007.2936077393924,"E-X4046A":4007.2936077393924,"E-X4047A":4007.2936077393924,"E-X4048A":4007.2936077393924,"E-X4049B":599.5505909760001,"E-X4051B":599.5505909760001,"E-X4052B":1199.7194076160001,"E-X4053B":1199.7194076160001,"E-X4054B":1199.7194076160001,"E-X4055B":1199.7194076160001,"E-X4057A":400.08801382400003,"E-X4058A":799.6292055040001,"E-X4059A":1600.3209205760002,"E-X4060A":400.08801382400003,"E-X4061A":799.6292055040001,"E-X4062A":1600.3209205760002,X233A:17.825792,X233B:17.825792,X234A:35.651584,X234B:35.651584,X235A:71.303168,X235B:71.303168,X236A:142.606336,X262A:221.64570112,X262B:221.64570112,X266A:287.7292544,X266B:287.7292544,X267A:443.66417100800004,X268A:666.428506112,X269A:888.7266181120001,X270A:35.651584,X271A:35.651584,X272A:71.303168,X272B:71.303168,X273A:71.303168,X273B:71.303168,X274A:142.606336,X274B:142.606336,X275A:142.606336,X276A:285.212672,X278A:142.606336,X279A:285.212672,X280B:221.64570112,X282B:443.66417100800004,X283B:666.428506112,X286A:142.606336,X287A:285.212672,X289A:438.304768,X290A:587.2025600000001,X291A:438.304768,X292A:587.2025600000001,X294A:1777.824956416,X298A:888.7266181120001,X299A:1777.824956416,X302A:888.7266181120001,X306A:1777.824956416,X308A:2661.858410496,X309A:2661.858410496,X310A:443.66417100800004,X315A:3992.7844700160003,X316A:5887.356829696,X410A:285.212672,X411A:438.304768,X412A:587.2025600000001,X414A:587.2025600000001,X415A:587.2025600000001,X416A:587.2025600000001,X417A:898.629632,X421A:438.304768,X422A:587.2025600000001,X423A:898.629632,X425A:1197.8428907520001,X431A:443.66417100800004,X432A:666.428506112,X433A:888.7266181120001,X435A:476.550529024,X438A:399.826223104,X439A:1600.0588185600002,X440A:799.9030558720001,X441A:99.767812096,X442A:88.68226662400001,X446A:199.787282432,X446B:199.787282432,X447A:799.9030558720001,X448A:199.787282432,X449A:799.9030558720001,X477A:3992.7844700160003,X478A:2947.7998428160004,X480A:3930.3973437440004,X486A:438.304768,X487A:587.2025600000001,X488A:898.629632,X489A:1197.8428907520001,X494A:587.2025600000001,X495A:898.629632,X575A:399.826223104,X576A:1600.0588185600002};t.exports=i},{}],63:[function(e,t,r){"use strict";var i=e("assert"),s=e("./encrypted-table"),n=e("./fp-table"),a=e("./rpm-table"),o=e("./rsgb-table"),l=e("uuid"),c=window._;function u(e){var t=e.split("with")[1].split("and");var r=c.map(t,function(e){var t=e.trim().split("x ");var r=t[1].trim().split(" ")[0];return{model:r,quantity:t[0]}});return r}function p(e){if(!e._x_bom&&e._description){var t=u(e._description);e._x_bom={drive_specs:t}}return e}function d(e){i(this instanceof d,"use new");var t=this;if(e._x_bom&&e._x_bom.shelves){c.forEach(e._x_bom.shelves,function r(e){if(e.drive1model){t[e.drive1model]=e.drive1rawgb}if(e.drive2model){t[e.drive2model]=e.drive2rawgb}})}}function f(e){if(c.isArray(e._x_bom)){e._x_bom={drive_specs:e._x_bom}}return e}function h(e){if(!e._id){e._id=l()}}function m(e){function t(e,t){var r=[],i=1;c.forEach(t,function(t){var s=[];c.forEach(c.range(t.quantity),function(){var t="!"+e.slice(0,8)+"."+i++;s.push(t)});r.push(s)});return r}if(e._x_bom&&(!e._x_bom.drive_spec_members||e._x_bom.drive_spec_members.length===0)){e._x_bom.drive_spec_members=t(e._id,e._x_bom.drive_specs)}}function g(e){function t(t){return c.find(e.shelves,{shelf_number:t})}var r=new d(e),i=false;c.forEach(e.drives,function(e){var s=t(e.shelf);if(!s){if(!i){i=true;console.error("WARNING: drive information lacks shelf number")}return}var n=e.model||e.disk_model,a=e.type||e.disk_type,o=e.rawgb||r[n]||0;if(!(s._x_bom&&s._x_bom.drive_specs)){s._x_bom={drive_specs:[],drive_spec_members:[]}}var l=c.find(s._x_bom.drive_specs,{model:n});if(l){l.quantity++}else{l={quantity:1,model:n};s._x_bom.drive_specs.push(l)}c.defaults(l,{type:a,rpm:e.rpm,rawgb:o})})}function y(e){c.forEach(e,function(e){var t=c.isEmpty(e._x_bom)?[]:e._x_bom.drive_specs;c.forEach(t,function(e){e.rpm=e.rpm||a[e.model];e.rsgb=e.rsgb||o[e.model];if(e.fp_support===undefined){e.fp_support=n[e.model]}if(e.encrypted===undefined){e.encrypted=s[e.model]}})})}function v(e){if(e.shelves){if(e.drives){g(e);c.forEach(e.shelves,h);c.forEach(e.shelves,m)}else{c.forEach(e.shelves,p);c.forEach(e.shelves,f);c.forEach(e.shelves,h);c.forEach(e.shelves,m)}y(e.shelves)}}t.exports={_parseShelfDescriptionToXbom:u,_fixShelvesMissingXbomFromShelfDescription:p,repairShelvesXboms:v,fixShelvesXbomsGivenDrives:g}},{"./encrypted-table":58,"./fp-table":59,"./rpm-table":61,"./rsgb-table":62,assert:127,uuid:183}],64:[function(e,t,r){"use strict";var i=e("./describe"),s=e("./distill"),n=e("./repair"),a=e("assert"),o=window._;function l(e){var t=[],r={synergy_model:{hagroups:t}};o.forEach(e,function i(e){t.push(e)});return r}function c(e){var t=l(e);return s(n(t))}function u(e){a(e instanceof Object);return c([e])}function p(e){a(e instanceof Array);return i(c(e))}function d(e){a(e instanceof Object);return p([e])}function f(e){a(typeof(e.rpm||e.driveSpeed)==="number",e);var t=e.rpm||e.driveSpeed;if(t>=50){return"SSD"}else if(t<9){return"capacity"}else{return"performance"}}function h(e){var t={count:{SSD:0,capacity:0,performance:0},rawtb:{SSD:0,capacity:0,performance:0}};o(e).flatten("shelves").flatten("_x_bom").flatten("drive_specs").forEach(function(e){if(e){var r=f(e);t.count[r]+=typeof e.quantity==="number"?e.quantity:parseInt(e.quantity);t.rawtb[r]+=e.rawgb/1e3}});return t}t.exports={describeSystems:p,describeSystem:d,distillSystem:u,classifyDrive:f,getDriveDescriptionsFromXboms:h}},{"./describe":54,"./distill":56,"./repair":60,assert:127}],65:[function(e,t,r){"use strict";t.exports={PROJECT_LIST_PATH:"/projects/list",PROJECT_LOAD_PATH:"/projects/load",PROJECT_ADJUST_PATH:"/projects/adjust",PROJECT_REPLACE_PATH:"/projects/replace",PROJECT_INFO_PATH:"/projects/info",CLIENT_LOG_PATH:"/log",PROJECT_INFO_CONCURRENCY:5,SERVER_READ_CONCURRENCY:5,SERVER_WRITE_CONCURRENCY:5,PLATFORM_OPTIONS_GET_PATH:"/platform/options",UNWANTED_METADATA:["_x_metrics","_x_gps_position","_x_localization","_x_statistics","_x_generator","_x_log"],CONFIG_GROUPS:{FAS:"FAS",FAS_CMODE_NORMAL:"c-mode",FAS_CMODE_MCC:"mcc",FAS_7MODE_NORMAL:"7-mode",FAS_7MODE_MC:"7mc",FAS_VSERIES:"V",E:"E",E_NORMAL:"e-series",EF_NORMAL:"ef-series"},LIMIT_TYPES:{ENABLED:"ENABLED",VERSION:"VERSION",NAS_NODES:"NAS_NODES",CAPACITY_GB:"CAPACITY_GB",EMBEDDED:"EMBEDDED",DRIVE_TOTAL:"DRIVE_TOTAL",DRIVE_SATA:"DRIVE_SATA",DRIVE_FC:"DRIVE_FC",DRIVE_SAS:"DRIVE_SAS",DRIVE_SSD:"DRIVE_SSD",EXT_SHELVES:"EXT_SHELVES",AGGR_MANUAL:"AGGR_MANUAL",AGGR_SIZE_64_TB:"AGGR_SIZE_64_TB",AGGR_MIN_FP_DRIVES:"AGGR_MIN_FP_DRIVES",CACHE_NO_FLASH:"CACHE_NO_FLASH",PRODUCTLINE:"PRODUCTLINE",HARDWARE_SHELF:"HARDWARE_SHELF",DRIVE_NSE:"DRIVE_NSE"},LIMIT_REASONS:{ENABLED:"Config limit reached.",VERSION:"Outside OS version range.",NAS_NODES:"Max NAS node limit reached.",CAPACITY_GB:"Max capacity reached.",EMBEDDED:"Embedded shelf.",DRIVE_TOTAL:"Max drive limit reached.",DRIVE_SATA:"Max SATA drive limit reached.",DRIVE_FC:"Max FC drive limit reached.",DRIVE_SAS:"Max SAS drive limit reached.",DRIVE_SSD:"Max SSD drive limit reached.",EXT_SHELVES:"Max external shelves limit reached.",AGGR_MANUAL:"Impacts devices used by a manual aggregate.",AGGR_SIZE_64_TB:"Manual aggregates would exceed the size limit.",AGGR_MIN_FP_DRIVES:"Manual flash pool does not have enough drives.",CACHE_NO_FLASH:"Manual flash pool would exceed the size limit.",PRODUCTLINE:"Only one product line per project.",HARDWARE_SHELF:"Existing shelf hardware not supported.",DRIVE_NSE:"Mixing encrypting and nonencrypting disks."},POLICIES:{SPARES:{DEFAULT:"Balanced",ALLOWED:["Minimum","Balanced","Maximum"]}}}},{}],66:[function(e,t,r){"use strict";var i=e("assert"),s=window._;function n(){i(this instanceof n);this._contents={};this._counts={}}n.prototype._makeStableClone=function(e){var t=s(e).keys().sort().value();return s.pick(e,t)};n.prototype.add=function(e,t){if(t===undefined){t=1}i(s.isPlainObject(e));i(s.isNumber(t));i(arguments.length<=2);i(!("_count"in e),"'_count' key is reserved");i(s.keys(e).length,"zero-size objects are pointless");var r=this._makeStableClone(e),n=JSON.stringify(r);if(n in this._counts){this._counts[n]+=t}else{this._counts[n]=t;this._contents[n]=r}};n.prototype.dump=function(){i(arguments.length===0);var e=[];for(var t in this._counts){var r=this._counts[t],s=this._contents[t];s._count=r;e.push(s)}return e};t.exports=n},{assert:127}],67:[function(e,t,r){"use strict";var i=e("assert"),s=window._;function n(e){var t={};function r(e){if(s.has(t,e)){return t[e]}else{var r=t[e]=[];return r}}function n(t,s,n){i.equal(arguments.length,3,"debounced: expected 3 arguments");i.equal(typeof n,"function");i.equal(typeof t,"string");var a=r(t);function o(){a[0][1].apply(this,arguments);a.shift();if(a[0]){var t=a[0][0];e(t,o)}}if(a.length){if(a.length>1){var l=a.pop();l[1].apply(this,[new Error("Skipped")])}}else{e(s,o)}a.push([s,n])}return n}t.exports=n},{assert:127}],68:[function(e,t,r){"use strict";var i=e("assert"),s=e("events"),n=e("util"),a=window._;var o="change";
function l(e,t){i(this instanceof l,"use new");i(e instanceof Array,"invalid stores");i.equal(typeof t,"function","log function");this._stores=e;this.log=t;s.EventEmitter(this);var r=this;this._stores.forEach(function n(e){e.watch(function t(){r.emit(o,e)})})}n.inherits(l,s.EventEmitter);l.prototype.act=function(){var e=false,t=arguments,r=a.toArray(arguments),i=r.shift().toLowerCase();this.emit("dispatch",{action:i,args:r});this.log(["dispatch",i],{action:i,args:r});this._stores.forEach(function s(r){var i=r.act.apply(r,t);e=e||i});if(!e){this.log.error("no store handled event:",t[0])}this.emit("dispatched",{action:i,args:r,handled:e})};l.prototype.watch=function c(e){this.on(o,e)};l.prototype.unwatch=function u(e){this.removeListener(o,e)};t.exports=l},{assert:127,events:128,util:132}],69:[function(e,t,r){(function(r){"use strict";var i=e("util"),s=window._;function n(e){var t=s.toArray(arguments);switch(t.length){case 0:return;case 1:t=t[0];break;default:break}var n=(new Error).stack.split("\n")[2].replace(/^[ ]+/,"--- ")+"\n";try{console.error(n+i.inspect(t,{depth:null,colors:r.stderr.isTTY,customInspect:false}))}catch(a){console.error(n,t)}return e}t.exports=n}).call(this,e("_process"))},{_process:130,util:132}],70:[function(e,t,r){"use strict";var i=window._,s=e("assert");var n=0,a=1,o=2;function l(e,t){s(i.isPlainObject(t),"bad object");s(i.isPlainObject(e),"bad spec");var r=i.omit(t,i.keys(e)),l={};s(i.keys(r).length===0,"bad key(s): "+i.keys(r).join(", "));i.forEach(e,c);return l;function c(e,r){if(typeof e==="string"||typeof e==="function"){e=[e]}s(i.isArray(e),"bad spec for "+r+": "+e);s(e.length>=1&&e.length<=3,"bad spec length for "+r);var c;if(i.has(t,r)){c=t[r]}else{s(i.has(e,a),"no default for "+r);c=e[a]}if(i.has(e,n)){if(typeof e[n]==="function"){s(c instanceof e[n],"bad class for "+r)}else{s.equal(typeof e[n],"string","bad spec type for "+r);s.equal(typeof c,e[n],"invalid type for "+r)}}if(i.has(e,o)){l[r]=e[o](c)}else{l[r]=c}}}t.exports=l},{assert:127}],71:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n={branch:"develop",revision:"f0ddda9b12d8",dirty:"unknown",datetime:"Tue, 17 Mar 2015 02:26:01 GMT"};var a={FEATURE_FP_MANUAL_ENABLED:n.branch==="develop"};t.exports=i.mapValues(a,function o(e,t){s(t.match(/^FEATURE_[A-Z0-9_]+_ENABLED$/),"bad toggle name");return!!e});if(Object.freeze){Object.freeze(t.exports)}},{assert:127}],72:[function(e,t,r){"use strict";function i(e,t,r,i){var s=false,n,a;function o(){if(s){if(a){throw a}else{return n}}else{s=true;try{n=r.call(e);return n}catch(t){a=t;throw a}}}Object.defineProperty(e,t,{get:o,enumerable:i===undefined?true:i})}t.exports=i},{}],73:[function(e,t,r){(function(r){"use strict";var i=e("assert"),s=window._;function n(e,t){i(typeof e==="function");t=this.options=s.clone(t||{});var r=t.console=t.console||a();this.log=function n(a,o){i.equal(arguments.length,2,"log: 2-arity");e.call(t.bind,a,o);var l=a.join(", ");if(s.contains(a,"error")||o.err||o instanceof Error){r.error(l,o)}else if(s.contains(a,"warn")){r.warn(l,o)}else{r.debug(l,o)}};s.forEach(["info","debug","warn","error"],this._addLevelHandler,this)}n.prototype._addLevelHandler=function o(e){var t=false,r=this.options.console;this[e]=this.log[e]=s;return;function i(){if(!t){r.warn("log."+e+" provides local logging ONLY");t=true}}function s(){i();r[e].apply(r,arguments)}};function a(){if(r&&!s.isEmpty(r.console)){return r.console}else if(window&&!s.isEmpty(window.console)){return window.console}else{return{debug:s.noop,info:s.noop,warn:s.noop,error:s.noop}}}t.exports=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{assert:127}],74:[function(e,t,r){"use strict";var i={AGGR_32_BIT:"32_bit",AGGR_64_BIT:"64_bit",VOL_GROUP:"Volume_Group"};t.exports=i},{}],75:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("./raid-limits"),a=e("./raid-types"),o=e("../../units"),l=e("./aggregate-types"),c=e("./aggregateReporter");function u(e){i(e,"Must provide a hagroup inspector to find limits");this._hagi=e;this._limits=e.limits;this._raidTypes=new a;this._raidLimits=new n}u.prototype.maxDataDevices=function p(e,t,r,i,s){var n=s?s:this._determineEstimatedRaidSize(e,t,i),a=this._aggrLimitTBUnit(r);return this._deviceLimit(e,t,a,r,i,n)};u.prototype.maxCacheDevices=function d(e,t,r,i,s){var n=s?s:this._determineEstimatedRaidSize(e,t,i),a=this._aggrCacheLimitTBUnit();return this._deviceLimit(e,t,a,r,i,n)};u.prototype._deviceLimit=function f(e,t,r,i,s,n){if(s===this._raidTypes.RAID_5||s===this._raidTypes.RAID_6){return Math.min(t,30)}if(s===this._raidTypes.DDP){return t}var a=this._numberOfEstimatedDataDrivesPerRg(s,n),o=Math.floor(t/n)+1,l=this._aggrLimitTBUnit(i);if(r){var c=this._estimatedCapacityFASPerRaidGroupInGB(e,a),u=Math.min(Math.floor(l.value_gb/c),o);return Math.min(t,u*n)}else{return t}};u.prototype._determineEstimatedRaidSize=function h(e,t,r){return this._hagi.lookup.lowestOverheadRaidSize(e,r,t)};u.prototype._aggrLimitTBUnit=function m(e){var t=this._limits,r=e===l.AGGR_32_BIT?t.aggr.size_32_tb:t.aggr.size_64_tb;return new o(r,"TB")};u.prototype._aggrCacheLimitTBUnit=function g(){var e=this._currentSystemCacheCapacity(),t=new o(this._limits.cache_with_flash,"TB"),r=t.subtract(e).value;console.log("platform capacity: ",t.value);console.log("current capacity: ",e.value);console.log("delta: ",r);if(r<0){r=0}return new o(r,"TB")};u.prototype._currentSystemCacheCapacity=function y(){var e=new c(this._hagi),t=this._hagi.versionNumber,r=s.map(this._hagi.hagroup,"controllers"),i=s.map(r,"aggregates"),n=s.map(i,l),a=s.reduce(n,function(e,t){return e+t})||0;return new o(a,"GB").to("TB");function l(r){var i=e.createAggregateReport(r,t);return i.cacheCapacity}};u.prototype._numberOfEstimatedDataDrivesPerRg=function v(e,t){return this._raidTypes.driveRolesForRaidType(e,t).data};u.prototype._estimatedCapacityFASPerRaidGroupInGB=function _(e,t){var r=.9,i=new o(20.5,"MiB"),s=new o(e.rsgb,"GB"),n=new o(s.subtract(i).value_gb*r);return n.value_gb*t};t.exports=u},{"../../units":123,"./aggregate-types":74,"./aggregateReporter":76,"./raid-limits":85,"./raid-types":86,assert:127}],76:[function(e,t,r){"use strict";var i=window._,s=e("util"),n=e("assert"),a=e("../../units"),o=e("./raid-types");function l(e){n(e,"Must provide the hagroup inspector which owns the aggregates to report on.");this.hagi=e;this.aggregates={}}l.prototype.createAggregateReport=function c(e,t){n(e,"Cannot create a report without an aggregate");this._addAggregateForComputing(e);var r=e._id,i=this._buildSummary(r,t),s=this._packageAggregateReport(r,i);this._removeAggregateBecauseDone(r);return s};l.prototype._addAggregateForComputing=function(e){this.aggregates[e._id]=e};l.prototype._removeAggregateBecauseDone=function(e){delete this.aggregates[e]};l.prototype._packageAggregateReport=function u(e,t){return{aggregateId:e,summary:t}};l.prototype._buildSummary=function p(e,t){var r=this,s=this.aggregates[e],n={isRootAggregate:s.is_root_aggregate,containsVirtualDevices:false,rootCapacity:0,usableCapacity:0,cacheCapacity:0,snapReserveCapacity:0,totalCapacity:0,driveRoleSummary:{total:0,data:0,parity:0,dparity:0,reserve:0,cache:0,cacheData:0,physical:{total:0,data:0,parity:0,dparity:0,reserve:0,cache:0},virtual:{total:0,data:0,parity:0,dparity:0,reserve:0,cache:0}},usableCapacityByType:{},driveSpecSummary:{}};i.forEach(s._raid_groups,function(i){if(i.__deviceSpecs){r._addRaidGroupSummaryToAggregateCapacitySummary(n,e,i,t)}else{console.warn("Cannot compute capacity for raid group for aggrId "+e+", missing __deviceSpecs")}});return n};l.prototype._addRaidGroupSummaryToAggregateCapacitySummary=function d(e,t,r,s){var n=this,a=new o,l=n._raidTypeFor(t,r),c=r._devices.length,u=this.hagi.isESeries?n.aggregates[t]._ddpreserve:0,p=this._handleDDPReserveDrivesIfNecessary(a.driveRolesForRaidType(l,c),l,u),d=this._lowestCommonDenominatorDriveSpecForRaidGroup(r),f=this.hagi.isESeries?0:n.aggregates[t]._snapreserve_proportion,h=n._getRaidGroupYield(t,d,l,p,r.cache,s),m=n._getUsableCapacityFromDeviceSpec(h,f),g=!!d.spec.slice;if(r.cache){if(g){e.driveRoleSummary.virtual.cache+=r._devices.length}else{e.driveRoleSummary.physical.cache+=r._devices.length}e.driveRoleSummary.cacheData+=p.data;e.cacheCapacity+=m}else{e.driveRoleSummary.data+=p.data;e.driveRoleSummary.parity+=p.parity;e.driveRoleSummary.dparity+=p.dparity;if(g){e.driveRoleSummary.virtual.data+=p.data;e.driveRoleSummary.virtual.parity+=p.parity;e.driveRoleSummary.virtual.dparity+=p.dparity}else{e.driveRoleSummary.physical.data+=p.data;e.driveRoleSummary.physical.parity+=p.parity;e.driveRoleSummary.physical.dparity+=p.dparity}e.snapReserveCapacity+=f*h;if(e.isRootAggregate){e.rootCapacity+=m}else{e.usableCapacity+=m}if(!r.cache){var y=d.spec.type;if(i.has(e.usableCapacityByType,y)){e.usableCapacityByType[y]+=m}else{e.usableCapacityByType[y]=m}}}e.driveRoleSummary.reserve+=p.reserve;e.driveRoleSummary.total+=r._devices.length;if(g){e.driveRoleSummary.virtual.reserve+=p.reserve;e.driveRoleSummary.virtual.total+=r._devices.length}else{e.driveRoleSummary.physical.reserve+=p.reserve;e.driveRoleSummary.physical.total+=r._devices.length}e.totalCapacity+=h;var v=this._isPartitionPresentInRaidGroup(r,"P1"),_=this._isPartitionPresentInRaidGroup(r,"P2"),E=null;if(_||v){E=_?"root":"data"}i.forEach(r.__deviceSpecs,function(t){var r=!!t.spec.slice;e.containsVirtualDevices=e.containsVirtualDevices||r;if(!i.has(e.driveSpecSummary,t.spec.rsgb)){if(t.spec._for_storage_pool){E="cache"}e.driveSpecSummary[t.spec.rsgb]={isVirtual:r,virtualPartitionType:E,rawgb:t.spec.rawgb,rsgb:t.spec.rsgb,type:t.spec.type,rpm:t.spec.rpm,count:t.count}}else{e.driveSpecSummary[t.spec.rsgb].count+=t.count}})};l.prototype._findStoragesPoolWithAggregateId=function f(e){var t=this.hagi.storagePools(),r=i.map(t,function(e){return{id:e._id,aggrIds:i.without(i.map(e._allocations,function(e){return e.aggr_id}),undefined)}}),s=i.where(r,function(t){return i.contains(t.aggrIds,e)});if(s&&s.length>0){var n=i.first(s);var a=i.where(t,{_id:n.id});return a}else{return[]}};l.prototype._handleDDPReserveDrivesIfNecessary=function h(e,t,r){var i=new o;if(this.hagi.isESeries){switch(t){case i.DDP:var s=e.data,n=r===undefined?i._getDdpReserveRecommendation(s):r;e.data-=n;e.reserve=n;break}}return e};l.prototype._isPartitionPresentInRaidGroup=function(e,t){return i.any(e._devices,function(e){return i.contains(e,t)})};l.prototype._lowestCommonDenominatorDriveSpecForRaidGroup=function(e){var t=i.sortBy(e.__deviceSpecs,function(t){if(!t.spec){console.error("bad __deviceSpecs in raid group",e)}return t.spec.rsgb});return i.first(t)};l.prototype._raidTypeFor=function m(e,t){var r=this,i=r.aggregates[e];return t.cache?i.cache_raid_type:i.raid_type};l.prototype._getRawCapacityFromDeviceSpec=function g(e,t){var r=this,i=new a(e.spec.rawgb,"GB"),s=i.mult(t.data+t.parity+t.dparity);return s.value_gb};l.prototype._getRaidGroupYield=function y(e,t,r,i,s,n){var a=this,o=a.aggregates[e],l=a._determinePerDataDiskYield(t,s),c=o.is_mirrored?2:1,u=o._snapreserve_proportion,p=this.hagi.isESeries?this._getESeriesVolumeGroupYield(t,r,i,n):l.mult(i.data).to("GiB").value/c;return p};l.prototype._getESeriesVolumeGroupYield=function v(e,t,r,i){var s=new o;if(t!==s.DDP){var n=this._perDiskYieldESeries(e,i);var l=n.mult(r.data).to("GiB").value;return s.isMirrored(t)?l/2:l}var c=this._perDiskYieldESeries(e,i),u=r.data+r.reserve,p=r.reserve;var d=10,f=5e5,h=1048576,m=new a(8388608,"KiB"),g=Math.floor(c.value*1024*1024*1024/512),y=g-h*5,v=y/h;var _=this._getESeriesDriveCountErrorCode(u),E=this._getESeriesDDPDiskErrorCode(v),b=this._getESeriesPercentError(_,E);var w=Math.min(u*v/d,f);var S=Math.min(u*v/d*((100-b)/100),f),A=Math.floor(S);var C=Math.floor(p*A/u),T=A-C,R=m.mult(T);var P=new a(Math.round(R.value/2/1024/1024),"GiB");return P.value};l.prototype._getESeriesPercentError=function _(e,t){var r=s.format("%s-%s",e,t);switch(r){case"11-268":case"11-553":return 4;case"11-833":case"11-926":case"11-1112":return 3.5;case"11-1671":case"11-1858":case"11-3721":case"11-5584":case"37-268":return 2;case"37-553":return 2;case"11-7447":case"37-833":case"37-926":case"37-1112":return 1.5;case"37-1671":case"37-1858":case"37-3721":case"37-5584":return 1;case"37-7447":return.5}return 0};l.prototype._getESeriesDriveCountErrorCode=function E(e){if(e>10&&e<36){return 11}else if(e>36&&e<64){return 37}else if(e>63&&e<66){return 65}return 0};l.prototype._getESeriesDDPDiskErrorCode=function b(e){if(e>267&&e<553){return 268}else if(e>552&&e<833){return 553}else if(e>882&&e<927){return 883}else if(e>925&&e<1111){return 926}else if(e>926&&e<1672){return 1671}else if(e>1671&&e<1859){return 1858}else if(e>1858&&e<3722){return 3721}else if(e>3721&&e<5585){return 5584}else if(e>5584&&e<7448){return 7447}return 0};l.prototype._getUsableCapacityFromDeviceSpec=function w(e,t){var r=e*(1-t);return r};l.prototype._determinePerDataDiskYield=function S(e,t){if(!this.hagi.isESeries){return this._perDiskYieldFAS(e,t)}};l.prototype._perDiskYieldFAS=function A(e,t){var r=t?1:.9,i=new a(20.5,"MiB"),s=new a(e.rsgb||e.spec.rsgb,"GB");return new a(s.subtract(i).value_gb*r)};l.prototype._perDiskYieldESeries=function C(e,t){var r=t?t:this.hagi.versionNumber;return this._capacityAfterDACOverheadsESeries(e,r)};l.prototype._capacityAfterDACOverheadsESeries=function T(e,t){var r=t.indexOf("8.2")===0,i=r?new a(5,"GiB"):new a(.5,"GiB"),s=new a(e.spec.rsgb,"GB");return s.subtract(i).to("GiB")};l.prototype._nullToZero=function(e){if(e===undefined||e===null){return 0}else{return e}};t.exports=l},{"../../units":123,"./raid-types":86,assert:127,util:132}],77:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("uuid"),a=e("../../dump"),o=e("../util");a();function l(e){this._hagi=e;this._specById=this._get_specById()}l.prototype.makeAggregate=function c(e,t,r,a){i(this instanceof l);i.equal(typeof e,"string");i.equal(typeof t,"object");i.equal(typeof r,"number");i(!a||s.isPlainObject(a));i(r<=t.devices.length);var o=this._hagi.lookup.defaultAggrProps(r);var c=s.merge({},o,{_manual:false,_controller:e,name:"aggr"+n().slice(0,8)},a||{});if(!c._raid_groups){c._raid_groups=this.makeRaidGroups(t,r,c)||[]}return c};l.prototype.makeRaidGroups=function u(e,t,r,a){i(this instanceof l);i(s.isPlainObject(e));i(s.isNumber(t));i(s.isPlainObject(r));i(t<=e.devices.length);var o=a?a:this._defaultRaidSize(e,t,r.raid_type),c=Math.ceil(t/o),u=c*o-t,p=0,d=[],f=e.devices,h,m,g;while(u>c){o-=1;u-=c}while(p<t){var y=d.length>=u?o:o-1,v=s.min([y,t-p]),_=f.splice(0,v);h={_id:n(),_type:"raidgroup",name:"rg"+d.length,_devices:[],__deviceSpecs:[],cache:false,plex_number:0};m=null;g=null;s.forEach(_,E,this);d.push(h);p+=h._devices.length}return d;function E(e){i(this instanceof l);h._devices.push(e);var t=this._specById[e];if(t===m||s.isEqual(t,m)){g.count++}else{m=t;g={spec:t,count:1};h.__deviceSpecs.push(g)}}};l.prototype._defaultRaidSize=function p(e,t,r){var i=s.merge({},e.spec,{type:o.rpmToEffectiveDriveType(e.spec.rpm),_type_faked:true}),n=this._hagi.lookup.lowestOverheadRaidSize(i,r,t);return n};l.prototype._get_specById=function d(){i(this instanceof l);var e={};s.forEach(this._hagi.deviceInfo,function(t){e[t.id]=t.spec});return e};t.exports=l},{"../../dump":69,"../util":104,assert:127,uuid:183}],78:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("uuid"),a=e("util"),o=e("./component-builder"),l=e("./raid-types");function c(e,t,r){s(e,"Must provide a hagroup inspector");this._hagi=e;this._raidTypes=new l;this.name="manual";this._requestedRaidSize=r;this._componentBuilder=new o(this._hagi);this.aggregate=t||this._makeAggregateBoilerplate();this._setRaidSizeIfMissing()}c.prototype.bestPracticeRaidSize=function u(e,t,r){return this._hagi.lookup.lowestOverheadRaidSize(e,t,r)};c.prototype.bestPracticeDDPReserve=function p(e){return this._hagi.lookup.reserveRecommendationForDDP(e)};c.prototype.setRaidType=function d(e,t){s(i.contains(this.availableRaidTypes(),e),"Cannot assign raid type, it is not available on system");if(t){this.aggregate.cache_raid_type=e}else{this.aggregate.raid_type=e}this._respondToMutation()};c.prototype.setBlockType=function f(e){s(i.contains(this.availableBlockTypes(),e),"Cannot assign aggregate block type, it is not available on this system");this.aggregate.block_type=e;this._respondToMutation()};c.prototype.setDeviceAndCount=function h(e,t){s(!this._isDeviceGroup(e),"You should not be passing a device group in, only spec and count");if(!this._requestedRaidSize){this._requestedRaidSize=this.bestPracticeRaidSize(e,this.aggregate.raid_type,t)}var r=this._deviceGroupForSpec(e);s(r.devices.length>=t,"Attempted to set spec with insufficient number of devices");this._rebuildRaidGroups(false,r,t)};c.prototype.setRaidSize=function m(e){this._requestedRaidSize=e;this._respondToMutation()};c.prototype.setDDPReserve=function g(e){this.aggregate._ddpreserve=e;this._respondToMutation()};c.prototype.setController=function y(e){this.aggregate._controller=e._id};c.prototype.setName=function v(e){this.aggregate.name=e};c.prototype.setSnapReserve=function _(e){this.aggregate._snapreserve_proportion=e};c.prototype.availableDeviceGroupsForAggregate=function E(){return this._availableAggrDeviceGroups()};c.prototype.deviceSummary=function b(){var e=this._currentAggrDeviceGroups(false),t=this._currentAggrDeviceGroups(true),r=a(e),s=a(t),n={data:r,cache:s};function a(e){if(!e||e.length===0){return{spec:null,count:0}}var t=i.first(e);return{spec:t.spec,count:t.devices.length}}return n};c.prototype.availableRaidTypes=function w(){return this._hagi.lookup.possibleRaidTypes};c.prototype.availableBlockTypes=function S(){return this._hagi.lookup.possibleAggrTypes};c.prototype.availableControllers=function A(){return this._hagi.controllers};c.prototype.containerLanguage=function C(){return this._hagi.isESeries?"Volume Group":"Aggregate"};c.prototype.systemLimits=function T(){return this._hagi.limits};c.prototype.currentRaidSize=function R(){return this._actualRaidSize()};c.prototype.requestedRaidSize=function P(){return this._requestedRaidSize};c.prototype.deviceLimits=function N(e){var t=this._activeDeviceForAggregate(e),r=this._hagi.lookup,i={spec:{},min:0,max:0};if(t){var s=this._currentRaidType(e),n=this.aggregate.block_type,a=t.spec,o=this._deviceGroupForSpec(a).devices.length,l=this._absoluteMinRaidSize(s),c=r.maxAggrDataDeviceCount(a,o,n,s);i.spec=a;i.min=l;i.max=c}return i};c.prototype.raidSizeLimits=function D(e){var t=this._activeDeviceForAggregate(e),r={spec:{},min:0,max:0};if(t){var i=this._hagi.lookup,s=this._currentRaidType(e),n=t.spec,a=this._deviceGroupForSpec(n).devices.length,o=i.raidLimits(n,s),l=this._absoluteMinRaidSize(s);r.spec=n;r.min=l;r.max=Math.min(a,o.maximumSize)}return r};c.prototype._setRaidSizeIfMissing=function x(){if(this.aggregate&&!this._requestedRaidSize){if(this.aggregate._raid_groups){this._requestedRaidSize=this._actualRaidSize()}}};c.prototype._actualRaidSize=function k(){if(this.aggregate&&this.aggregate._raid_groups){return i.max(i.map(this.aggregate._raid_groups,e))}function e(e){return e._devices.length}};c.prototype._currentRaidType=function O(e){return e?this.aggregate.cache_raid_type:this.aggregate.raid_type};c.prototype._activeDeviceForAggregate=function I(e){var t=this._currentAggrDeviceGroups(e),r=null;if(t&&t.length>0){var s=i.sortBy(t,n);r=i.first(s)}function n(e){return e.spec.rsgb}return r};c.prototype._transform=function M(e){return this._hagi.transformDriveInfoSequence(e)};c.prototype._availableAggrDeviceGroups=function F(){var e=this._unusedAggrDevices(),t=this._currentAggrDevices();return this._transform(e.concat(t))};c.prototype._currentAggrDeviceGroups=function q(e){return this._transform(this._currentAggrDevices(e))};c.prototype._unusedAggrDevices=function L(){return this._hagi.latestDeviceInfo().where.unlocked.and.notroot};c.prototype._currentAggrDevices=function j(e){var t=this,r=this._hagi.latestDeviceInfo(),s=i.where(r,n);return this._filterCacheDevices(s,e);function n(e){return i.any(e.consumers,r);function r(e){return t.aggregate&&e._id===t.aggregate._id}}};c.prototype._filterCacheDevices=function B(e,t){var r={},s=this;a();t=!!t;return i.where(e,n);function n(e){return i.has(r,e.id)&&r[e.id]===t}function a(){if(!s.aggregate){return}i.forEach(s.aggregate._raid_groups,e);function e(e){i.forEach(e._devices,t);function t(t){r[t]=e.cache}}}};c.prototype._absoluteMinRaidSize=function X(e){return this._raidTypes.minRaidSize(e)};c.prototype._makeAggregateBoilerplate=function G(){var e=this._hagi.lookup,t=e.defaultAggrProps();var r=i.merge({},t,{_strategy:this.name,_manual:true,_controller:this._defaultController()._id,name:this._defaultName()});r._raid_groups=this._makeDefaultRaidGroups(r);return r._raid_groups.length?r:null};c.prototype._makeDefaultRaidGroups=function U(e){var t=this,r=this._defaultRaidGroupDeviceGroup();if(!r){return[]}var s=u(r);if(!s){return[]}e.raid_type=s;var n=this._hagi.lookup,a=e.block_type,o=r.spec,l=r.devices.length,c=n.maxAggrDataDeviceCount(o,l,a,s);if(c<this._absoluteMinRaidSize(s)){return[]}this._requestedRaidSize=this.bestPracticeRaidSize(o,s,c);return this._componentBuilder.makeRaidGroups(r,c,e,this._requestedRaidSize);function u(e){var r=t._hagi,s=r.isESeries?t._raidTypes.DDP:t._raidTypes.RAID_DP,n=i(r.lookup.possibleRaidTypes).where(a).sortBy(o).value();function a(r){return e.devices.length>=t._absoluteMinRaidSize(r)}function o(e){return e===s?0:1}return i.first(n)}};c.prototype._defaultRaidGroupDeviceGroup=function V(){var e=this,t=this.availableDeviceGroupsForAggregate();function r(e){return e.devices.length}function s(){if(!e._hagi.isESeries){}return true}if(t){var n=i(t).where(s).sortBy(r).reverse().value();return n.length?i.first(n):null}return null};c.prototype._defaultController=function H(){var e=this._hagi.controllers;s(e,"hagroup is missing controllers");return i.first(e)};c.prototype._defaultName=function Y(){var e=this.containerLanguage();return a.format("%s_%s",e,n().slice(0,8))};c.prototype._deviceGroupForSpec=function z(e){var t=this.availableDeviceGroupsForAggregate();if(!t||t.length===0){return false}var r=i(t).filter().where(s).value();return r&&r.length>0?i.first(r):null;function s(t){return i.isEqual(t.spec,e)}};c.prototype._respondToMutation=function W(){this._rebuildRaidGroups()};c.prototype._rebuildRaidGroups=function J(e,t,r){e=!!e;if(t){if(!(t instanceof Array)){t=[t]}}var s=this,n=t||this._currentAggrDeviceGroups(e),a=i.where(this.aggregate._raid_groups,c),o=i.flatten(i.map(n,l));if(a.length){o.push.apply(o,a)}function l(e){var t=r||e.devices.length;return s._componentBuilder.makeRaidGroups(e,t,s.aggregate,s._requestedRaidSize)}function c(e){return e.cache}this.aggregate._raid_groups=o};c.prototype._isDeviceGroup=function Q(e){var t=i.isPlainObject(e),r=i.has(e,"spec"),s=i.has(e,"devices"),n=r&&i.isPlainObject(e.spec),a=s&&e.devices instanceof Array;return t&&n&&a};t.exports=c},{"./component-builder":77,"./raid-types":86,assert:127,util:132,uuid:183}],79:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("../../dump"),a=e("./plans/propose-root-sliced"),o=e("./plans/propose-root-unsliced"),l=e("./plans/propose-data"),c=e("./plans/propose-ddp"),u=e("./aggregateReporter"),p=e("../util");n();var d=[a,o,l,c];function f(e){i(this instanceof f);i(e);this.hagi=e;this.proposers=s.clone(d)}f.prototype.bestPlan=function E(){i(this instanceof f);var e=this.hagi;var t=v(e),r=e.aggregates.where.manual,n=this.makeAttempts(t,r),a=s.sortBy(n,this.scoreAttempt,this),o=s.last(a),l=o?o.slice(r.length):[];return l};f.prototype.scoreAttempt=function b(e){i(this instanceof f);var t=s.groupBy(e,"_controller"),r=s.mapValues(t,this._estimateAggrsDataYield,this),n=s.values(r),a=1-.02*e.length;return h(n)*a};f.prototype._estimateAggrsDataYield=function w(e){return h(s.map(e,this._estimateAggrDataYield,this))};f.prototype._estimateAggrDataYield=function S(e){i(this instanceof f);var t=new u(this.hagi).createAggregateReport(e).summary,r=t.usableCapacity,s=this.hagi.limits.aggr.root_aggr_size_mib,n=s/1024;if(e.is_root_aggregate){var a=e._raid_groups[0].__deviceSpecs[0].spec,o=this.hagi.lookup.minimalRootAggregateDriveCount(a,e.raid_type),l=e._raid_groups.length===1&&e._raid_groups[0].__deviceSpecs.length===1&&e._raid_groups[0]._devices.length===o;if(l||this.hagi.configGroup.id==="c-mode"){return 0}else if(r>0){console.error("TODO: remove non-dedicated root compensation code");return r}else{i(t.rootCapacity>0);return t.rootCapacity-n}}else{return r}};f.prototype.makeProposers=function A(e,t){i(this instanceof f);i(s.isArray(e));i(s.isArray(t));e=s.clone(e);t=s.clone(t);return s.map(d,r,this);function r(r){i(this instanceof f);return new r(this.hagi,e,t)}};f.prototype.makeAttempts=function C(e,t,r){i(this instanceof f);t=t||[];r=r||0;i(e instanceof Array);i(t instanceof Array);i.equal(typeof r,"number");i(s.all(t,s.isPlainObject));if(!e.length){return[t]}var n=s(this.makeProposers(e,t)).map(l,this).filter().value();i(s.all(n,s.isPlainObject));var a=[];s.forEach(n,function p(e){switch(e.mode){case"all":return a.push(e.aggregates);case"any":return s.forEach(e.aggregates,function(e){a.push([e])});default:throw new Error("fan out mode")}});i(s.all(a,s.isArray));var o=[];s.forEach(a,function(e){i(this instanceof f);i(e instanceof Array);i(e.length>0);i(s.all(e,s.isPlainObject));var t=s.bind(u,this)(e);s.forEach(t,function(e){i(e instanceof Array);i(s.all(e,s.isPlainObject));o.push(e)})},this);return o;function l(r){i(this instanceof f);i.equal(typeof r.propose,"function");var s=r.propose.call(r,e,t);c(s);if(s){if(s.aggregates.length===0){return null}}return s}function c(e){if(e){i(s.isPlainObject(e));i(e.mode==="any"||e.mode==="all");i(e.aggregates instanceof Array);if(e.aggregates.length>0){i(s.all(e.aggregates,s.isPlainObject))}}}function u(s){i(this instanceof f);var n=m(e,s),a=t.concat(s),o=this.makeAttempts(n,a,r+1);if(o.length){return o}else{return[a]}}};function h(e){return s.reduce(e,function t(e,r){return e+r})}function m(e,t){i(e instanceof Array);i(t instanceof Array);var r=s(t).map("_raid_groups").flatten().map("_devices").flatten().value(),n=s.partial(s.has,s.zipObject(r)),a=y(e,g(n));return a}function g(e){return function(){return!e.apply({},arguments)}}function y(e,t){return s.filter(s.map(e,r));function r(e){var r=s.filter(e.devices,t);if(r.length){return{spec:e.spec,devices:r}}else{return null}}}function v(e){i(e);var t=e.deviceInfo.where.unlocked,r=_(e,t);var n=t.and(a).groupBy(p.minimalSpecKey);return s.map(n,o);function a(e){var t=e.spec,i=e.virtual,n=!i,a=n&&!s.any(e.consumers,{_type:"slice"}),o=i||a,l=r&&t.type==="SSD"&&t.fp_support;return o&&!l}function o(e,t){return{spec:JSON.parse(t),devices:s.map(e,"id")}}}function _(e,t){var r=t.where.physical.and(c).groupBy(l),i=s.keys(r).length>1;var n=e.hagroup._policies||{},a=n.Aggregates||{},o=a.ssdsForFlashPool;if(o===undefined){o=true}return o&&i;function l(e){return e.spec.type==="SSD"}function c(e){return!!e.spec.fp_support}}t.exports=function T(e){var t=new f(e);return t.bestPlan()}},{"../../dump":69,"../util":104,"./aggregateReporter":76,"./plans/propose-data":81,"./plans/propose-ddp":82,"./plans/propose-root-sliced":83,"./plans/propose-root-unsliced":84,assert:127}],80:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("../../../lcprop"),a=e("../../../dump"),o=e("../component-builder");a();function l(e,t,r){i(this instanceof l);i(e);i(s.isArray(t));i(s.isArray(r));this.hagi=e;this.deviceGroups=t;this.aggregates=r;i.equal(typeof this.propose,"function");i.equal(typeof this.name,"string");n(this,"controllerIds",this._get_controllerIds);n(this,"controllersWithoutRoot",this._get_controllersWithoutRoot);n(this,"isFAS",this._get_isFAS);n(this,"knownAggregatesInHagroupIncludingProposed",this._get_knownAggregatesInHagroupIncludingProposed);n(this,"rootSliceCountForSystem",this._get_rootSliceCountForSystem);n(this,"specById",this._get_specById);this.componentBuilder=new o(e)}l.prototype.getNonConflictingAggregateName=function u(e,t){t=t||"aggr";i.equal(typeof t,"string");e=this.findControllerDespiteAmbiguousReference(e);var r=e.name||e._id.slice(0,8),n=r.toLowerCase().replace(/[^a-z0-9_]+/g,"_"),a=n+"_"+t,o=s.map(this.knownAggregatesInHagroupIncludingProposed,"name"),l=s.zipObject(o),c=s.partial(s.has,l),u;if(!c(a)){return a}for(u=0;c(a+u);u++){}return a+u};l.prototype.findControllerDespiteAmbiguousReference=function p(e){i(this instanceof l);if(typeof e==="string"){return this.hagi.find.controller(e)}else{i(s.isPlainObject(e));i.equal(typeof e._id,"string");return this.hagi.find.controller(e._id)}};l.prototype.isMissingRootAggregateFor=function d(e){i(this instanceof l);e=this.findControllerDespiteAmbiguousReference(e);return!s.some(this.aggregates,{_controller:e._id,is_root_aggregate:true})};l.prototype.liveDevicesForSpecAndController=function f(e,t){i(this instanceof l);i(s.isPlainObject(e));t=this.findControllerDespiteAmbiguousReference(t);i(s.isPlainObject(t));var r=0;s(this.aggregates).where({_controller:t._id}).map("_raid_groups").flatten().map("_devices").flatten().map(n,this).where(e).forEach(a);return r;function n(e){i(this instanceof l);return this.specById[e]}function a(){r+=1}};l.prototype.sparesFor=function h(e){i.equal(typeof e,"number");var t=e;for(var r=1;r<arguments.length;r++){i.equal(typeof arguments[r],"number");t+=arguments[r]}var s={sparesLevel:this._getSparesPolicy(),deviceCount:t,raidCount:e===0?1:Number.MAX_VALUE};return this.hagi.lookup.expectedSpares(s)};l.prototype._getSparesPolicy=function m(){return this.hagi.hagroup._policies&&this.hagi.hagroup._policies.spare_allocation&&this.hagi.hagroup._policies.spare_allocation.enforce&&this._getShelvesCount()>1?this.hagi.hagroup._policies.spare_allocation.enforce.toLowerCase():"minimum"};l.prototype._getShelvesCount=function g(){return s(this.hagi.deviceInfo).groupBy("shelf").keys().value().length};l.prototype._get_controllersWithoutRoot=function y(){i(this instanceof l);return s(this.hagi.controllers).filter(this.isMissingRootAggregateFor,this).value()};l.prototype._get_knownAggregatesInHagroupIncludingProposed=function v(){i(this instanceof l);var e=this.aggregates.slice(0);if(!this.hagi.cluster){return e}s.forEach(this.hagi.cluster.hagroups,function(t){var r=this.hagi.inspect(t);if(r.hagroup._id!==this.hagi.hagroup._id){e=e.concat(r.aggregates)}},this);return e};l.prototype._get_specById=function _(){i(this instanceof l);var e={};s.forEach(this.hagi.deviceInfo,function(t){e[t.id]=t.spec});return e};l.prototype._get_infoById=function E(){i(this instanceof l);var e={};s.forEach(this.hagi.deviceInfo,function(t){e[t.id]=t});return e};l.prototype._get_controllerIds=function b(){i(this instanceof l);return this.hagi.controllers.map("_id")};l.prototype._get_rootSliceCountForSystem=function w(){i(this instanceof l);return this.hagi.deviceInfo.where(c).length};function c(e){return e.spec.slice==="P2"&&e.spec._for_controller!=="undefined"}l.prototype._get_isFAS=function S(){i(this instanceof l);var e=this.hagi.configGroup,t=this.hagi.configGroup.parent||{};return e.id==="FAS"||t.id==="FAS"};t.exports=l},{"../../../dump":69,"../../../lcprop":72,"../component-builder":77,assert:127}],81:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=window._,a=e("./propose-abstract"),o=e("../../../dump");o();function l(e,t,r){i(this instanceof l);this.name="data";a.call(this,e,t,r)}s.inherits(l,a);l.prototype.propose=function u(){i(this instanceof l);var e=this.hagi.lookup,t=this.hagi.hagroup._policies||{};if(!this.isFAS){return}if(this.controllersWithoutRoot.length){return}if(t.Aggregates&&t.Aggregates.manual){return}var r=e.defaultAggrProps(),s=r.block_type,a=r.raid_type,o=e.minAggrDeviceCount(a);var c=n.cloneDeep(this.deviceGroups),u,p;while(true){if(!(u=c.shift())){return}if(u.devices.length<o){continue}p=0;n.forEach(this.controllerIds,d,this);if(u.devices.length<p){continue}break}function d(e,t){i(this instanceof l);
var r=this.liveDevicesForSpecAndController(u.spec,e),s=t===0,n=s?o:0,a=r+n;p+=this.sparesFor(a)+n}var f=this.controllerIds,h=u.devices.length,m=u.spec,g=e.maxAggrDataDeviceCount(m,h,s,a),y=e.lowestOverheadRaidSize(m,a,g),v=g%y,_=g-v;var E=n.clone(u.devices);function b(){u.devices=n.clone(E)}var w=n.bind(this.attempt,this,u,a);var S=w(_);if(S.length===f.length){return{mode:"all",aggregates:S}}else{b()}if(h<24){var A=w(h);if(A.length){return{mode:"all",aggregates:A}}else{b()}}return{mode:"all",aggregates:w(Math.ceil(h/f.length))}};l.prototype.attempt=function p(e,t,r){i(this instanceof l);i(n.isPlainObject(e));i(n.isString(t));i(n.isNumber(r));var s=n.bind(this.liveDevicesForSpecAndController,this,e.spec),a=n.map(this.controllerIds,s);if(a.length===2&&a[0]===a[1]){var o=2*this.sparesFor(a[0],r),u=e.devices.length-(r*2+o),p=Math.floor(u/2);if(p<0&&c+p<0){r=r+p}}var d=this.hagi.lookup.minAggrDeviceCount(t),f=this.controllerIds,h=this.windBackForSpares(e,f[0],r),m=[];if(h>=d){m.push(this.makeDataAggregate(f[0],e,h));var g=f.length===1?0:this.windBackForSpares(e,f[1],r);if(g>=d){m.push(this.makeDataAggregate(f[1],e,g))}}return m};var c=8;l.prototype.windBackForSpares=function d(e,t,r){i(this instanceof l);i(n.isPlainObject(e));i(n.isString(t));i(n.isNumber(r));var s=this.liveDevicesForSpecAndController(e.spec,t),a=this.sparesFor(s,r),o=e.devices.length-(r+a);if(o>=0){return r}else if(c+o<0){return 0}else{return r+o}};l.prototype.makeDataAggregate=function f(e,t,r){i(this instanceof l);i.equal(typeof e,"string");i(n.isPlainObject(t));i.equal(typeof r,"number");i(r>0);var s={strategy:this.name,name:this.getNonConflictingAggregateName(e,"data"),is_root_aggregate:false},a=this.componentBuilder.makeAggregate(e,t,r,s);return a};t.exports=l},{"../../../dump":69,"./propose-abstract":80,assert:127,util:132}],82:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=window._,a=e("./propose-abstract"),o=e("../../../dump");o();function l(e,t,r){i(this instanceof l);this.name="ddp";a.call(this,e,t,r)}s.inherits(l,a);l.prototype.propose=function u(){i(this instanceof l);var e=this.hagi.lookup,t=this.hagi.hagroup._policies||{},r=[];if(this.isFAS){return}if(t.Aggregates&&t.Aggregates.manual){return}var s=e.defaultAggrProps(),a=s.block_type,o=s.raid_type;while(this.deviceGroups.length){var u=this.deviceGroups.shift(),p=u.devices.length,d=e.minAggrDeviceCount(o);if(p<d){continue}n.forEach(this.controllerIds,f,this)}function f(t){i(this instanceof l);var s=e.maxAggrDataDeviceCount(u.spec,p,a,o),d=c(p,s);n.forEach(d,f,this);function f(e){var i=n.clone(u.devices),s={strategy:this.name,name:this.getNonConflictingAggregateName(t,"data"),is_root_aggregate:false},a=this.componentBuilder.makeAggregate(t,u,e,s);u.devices=i;r.push(a)}}return{mode:"any",aggregates:r}};function c(e,t){if(e>2*t){return[t]}else if(e>t){return[t,Math.floor(t/2)]}else{return[e]}}t.exports=l},{"../../../dump":69,"./propose-abstract":80,assert:127,util:132}],83:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=window._,a=e("./propose-abstract"),o=e("../../../dump");o();function l(e,t,r){i(this instanceof l);this.name="sliced_root";a.call(this,e,t,r)}s.inherits(l,a);l.prototype.propose=function c(){i(this instanceof l);if(!this.isFAS){return}var e=this.hagi.controllers.filter(this.isMissingRootAggregateFor,this).map(r,this).filter("length").map(0);return{mode:"all",aggregates:n.map(e,t,this)};function t(e){i(this instanceof l);var t=e.spec._for_controller;var r={strategy:this.name,name:this.getNonConflictingAggregateName(t,"root"),is_root_aggregate:true},s=e.devices.length,n={1:{6:5,12:10},2:{6:5,12:10}};s=n[this.controllerIds.length][s]||s;return this.componentBuilder.makeAggregate(t,e,s,r)}function r(e){i(this instanceof l);return n.filter(this.deviceGroups,t);function t(t){return t.spec.slice==="P2"&&t.spec._for_controller===e._id}}};t.exports=l},{"../../../dump":69,"./propose-abstract":80,assert:127,util:132}],84:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=window._,a=e("./propose-abstract"),o=e("../../../dump");o();function l(e,t,r){i(this instanceof l);this.name="unsliced_root";a.call(this,e,t,r)}s.inherits(l,a);l.prototype.propose=function c(){i(this instanceof l);if(!this.isFAS){return}if(this._sawSlices()){return}var e=this.controllersWithoutRoot;if(!e.length){return}var t=n.sortBy(this.deviceGroups,c);for(var r=0;r<t.length;r++){var s=t[r],a=this.whatif(e,"RAID_DP",s);if(a){var o=n.partial(this.makeNewRootAggregateFrom,s,a);return{mode:"all",aggregates:n.map(e,o,this)}}}return{mode:"any",aggregates:n.filter(n.map(this.deviceGroups,u,this))};function c(e){return e.spec.rpm}function u(t){i(this instanceof l);var r=this.hagi.lookup.minimalRootAggregateDriveCount(t.spec,"RAID_DP"),s=e[0];return this.makeNewRootAggregateFrom(t,r,s)}};l.prototype.whatif=function u(e,t,r){i(this instanceof l);var s=r.spec,a=this.hagi.lookup.minimalRootAggregateDriveCount(s,t),o=n.bind(this.liveDevicesForSpecAndController,this,s),c=n.map(e,o),u=n.map(c,f,this),p=0;for(var d=0;d<e.length;d++){p+=a;p+=u[d]}if(p>r.devices.length){return 0}else{return a}function f(e){i(this instanceof l);return this.sparesFor(a,e)}};l.prototype.makeNewRootAggregateFrom=function p(e,t,r){i(this instanceof l);i(n.isPlainObject(e));i(n.isNumber(t));i(n.isPlainObject(r));if(e.devices.length<t){return}var s=r._id,a={strategy:this.name,name:this.getNonConflictingAggregateName(s,"root"),is_root_aggregate:true};return this.componentBuilder.makeAggregate(s,e,t,a)};l.prototype._sawSlices=function d(){return n(this.hagi.controllers).map("_assigned_storage").filter().flatten().any()};t.exports=l},{"../../../dump":69,"./propose-abstract":80,assert:127,util:132}],85:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("../../units"),a=e("./raid-types");function o(){this._raidTypes=new a}o.prototype.findLimits=function(e,t,r,n){s(e,"must provide hagroup inspector to find raid limits");s(e.hagroup,"must provide hagroup for inspector to find raid limits");s(e.hagroup.version,"hagroup must have a version");s(t,"must provide a selected raid type to find limits");s(r,"must provide device specs to find limits for");var a=e.versionNumber,o=i.isArray(r)?r:[r];if(e.isESeries){return this._findLimitsForESeries(t,o,n)}else{return this._findLimitsForFAS(t,o,a)}};o.prototype._findLimitsForESeries=function(e,t,r){var s={},n=this;i.forEach(t,function(t){var i=null,a=t.quantity||r,o;switch(e){case n._raidTypes.RAID_1:i=n._packageResult(2,2,2,2);break;case n._raidTypes.RAID_5:case n._raidTypes.RAID_6:i=n._packageResult(30,30,30,30);break;case n._raidTypes.DDP:o=a||11;i=n._packageResult(o,o,o,o);break;case n._raidTypes.RAID_0:o=a||2;i=n._packageResult(o,o,o,o);break;case n._raidTypes.RAID_3:o=a||3;i=n._packageResult(o,o,o,o);break;case n._raidTypes.RAID_10:o=a||4;i=n._packageResult(o,o,o,o);break;default:throw new Error("Raid Type "+e+" is unsupported on ESeries system.")}n._applyUpdatedValueToDeviceLimits(s,"defaultSize",i.defaultSize,false);n._applyUpdatedValueToDeviceLimits(s,"lowestSize",i.lowestSize,false);n._applyUpdatedValueToDeviceLimits(s,"highestSize",i.defaultSize,true);n._applyUpdatedValueToDeviceLimits(s,"maximumSize",i.defaultSize,true)});return s};o.prototype._findLimitsForFAS=function(e,t,r){var s={},n=this;i.forEach(t,function(t){var i=null;switch(e){case n._raidTypes.RAID_0:i=n._FASRaid0Limits(t);break;case n._raidTypes.RAID_4:i=n._FASRaid4Limits(t);break;case n._raidTypes.RAID_DP:i=n._FASRaidDPLimits(r,t);break;default:throw new Error("Raid Type "+e+" is unsupported on FAS system.")}n._applyUpdatedValueToDeviceLimits(s,"defaultSize",i.defaultSize,false);n._applyUpdatedValueToDeviceLimits(s,"lowestSize",i.lowestSize,false);n._applyUpdatedValueToDeviceLimits(s,"highestSize",i.highestSize,true);n._applyUpdatedValueToDeviceLimits(s,"maximumSize",i.maximumSize,true)});return s};o.prototype._applyUpdatedValueToDeviceLimits=function(e,t,r,i){var s=e[t];if(!s){s=r}e[t]=i?Math.min(s,r):Math.max(s,r)};o.prototype._FASRaid0Limits=function(e){s(this._fixDriveType(e.type)==="LUN","You must use a LUN for FAS Raid 0.");return this._packageResult(8,8,14,14)};o.prototype._FASRaid4Limits=function(e){s(e,"You must provide a drive to determine raid 4 limits for FAS");s(e.type,"You must provide a drive type to determine raid 4 limits for FAS");var t=this._fixDriveType(e.type);switch(t){case"FC_SAS":case"SSD":return this._packageResult(8,8,8,14);case"SATA":case"NL_SAS":case"MSATA":return this._packageResult(7,7,7,7);default:throw new Error("Unknown drive type "+t+" for FAS raid 4 limits.")}};o.prototype._FASRaidDPLimits=function(e,t){s(t,"You must provide a drive to determine raid DP limits for FAS");s(t.type,"You must provide a device type to determine raid DP limits for FAS");s(t.rsgb,"You must provide capacity for device to determine raid DP limits for FAS");var r=this._fixDriveType(t.type);switch(r){case"FC_SAS":return this._packageResult(16,12,20,28);case"SATA":case"NL_SAS":case"MSATA":return this._FASRaidDPLimitsForCapacityDrives(e,t.rsgb);case"SSD":return this._packageResult(23,20,28,28);default:throw new Error("Unknown drive type "+r+" for FAS raid DP limits.")}};o.prototype._FASRaidDPLimitsForCapacityDrives=function(e,t){if(t>=6e3){return this._packageResult(14,12,14,14)}else if(i.contains(e,"8.")){return this._packageResult(14,12,20,20)}else{return this._packageResult(14,12,16,16)}};o.prototype._packageResult=function(e,t,r,i){return{defaultSize:e,lowestSize:t,highestSize:r,maximumSize:i}};o.prototype._fixDriveType=function(e){if(e){if(e.toUpperCase()==="SAS"||e.toUpperCase()==="FC"){return"FC_SAS"}return e.replace("-","_").toUpperCase()}};o.prototype.getEffectiveRaidSize=function l(e,t,r,s,n){var a=this.findLimits(e,t,r,s,n),o=s%a.defaultSize,l=a.defaultSize,c=this._raidTypes;if(o!==0){if(s<=a.maximumSize){l=Math.min(a.maximumSize,s);return l}var u=i.range(a.lowestSize,a.highestSize+1),p=i.map(u,function(e){var r=Math.floor(s/e),i=s%e,n=c.driveRolesForRaidType(t,e),a=n.parity+n.dparity,o=i===0?r:r+1;return{overheadDrives:o*a,proposedRaidSize:e}});var d=i.sortBy(p,"overheadDrives");l=i.first(d).proposedRaidSize}return l};o.prototype.maxTotalDrivesGivenDriveSpecAndAggrMaxUnit=function(e,t,r,i,s){if(r===this._raidTypes.RAID_5||r===this._raidTypes.RAID_6){return 30}var a=new n(i.rsgb,"GB"),o=Math.floor(e.value_gb/a.value_gb);return this.totalDrivesGivenDataDriveCountAndRaidTypeForEffectiveRaidSize(o,t,r,i,s)};o.prototype.totalDrivesGivenDataDriveCountAndRaidTypeForEffectiveRaidSize=function(e,t,r,i,s){var n=this.parityDriveCountNeededGivenDataDriveCountAndRaidType(e,t,r,i);var a=e+n;this.getEffectiveRaidSize(t,r,i,a,s);return a};o.prototype.parityDriveCountNeededGivenDataDriveCountAndRaidType=function(e,t,r,i){var s=this.findLimits(t,r,i),n=new a,o=n.getParityCountForRaidType(r),l=s.maximumSize;return this.parityDriveCountNeededGivenDataDriveCount(e,l,o)};o.prototype.parityDriveCountNeededGivenDataDriveCount=function(e,t,r){return r*this.raidGroupCountGivenDataDriveCount(e,t,r)};o.prototype.raidGroupCountGivenDataDriveCount=function(e,t,r){return e>=t?Math.floor(e/t)+this.raidGroupCountGivenDataDriveCount(r*Math.floor(e/t)+e%t,t,r):e+r<=t?1:2};o.prototype.minDrivesNeededForDedicatedRootAggregate=function(e,t,r){var i=new a,s=e.limits.aggr.root_aggr_size_mib,o=new n(s,"MiB"),l=new n(t.rsgb,"GB"),c=Math.ceil(o.value_gb/l.value_gb)+i.getParityCountForRaidType(r),u=i.minRaidSize(r);return Math.max(u,c)};t.exports=o},{"../../units":123,"./raid-types":86,assert:127}],86:[function(e,t,r){"use strict";var i=window._,s=e("assert");function n(){i.extend(this,{RAID_0:"RAID_0",RAID_1:"RAID_1",RAID_3:"RAID_3",RAID_4:"RAID_4",RAID_5:"RAID_5",RAID_6:"RAID_6",RAID_10:"RAID_10",RAID_DP:"RAID_DP",DDP:"DDP"})}n.prototype.minRaidSize=function a(e){e=this._fixOldRaidTypeIfRequired(e);switch(e){case this.RAID_0:case this.RAID_1:case this.RAID_4:return 2;case this.RAID_2:case this.RAID_3:case this.RAID_5:case this.RAID_DP:return 3;case this.RAID_6:case this.RAID_10:return 4;case this.DDP:return 11;default:return 1}};n.prototype.isMirrored=function o(e){e=this._fixOldRaidTypeIfRequired(e);switch(e){case this.RAID_1:case this.RAID_10:return true;default:return false}};n.prototype.firstDriveRoles=function l(e){e=this._fixOldRaidTypeIfRequired(e);return this._raidMaps[e]};n.prototype.driveRolesForRaidType=function c(e,t){e=this._fixOldRaidTypeIfRequired(e);var r=this._howManyOfThisRoleForRaidType(e,"parity"),i=this._howManyOfThisRoleForRaidType(e,"dparity"),s=t-r-i;return{parity:r,dparity:i,data:s}};n.prototype._fixOldRaidTypeIfRequired=function u(e){return this._intRaidTypeToString(e)};n.prototype._intRaidTypeToString=function p(e){if(this._isInt(e)){var t=["RAID_0","RAID_1","RAID_3","RAID_4","RAID_5","RAID_6","RAID_10","RAID_DP","DDP"];return t[e]}else{return e}};n.prototype._isInt=function d(e){return Number(e)===e&&e%1===0};n.prototype._howManyOfThisRoleForRaidType=function f(e,t){s(t!=="data","do not use this for data, look for everything else and data is what is left over");e=this._fixOldRaidTypeIfRequired(e);var r=i.where(this.firstDriveRoles(e),function(e){return e===t});return r.length};n.prototype._raidMaps={RAID_0:["data"],RAID_1:["data"],RAID_3:["parity","data"],RAID_4:["parity","data"],RAID_5:["parity","data"],RAID_6:["parity","dparity","data"],RAID_10:["data"],RAID_DP:["parity","dparity","data"],DDP:["data"]};n.prototype._getDdpReserveRecommendation=function(e){if(e<=11){return 1}else if(e<=31){return 2}else if(e<=63){return 3}else if(e<=127){return 4}else if(e<=191){return 6}else if(e<=255){return 7}else if(e<=384){return 8}else{return Math.min(Math.ceil(e*.2),10)}};n.prototype.getParityCountForRaidType=function(e){return this._howManyOfThisRoleForRaidType(e,"parity")+this._howManyOfThisRoleForRaidType(e,"dparity")};t.exports=n},{assert:127}],87:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("./aggregateReporter.js");function a(e,t){s(t instanceof Array,"87f630a2");s(i.has(e,"inspect"),"e6f2781c");this._selectedHaGroups=t;this.inspect=e.inspect}a.prototype.createSystemSummary=function(){var e=this,t={total:0,rawCapacity:0,usableCapacity:0,spareCount:0,driveRoleSummary:{physical:{total:0,data:0,parity:0,dparity:0,cache:0,root:0,spare:0},virtual:{total:0,data:0,parity:0,dparity:0,cache:0,root:0,spare:0}},performanceSummary:{total:0,rawCapacity:0,usableCapacity:0,driveCapacitySummaryByType:[]},capacitySummary:{total:0,rawCapacity:0,usableCapacity:0,driveCapacitySummaryByType:[]},ssdSummary:{total:0,rawCapacity:0,usableCapacity:0,driveCapacitySummaryByType:[]}};i.forEach(e._selectedHaGroups,function(r){var s=e.inspect(r),n=s.allPhysicalDevices(),a=s.deviceInfo.where.spare.and.physical,o=s.deviceInfo.where.spare.and.virtual;e._populateSystemSummaryWithPhysicalDevices(s,t,n);t.driveRoleSummary.physical.spare+=a.length;t.driveRoleSummary.physical.total+=a.length;t.driveRoleSummary.virtual.spare+=o.length;t.driveRoleSummary.virtual.total+=o.length;i.forEach(r.controllers,function(r){i.forEach(r.aggregates,function(r){e._updateSystemSummaryUsingGivenAggregate(s,t,r)})})});return t};a.prototype._populateSystemSummaryWithPhysicalDevices=function(e,t,r){var s=this;i.forEach(r,function(r){var i=r.devices.length,n=i*r.spec.rawgb;t.total+=i;t.rawCapacity+=n;var a=r.spec.type,o=a==="SSD",l=e.lookup.isDeviceTypePerformance(a);if(o){s._updateDeviceClassRawSummary(t.ssdSummary,r.spec,i,n)}else if(l){s._updateDeviceClassRawSummary(t.performanceSummary,r.spec,i,n)}else{s._updateDeviceClassRawSummary(t.capacitySummary,r.spec,i,n)}})};a.prototype._updateDeviceClassRawSummary=function(e,t,r,s){e.total+=r;e.rawCapacity+=s;var n=i.where(e.driveCapacitySummaryByType,function(e){return e.rawgb===t.rawgb&&e.type===t.type});if(n.length>0){var a=i.indexOf(e.driveCapacitySummaryByType,i.first(n));e.driveCapacitySummaryByType[a].count+=r}else{e.driveCapacitySummaryByType.push({rawgb:t.rawgb,count:r,type:t.type})}};a.prototype._updateSystemSummaryUsingGivenAggregate=function(e,t,r){var s=new n(e),a=s.createAggregateReport(r),o=a.summary,l=this;if(!o.isRootAggregate){t.usableCapacity+=o.usableCapacity;i.forEach(i.keys(o.driveRoleSummary.physical),function(e){t.driveRoleSummary.physical[e]+=l._nullToZero(o.driveRoleSummary.physical[e])});i.forEach(i.keys(o.driveRoleSummary.virtual),function(e){t.driveRoleSummary.virtual[e]+=l._nullToZero(o.driveRoleSummary.virtual[e])});i.forEach(i.keys(o.usableCapacityByType),function(r){var i=r==="SSD",s=e.lookup.isDeviceTypePerformance(r),n=o.usableCapacityByType[r];if(i){t.ssdSummary.usableCapacity+=n}else if(s){t.performanceSummary.usableCapacity+=n}else{t.capacitySummary.usableCapacity+=n}})}else{t.driveRoleSummary.physical.root+=l._nullToZero(o.driveRoleSummary.physical.total);t.driveRoleSummary.physical.total+=l._nullToZero(o.driveRoleSummary.physical.total);t.driveRoleSummary.virtual.root+=l._nullToZero(o.driveRoleSummary.virtual.total);t.driveRoleSummary.virtual.total+=l._nullToZero(o.driveRoleSummary.virtual.total)}};a.prototype._nullToZero=function(e){if(e===undefined||e===null){return 0}else{return e}};t.exports=a},{"./aggregateReporter.js":76,assert:127}],88:[function(e,t,r){"use strict";var i=e("assert"),s=window._;var n=48;function a(){i(false,"mixin; do not use in isolation")}a.prototype._applyADPAndAddAggregates=function R(e){var t=this._makeNewMap(),r=t.inspect(e);l(r);o(r);T(r);m(r);t.rehydrate();this._buildAggregates(e)};function o(e){s.forEach(e.hagroup.controllers,function(e){e.aggregates=s.where(e.aggregates,{_manual:true})})}function l(e){s.forEach(e.hagroup.controllers,function(e){e.storage_pools=s.where(e.storage_pools,{_manual:true})})}var c=1024/4,u=1024*c,p=1.073741824,d=u/p,f=20.5*c,h=8*c;function m(e){var t=e.hagroup._policies||{},r=t.ADP||{};if(r.prohibitedByUser){return}var i=E(e);if(!i){return}var a=e.limits,o=s(i.shelves).map("_x_bom").map("drive_spec_members").flatten().first(n).value();if(!v(o)){return}var l=o.length,u=i.driveSpec.rsgb*d,p=a.aggr.root_aggr_size_mib*c,m=_(l),b=m.data,w=Math.floor(p/b)+f+h,S=y(w)-h,A=y(u-S-f-2*h),C=s.map(o,s.partial(R,2)),T=s.map(o,s.partial(R,1));s.forEach(e.hagroup.controllers,function P(e){g(e,"P2",S,C,m.total)});if(l===12){g(e.hagroup.controllers[0],"P1",A,T,null)}else{s.forEach(e.hagroup.controllers,function N(e){g(e,"P1",A,T,m.total)})}function R(e,t){return t+"P"+e}}function g(e,t,r,i,s){if(!s){s=i.length}e._assigned_storage.push({slice_details:{slice:t,used_blocks:r,devices:i.splice(0,s)}})}function y(e){return e-e%64}function v(e){var t=[12,24,48];return e&&s.contains(t,e.length)}function _(e){switch(e){case 12:return{data:3,parity:2,spare:1,total:6};case 24:return{data:8,parity:2,spare:2,total:12};case 48:return{data:20,parity:2,spare:2,total:24};default:i(false,e+" drives not supported")}}function E(e){var t=e.hagroup.shelves,r=t[0],i=s.every(t,S),n=s.partial(C,r),a=s.every(t,n),o=i&&a,l=s.filter(t,w),c=b(l);var u=o?t:l;if(!u.length){return null}var p=u[0],d=p._x_bom.drive_specs[0];var f=e.config.matrix,h=f.checkVersionShelfDrive(e.hagroup.version,p.model,d.model);if(!h.root_slicing){return null}if(!o&&c){return null}return{driveSpec:s.omit(d,"quantity"),shelves:u}}function b(e){if(!e||e.length===0){return false}var t=s.first(e);if(!t._isembedded){return false}return S(t)}function w(e){return A(e)&&e._isembedded}function S(e){return e&&A(e)&&e._x_bom.drive_specs[0].type==="SSD"}function A(e){return e._x_bom.drive_specs.length===1}function C(e,t){return e&&t&&s.isEqual(e._x_bom.drive_specs,t._x_bom.drive_specs)}function T(e){s.forEach(e.hagroup.controllers,function(e){e._assigned_storage=[]})}t.exports=a},{assert:127}],89:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("../aggregates/raid-types"),o=e("../../units");var l=3,c=2,u=28,p=4;function d(){i(false,"mixin; do not use in isolation")}d.prototype.assignFlashPoolWhereAvailable=function f(e){var t=this._makeNewMap(),r=t.inspect(e),i=!r.isESeries&&!r.isFlashRay,s=this._isFullsteamPlus(r),n=s?this._buildStoragePools:this._buildClassicFPRaidGroups,a=r.availablePhysicalDevices(),o=this._filterDevicesForFlashPool(a),l=o&&o.length>0,c=this._existingDataAggregates(e),u=this._flashPoolPolicy(e);this.MIN_DISKS_FP=r.lookup.minimumFPDevicesForAggregate;if(i&&l&&u){n(c,o)}};d.prototype._flashPoolPolicy=function h(e){var t=true,r=e._policies;if(r&&r.Aggregates){return r.Aggregates.ssdsForFlashPool}return t};d.prototype._buildStoragePools=function m(e,t){var r=this._determineFPStoragePoolAllocation(e,t),i=[],n=this;s.forEach(r,function(e){s.forEach(s.range(1,e.storagePoolCount+1),function(){var t=Math.min(e.willServeAggregates.length,p),r=s.take(e.willServeAggregates,t),a=n._findControllerWhoOwnsAggregate(s.first(r)),o=e.devicesPerStoragePool,l=n._raidTypeGivenDeviceConstraints(o);var c=n.addStoragePool(a._id,e.physicalDeviceSpec,l,o,false);n._takeSlicesForAggregates(c,r);i.push(c);var u=s.difference(e.willServeAggregates,r);if(u.length>0){e.willServeAggregates=s.difference(e.willServeAggregates,r)}})});return i};d.prototype._buildClassicFPRaidGroups=function g(e,t){var r=this._determineFPRaidGroupAllocation(e,t),i=[],n=this;s.forEach(r,function(e){s.forEach(e.willServeAggregates,function(t){var r=e.devicesPerAggregate,a=e.physicalDeviceSpec,o=n._raidTypeGivenDeviceConstraints(r);if(s.first(e.willServeAggregates)===t){r+=e.leftovers}var l=n.addFlashPoolRaidGroupToAggregate(t,o,a,r);i.push(l)})});return i};d.prototype._raidTypeGivenDeviceConstraints=function y(e){var t=new a,r=t.RAID_DP,n=[t.RAID_0,t.RAID_1];if(e<t.minRaidSize(r)){var o=s.map(s.keys(t),function(e){return{raidType:e,minimum:t.minRaidSize(e)}}),l=s.where(o,function(t){return t.minimum<=e&&!s.contains(n,t.raidType)});i(l.length>0,"Unable to find any raid type given constraint for "+e+" devices");return s.first(s.sortBy(l)).raidType}return r};d.prototype._takeSlicesForAggregates=function v(e,t){i(t,"Must provide aggregates to take storage pool slices for");i(t.length<=p,"Cannot exceed "+p+" aggregates being assigned per pool");var r=this._findStoragePoolById(e),n={},a=this._fullyUtilizeStoragePoolGivenAggregates(t),o=this;s.forEach(s.range(0,p),function(e){var t=a[e],i=r.raid_type,l=r._allocations[e].devices.length,c=s.first(r._allocations[e].__deviceSpecs).spec,u=o.addFlashPoolRaidGroupToAggregate(t,i,c,l);if(u){r._allocations[e].aggr_id=t;if(!n[t]){n[t]=[]}n[t].push(u)}});return n};d.prototype._deviceSpecFromAllocationUnit=function _(e,t,r,i){var n=new o(4,"KiB").mult(r.used_blocks).value_gb,a=s.clone(i);a=s.merge(a,{rsgb:n,slice:t,_for_storage_pool:e});return a};d.prototype._fullyUtilizeStoragePoolGivenAggregates=function E(e){var t=p-e.length;if(t>0){var r=0;var i=s.map(s.range(0,t),function(t){if(t+1>e.length){r=0}return e[r++]});e.push.apply(e,i)}return e};d.prototype._determineFPStoragePoolAllocation=function b(e,t){var r=[],i=s.map(e,"_id"),n=e.length,a=this._totalNumberOfDevices(t),o=this;s.forEach(t,function(e){if(e.devices.length<c){return}if(!e.spec.fp_support){return}var t=o._devicesPerFPStoragePool(e,n,a),s=o._mergeAndPackageFPAllocationForDevice(e,t,i);if(s){r.push(s)}});return r};d.prototype._determineFPRaidGroupAllocation=function w(e,t){var r=[],i=s.map(e,"_id"),n=e.length,a=this._totalNumberOfDevices(t),o=this;s.forEach(t,function(e){var t=o._devicesPerFPRaidGroupAggregate(e,n,a),s=o._mergeAndPackageFPAllocationForDevice(e,t,i);if(s){r.push(s)}});return r};d.prototype._mergeAndPackageFPAllocationForDevice=function S(e,t,r){if(t&&t.willServeAggregates>0){s.merge(t,{willServeAggregates:s.take(r,t.willServeAggregates),physicalDeviceSpec:e.spec});r=s.without(r,t.willServeAggregates);return t}return null};d.prototype._devicesPerFPStoragePool=function A(e,t,r){var i=e.devices.length,s=i/r,n=Math.floor(t*s),a=Math.ceil(n/p),o=Math.floor(i/a),l=i-o*a;if(l%a===0&&l>0){o+=l/a}if(o<c){while(o<c){a--;o=Math.floor(o/a);if(a===0){o=0;break}}}if(o>u){while(o>u){a++;o=Math.floor(o/a);if(o===Infinity){o=0;break}}}if(a===1){o+=l;l=0}return{willServeAggregates:n,storagePoolCount:a,devicesPerStoragePool:o,leftovers:l}};d.prototype._devicesPerFPRaidGroupAggregate=function C(e,t,r){var i=e.devices.length,s=Math.floor(i/r),a=Math.floor(t*s),o=Math.floor(i/a),c=i-o*a;if(i<l){console.warn(n.format("Cannot allocate %s disks, minimum is %s",i,l));return null}if(c%a===0&&c>0){o+=c/a;c=0}if(o<l){while(o<l){a--;o++}}if(a===1){o+=c;c=0}return{willServeAggregates:a,devicesPerAggregate:o,leftovers:c}};d.prototype._isFullsteamPlus=function T(e){var t=parseFloat(e.versionNumber);if(t>=8.3){return true}else{return false}};d.prototype._existingDataAggregates=function R(e){var t=s.flatten(s.map(e.controllers,function(e){return e.aggregates?e.aggregates:[]}));return s.where(t,function(e){var t=s.flatten(s.map(e._raid_groups,function(e){var t=s.every(s.map(e.__deviceSpecs,function(e){return e.spec.fp_support})),r=s.uniq(s.map(e.__deviceSpecs,function(e){return e.spec.type})),i=r.length===1&&s.first(r)==="SSD"?false:true;return{supportsFlashPool:t,notJustSSDs:i}}));return!e._isManual&&!e.is_root_aggregate&&s.every(t,"supportsFlashPool")&&s.every(t,"notJustSSDs")})};d.prototype._totalNumberOfDevices=function P(e){var t=s.map(e,function(e){return e.devices.length});return s.reduce(t,function(e,t){return e+t})};d.prototype._filterDevicesForFlashPool=function N(e){return s.where(e,function(e){return e.spec.fp_support&&e.spec.type==="SSD"})};t.exports=d},{"../../units":123,"../aggregates/raid-types":86,assert:127,util:132}],90:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("uuid"),o=e("../../units");var l=28,c=2,u=4,p="storage_pool",d=/^(.*)(P[0-9]+)$/;function f(){i(false,"mixin; do not use in isolation")}f.prototype.addStoragePool=function A(e,t,r,s,n){i(s<=l,"Cannot create storage pool with this many devices");i(s>=c,"Cannot create storage pool with this few devices");i(t.type==="SSD","You cannot create a storage pool with non-ssd devices");var a=this._findSystemByControllerId(e),o=this._findController(a,e),u=this._buildStoragePool(a,o,t,r,s,n);if(!o.storage_pools){o.storage_pools=[]}o.storage_pools.push(u);if(n){this.rebuildAutoAggregates(a._id,{except:w})}return u._id};f.prototype.claimAllocationUnit=function C(e,t,r,i){var n=this._makeNewMap(),a=n.find.storage_pool(r),o=s.first(s.where(a._allocations,{slice:i})),l=o.__deviceSpecs[0].spec,c=o.devices;var u=this.addFlashPoolRaidGroupToAggregate(e,t,l,c.length);o.aggr_id=e;return u};f.prototype.releaseAllocationUnit=function T(e,t,r){var n=this._makeNewMap(),a=n.find.storage_pool(t),o=n.find.aggregate(e),l=s.first(s.where(a._allocations,{slice:r,aggr_id:e}));i.notEqual(l,undefined,"94afc5d3");var c=s.first(s.filter(o._raid_groups,function u(e){return s.intersection(e._devices,l.devices).length>0}));this.deleteFlashPoolRaidGroupFromAggregate(c._id);delete l.aggr_id};f.prototype.deleteStoragePool=function R(e){var t=this._makeNewMap(),r=t.inspect.storage_pool(e),i=r.storage_pool,n=r.controller,a=r.hagroup,o=this;s.forEach(i._allocations,function l(e){if(e.aggr_id){o.releaseAllocationUnit(e.aggr_id,i._id,e.slice)}});n.storage_pools=s.where(n.storage_pools,function(t){return t._id!==e});this.rebuildAutoAggregates(a._id,{except:w})};f.prototype.resizeStoragePool=function P(e,t){i.equal(typeof e,"string","190f475a.1");i.equal(typeof t,"number","190f475a.2");var r=this._makeNewMap();var n=r.inspect.storage_pool(e);var a=n.storage_pool,o=a._devices.length,l=s(a._allocations).map("aggr_id").filter().unique().map(r.find.aggregate);if(t===o){return}if(t>o){throw new Error("expansion not yet implemented")}var c=this,u=a._devices.slice(t);a._manual=true;if(u.length){this._removeDevices(a,m(u))}l.forEach(p);return;function p(e){if(u.length){c.removeDevicesFromAggregate(e,u)}}};function h(){var e=s.toArray(arguments);return function(t){for(var r in e){t=e[r](t)}return t}}f.prototype.removeDevicesFromAggregate=function N(e,t){i.equal(e._type,"aggregate","08f14727.a");var r=this,n=m(t);return s.forEach(e._raid_groups,function(e){r._removeDevices(e,n)})};function m(e){if(typeof e==="string"){return h(b,s.partial(s.isEqual,e),g)}else if(typeof e==="function"){return h(e,g)}else if(e instanceof Array){return h(b,s.partial(s.has,s.zipObject(e)),g)}else{i(false,"08f14727.d")}}function g(e){return!e}f.prototype._removeDevices=function D(e,t){var r=v(e.__deviceSpecs);i.equal(r.length,e._devices.length,"08f14727.dsmm");var n=h(s.first,t),a=s.filter(s.zip(e._devices,r),n);e._devices=s.map(a,s.first);e.__deviceSpecs=y(s.map(a,s.last))};function y(e){var t=null,r=0,i=[];s.forEach(e,n);a(null);return i;function n(e){if(e.spec===t){r+=e.count}else{a(e)}}function a(e){if(t!==null){i.push({spec:t,count:r})}if(e!==null){t=e.spec;r=e.count}else{t=null;r=0}}}function v(e){return s(e).map(_).flatten().value()}function _(e){return E({count:1,spec:e.spec},e.count)}function E(e,t){var r=[];for(var i=0;i<t;i++){r.push(e)}return r}function b(e){var t=e.match(d);if(t){return t[1]}else{return e}}function w(e){return s(e._raid_groups).map("__deviceSpecs").flatten().where("count").map("spec").any(S)}function S(e){return e.type!=="SSD"}f.prototype.addFlashPoolRaidGroupToAggregate=function x(e,t,r,i){var n=this._findAggregateById(e),a=this._systemThatContainsAggregate(e),o=this._newUniqueCacheRaidGroupName(n),l=this._buildFlashPoolRaidGroup(a,o,r,i);s.merge(n,{cache_raid_type:t,is_hybrid:true});n._raid_groups.push(l);return l._id};f.prototype.deleteFlashPoolRaidGroupFromAggregate=function k(e){var t=this._findAggregateWithRaidGroup(e);t._raid_groups=s.where(t._raid_groups,function(t){return t._id!==e});t.is_hybrid=s.where(t._raid_groups,{cache:true}).length>0};f.prototype._buildStoragePool=function O(e,t,r,i,n,o){var l=a(),c=this._newUniqueStoragePoolName(e),u=this._usedBlocksPerSlice(r),d=this._physicalDevicesMatchingSpec(e,r,n),f=this._buildAllocationsForNewStoragePool(l,u,r,d);return{_id:l,_type:p,name:c,type:r.type,raid_type:i,_manual:o,_devices:d,__deviceSpecs:[{count:d.length,spec:s.merge(s.clone(r),{_for_storage_pool:l})}],_allocations:f}};f.prototype._buildFlashPoolRaidGroup=function I(e,t,r,i){var n=this._makeNewMap(),o=n.inspect(e),l=o.availablePhysicalDevices().concat(o.availableStoragePoolDevices()),c=this._deviceIdsGivenAvailableSpecAndCount(l,r,i);return{_id:a(),_type:"raidgroup",name:t,_devices:c,__deviceSpecs:[{spec:s.omit(r,"quantity"),count:i}],cache:true,plex_number:1}};f.prototype._newUniqueCacheRaidGroupName=function M(e){var t=this._nextNumberInNamingSequence(e._raid_groups);return n.format("%s%s","rg",t)};f.prototype._newUniqueStoragePoolName=function F(e){var t=s.without(s.flatten(s.map(e.controllers,function(e){return e.storage_pools})),undefined),r=this._nextNumberInNamingSequence(t);return n.format("sp%s",r)};f.prototype._nextNumberInNamingSequence=function q(e){var t=s.map(e,function(e){var t=e.name.match(/(\d+)$/);return t?t[0]:0}),r=s.sortBy(t);return r.length>0?parseInt(s.last(r))+1:1};f.prototype._buildAllocationsForNewStoragePool=function L(e,t,r,i){var a=s.range(1,u+1),o=[],l=this;s.forEach(a,function(a){var c=n.format("P%s",a),u=s.map(i,function(e){return n.format("%sP%s",e,a)}),p={slice:c,used_blocks:Math.floor(t),devices:u},d=l._deviceSpecFromAllocationUnit(e,c,p,r),f={count:i.length,spec:d};s.merge(p,{__deviceSpecs:[f]});o.push(p)});return o};f.prototype._physicalDevicesMatchingSpec=function j(e,t,r){var i=this._makeNewMap(),s=i.inspect(e),n=s.unlockedPhysicalDevices();return this._deviceIdsGivenAvailableSpecAndCount(n,t,r)};f.prototype._deviceIdsGivenAvailableSpecAndCount=function B(e,t,r){var n=s(e).where(a).map("devices").flatten().value();i(n.length>=r,"Unable to find devices of specific spec/quantity to build storage pool/cache raid group");return s.sample(n,r);function a(e){return s.isEqual(o(t),o(e.spec))}function o(e){return s.omit(e,"quantity","_for_controller","model","_for_storage_pool","_from_parent")}};f.prototype._usedBlocksPerSlice=function X(e){var t=new o(e.rsgb,"GB"),r=new o(20.5,"MiB"),i=r.mult(5),s=t.subtract(i),n=s.divide(u),a=n.to("KiB").value/4;return a};f.prototype._systemThatContainsAggregate=function G(e){var t=this._mapControllerOwnership("aggregates"),r=s.where(t,function(t){return s.contains(t.ids,e)
}),i=s.first(r);return s.find(this.clip.synergy_model.hagroups,{_id:i.hagroupId})};f.prototype._findSystemByControllerId=function U(e){var t=s.where(this.clip.synergy_model.hagroups,function(t){return s.contains(s.map(t.controllers,function(e){return e._id}),e)});return s.first(t)};f.prototype._findControllerWhoOwnsAggregate=function V(e){var t=this._mapControllerOwnership("aggregates"),r=s.where(t,function(t){return s.contains(t.ids,e)}),i=s.first(r),n=this._findControllerById(i.controllerId);return n};f.prototype._findStoragePoolById=function H(e){var t=this._findControllerWithStoragePool(e);return s.first(s.where(t.storage_pools,function(t){return t._id===e}))};f.prototype._findController=function Y(e,t){return s.find(e.controllers,{_id:t})};f.prototype._findControllerById=function z(e){var t=s.where(this.clip.synergy_model.hagroups,function(t){return s.contains(s.map(t.controllers,function(e){return e._id}),e)}),r=s.first(t),i=s.find(r.controllers,{_id:e});return i};f.prototype._findControllerWithStoragePool=function W(e){var t=this._mapControllerOwnership("storage_pools"),r=s.where(t,function(t){return s.contains(t.ids,e)}),i=this._findControllerById(s.first(r).controllerId);return i};f.prototype._findAggregateById=function J(e){var t=this._mapControllerOwnership("aggregates"),r=s.where(t,function(t){return s.contains(t.ids,e)}),i=s.first(r),n=this._findControllerById(i.controllerId),a=s.first(s.where(n.aggregates,function(t){return t._id===e}));return a};f.prototype._findAggregateWithRaidGroup=function Q(e){var t=this,r=this._mapControllerOwnership("aggregates"),i=s.flatten(s.map(r,function(e){return s.map(e.ids,function(r){var i=t._findAggregateById(r);return{controllerId:e.controllerId,aggregateId:r,raidGroupIds:s.map(i._raid_groups,function(e){return e._id})}})})),n=s.where(i,function(t){return s.contains(t.raidGroupIds,e)}),a=s.first(n).aggregateId;return this._findAggregateById(a)};f.prototype._mapControllerOwnership=function Z(e){var t=s.map(this.clip.synergy_model.hagroups,function(t){var r=s.map(t.controllers,function(r){var i=[];if(r[e]){i.push.apply(i,s.map(r[e],function(e){return e._id}))}return{hagroupId:t._id,controllerId:r._id,ids:i}});return r});return s.flatten(t)};t.exports=f},{"../../units":123,assert:127,util:132,uuid:183}],91:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("events");function a(){i(false,"mixin; do not use in isolation")}a.prototype.disableTracing=function p(){if(this._tracingEnabled){console.error("===== builder tracing disabled");this._tracingEnabled=false}return this};a.prototype.disableTracing.pure=true;a.prototype.disableTracing.spam=true;a.prototype.enableTracing=function d(){if(!this._tracingEnabled){console.error("===== builder tracing enabled");this._tracingEnabled=true}if(this._tracingSetUp){return this}else{this._tracingSetUp=true}var e=this,t=l(e.clip,"clip");c(this).on("call",r).on("called",i);return this;function r(t){if(!e._tracingEnabled){return}n();if(!t.fn.spam){console.error(u(t.fname,t.localstack.length))}}function i(t){if(!e._tracingEnabled){return}if(!t.fn.pure){n()}if(t.err){var r=t.fname+" ! "+t.err.toString();console.error(u(r,t.localstack.length))}else if(!t.fn.pure){console.error(u("/"+t.fname,t.localstack.length))}}function n(){var r=l(e.clip,"clip"),i=s.uniq(s.flatten([s.keys(t),s.keys(r)])),n="";function a(e,t){if(n===""||e.slice(0,n.length)!==n){n=e;console.error(t+" "+e)}}i.sort();for(var o in i){var c=i[o];if(s.has(t,c)){if(s.has(r,c)){if(r[c]!==t[c]){a(c,"M")}}else{a(c,"R")}}else{a(c,"A")}}t=r}};a.prototype.enableTracing.pure=true;a.prototype.enableTracing.spam=true;function o(e,t,r){r=r||"top";t(e,r);if(e instanceof Array){for(var i in e){o(e[i],t,r+"["+i+"]")}}else if(e instanceof Object){for(var s in e){o(e[s],t,r+"."+s)}}}function l(e,t){var r={};function i(e,t){r[t]=e}o(e,i,t);return r}function c(e){var t=new n.EventEmitter,r=[];s.forEach(s.functions(e),function(t){var r=e[t];if(r.__bindData__){r=r.__bindData__[0]}e[t]=i(r,t)});function i(i,s){return function n(){var n={fn:i,fname:s,localstack:r,arguments:arguments};t.emit("call",n);r.push(s);try{n.result=i.apply(e,arguments)}catch(a){n.err=a}r.pop();t.emit("called",n);if(n.err){throw n.err}else{return n.result}}}return t}function u(e,t){if(!t||t<=0){return"===== "+e}else{var r="-----";for(var i=0;i<t;i++){r=r+"  "}return r+" "+e}}t.exports=a},{assert:127,events:128}],92:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("uuid"),a=e("./aggregates/planner"),o=e("./build/adp"),l=e("./build/storage-pools"),c=e("./build/flash-pool-assignment"),u=e("./build/trace"),p=e("./map"),d=e("./util"),f=e("../constants"),h=e("../units");function m(e,t){i(typeof e==="object","productInfo not object");i(s.isPlainObject(t),"clip");this._productInfo=e;this.clip=t;s.bindAll(this)}s.assign(m.prototype,o.prototype);s.assign(m.prototype,l.prototype);s.assign(m.prototype,c.prototype);s.assign(m.prototype,u.prototype);m.prototype.addSystem=function y(e){i(s.isPlainObject(e),"addSystem: spec object");var t=this.buildSystem(e);t._policies={spare_allocation:{enforce:f.POLICIES.SPARES.DEFAULT},version:{pin:true}};this.clip.synergy_model.hagroups.push(t);this._applyADPAndAddAggregates(t);return t};m.prototype.addSystemToCluster=function v(e,t){i(s.isPlainObject(e),"addSystemToCluster: spec object");var r=true,a=true,o=this.buildSystem(e,r),l=this._getMaxAutoNamedCluster(),c=l>0?"cluster"+(l+1):"cluster1";s.forEach(this.clip.synergy_model.hagroups,function u(e){if(!s.isEmpty(e.cluster)&&e.cluster._id===t){c=e.cluster.name||c;if(e._policies&&e._policies.version){a=e._policies.version.pin}}});o.cluster={_id:t||n(),name:c};o._policies={spare_allocation:{enforce:f.POLICIES.SPARES.DEFAULT},version:{pin:a}};this.clip.synergy_model.hagroups.push(o);this.setClusterVersion(o.cluster._id,o.version);this._applyADPAndAddAggregates(o);return o};m.prototype.changeSystems=function _(e){i(Array.isArray(e),"specs array");s.forEach(e,function t(e){var t=this._getSystemByIdFromClip(e.existingId);t.model=e.platformModel;t._model=e.configModel;t.version=e.version;t.shelves=s.isEmpty(e.shelves)?[]:this.buildShelves(t,e.shelves);if(e.controllerCount<t.controllers.length){t.controllers.splice(t.controllers.length-1,1)}else if(e.controllerCount>t.controllers.length){var r=this._getMaxAutoNamedSystemCount(this.clip.synergy_model.hagroups),i=this.buildControllers(1,r+1,"netapp");t.controllers.push(i[0])}if(!s.isEmpty(t.cluster)&&t.cluster._id){this.setClusterVersion(t.cluster._id,t.version)}if(!t.model){var n=this._productInfo.getConfig(t)||{},a=n.platformModel;t.model=a}this._applyADPAndAddAggregates(t)},this)};m.prototype.removeSystem=function E(e){i(typeof e==="string");var t=s.findIndex(this.clip.synergy_model.hagroups,{_id:e});if(t>-1){this.clip.synergy_model.hagroups.splice(t,1)}};m.prototype.deleteShelf=function b(e,t){i(typeof e==="string","systemId string");i(typeof t==="object","unspecified shelf");var r=this._getSystemByIdFromClip(e),n=s.findIndex(r.shelves,function(e){var r=e._isembedded===t._isembedded?true:false;return r&&d.shelfDriveComboEquals(e,t)});if(n>-1){r.shelves.splice(n,1);this._applyADPAndAddAggregates(r)}};m.prototype.deleteAllShelves=function w(e,t){i(typeof e==="string","unspecified systemId string");i(typeof t==="object","unspecified shelf");var r=this._getSystemByIdFromClip(e);s.remove(r.shelves,function(e){var r=e._isembedded===t._isembedded?true:false;return r&&d.shelfDriveComboEquals(e,t)});this._applyADPAndAddAggregates(r)};m.prototype.buildAutoAggregates=function S(e){i(typeof e==="string","unspecified systemId string");var t=this._getSystemByIdFromClip(e);this._buildAggregates(t,false,false)};m.prototype.rebuildAutoAggregates=function A(e,t){i(typeof e==="string","unspecified systemId string");this.deleteAutoAggregates(e,t);this.buildAutoAggregates(e)};m.prototype.deleteAggregate=function C(e,t){i(typeof e==="string","unspecified systemId string");i(typeof t==="object","unspecified aggregate");var r=this._makeNewMap().inspect(t);i.equal(r.hagroup._id,e,"d90aafb1");s(r.hagroup.controllers).map("storage_pools").flatten().map("_allocations").flatten().where({aggr_id:t._id}).forEach(g);var n=s.findIndex(r.controller.aggregates,{_id:t._id});r.controller.aggregates.splice(n,1)};function g(e){delete e.aggr_id}m.prototype.deleteAllAggregates=function T(e){i(typeof e==="string","unspecified systemId string");var t=this._getSystemByIdFromClip(e);t.controllers.forEach(function r(e){e.aggregates=[]})};m.prototype.deleteAutoAggregates=function R(e,t){t=t||{};t.except=t.except||a;i.equal(typeof e,"string","32a48274");i.equal(typeof t.except,"function","2332948b");var r=this._getSystemByIdFromClip(e);r.controllers.forEach(function o(e){e.aggregates=s.filter(e.aggregates,n)});function n(e){var r=e._manual||t.except(e);return r}function a(){return false}};m.prototype.nameSystem=function P(e,t,r){i(typeof e==="string","unspecified systemId string");var s=this._getSystemByIdFromClip(e);if(s){if(s.controllers&&s.controllers.length){s.controllers[0].name=t}if(s.controllers&&s.controllers.length>1){s.controllers[1].name=r}}};m.prototype.nameCluster=function N(e,t){i(typeof e==="string","unspecified clusterId string");i(typeof t==="string","unspecified name string");s.forEach(this.clip.synergy_model.hagroups,function(r){if(r.cluster&&r.cluster._id===e){r.cluster.name=t}})};m.prototype.setSystemPolicy=function D(e,t,r){i(typeof e==="string","unspecified systemId string");i(typeof t==="string","unspecified scope string");var n=s.find(this.clip.synergy_model.hagroups,{_id:e});if(n){n._policies=n._policies||{};n._policies[t]=n._policies[t]||{};s.merge(n._policies[t],r);this._applyADPAndAddAggregates(n)}};m.prototype.setClusterPolicy=function x(e,t,r){i(typeof e==="string","unspecified clusterId string");i(typeof t==="string","unspecified scope string");s.forEach(this.clip.synergy_model.hagroups,function n(i){if(!s.isEmpty(i.cluster)&&i.cluster._id===e){i._policies=i._policies||{};i._policies[t]=i._policies[t]||{};s.merge(i._policies[t],r);this._applyADPAndAddAggregates(i)}},this)};m.prototype.buildSystem=function k(e,t){i(s.isPlainObject(e),"buildSystem: spec object");var r=this._getMaxAutoNamedSystemCount(this.clip.synergy_model.hagroups),a=this.buildControllers(e.controllerCount,r+1,"netapp");var o={_id:n(),_type:"hagroup",_model:e.configModel,_x_bom:undefined,is_clustered:t||false,model:e.platformModel,sys_version:undefined,cluster:undefined,controllers:a,version:e.version};if(!o.model){var l=this._productInfo.getConfig(o)||{},c=l.platformModel;o.model=c}o.shelves=s.isEmpty(e.shelves)?[]:this.buildShelves(o,e.shelves);this.checkCompatibility(o);return o};m.prototype.checkCompatibility=function O(e){var t=this._productInfo.getConfig(e),r=t.matrix.isCompatibleWithVersion(e.version);i(r,"unknown version "+e.version)};m.prototype.determineDriveFlashPoolSupport=function I(e,t,r){var i=this._productInfo.getConfig(e),s=i.matrix,n=s.checkVersionShelfDrive(e.version,t,r);return n.fp_support_drive};m.prototype.buildControllers=function M(e,t,r){e=e||2;t=t&&t>-1?t:1;r=r||"netapp";return s.map(s.range(e),function(e){return{_id:n(),_type:"controller",aggregates:undefined,name:r+(e+t)}})};m.prototype.buildShelves=function F(e,t,r){i(t instanceof Array,"buildShelves: shelvesSpec array");i(!s.isEmpty(t),"buildShelves: shelvesSpec empty");var a=[],o=r||1;s(t).forEach(function l(t){var r=s.find(this._productInfo._shelves,{model:t.model});if(!r){console.log("Warning: could not find shelf configuration for "+t.model);return}for(var i=0;i<(t.quantity||1);i++){var l=n(),c=s.isEmpty(t.drives)?undefined:this.buildDrives(e,l,t.drives,t.model);a.push({_id:l,_type:"shelf",_x_bom:c,_description:undefined,model:t.model,serial_number:undefined,bay_count:r.stats.max_drive,type:undefined,_isembedded:t.isEmbedded||false,shelf_number:o++})}},this);return a};m.prototype.buildDrives=function q(e,t,r,n){i(r instanceof Array,"buildDrives: withSpecs array");i(!s.isEmpty(r),"buildDrives: withSpecs empty");var a={drive_specs:[],drive_spec_members:[]},o=this.buildSpecsAndMembers(e,t,r,n);s.forEach(o,function(e){a.drive_specs.push(e[0]);a.drive_spec_members.push(e[1])});return a};m.prototype.buildSpecsAndMembers=function L(e,t,r,i){var n=[],a=0,o=this;s.forEach(r,function(r){var l=o.determineDriveFlashPoolSupport(e,i,r.model),c=s.find(o._productInfo._drives,{model:r.model}),u=c?new h(c.capacity.right_sized,"KiB"):{},p=[],d={model:r.model,rawgb:c.capacity.marketing,rsgb:u.value_gb,rpm:c.speed,type:c.type,encrypted:c.encrypted,fp_support:l,quantity:r.quantity};s.forEach(s.range(r.quantity),function(){var e=o._getDeviceIdForDrive(t,a++);p.push(e)});n.push([d,p])});return n};m.prototype.setClusterVersion=function j(e,t){s.forEach(this.clip.synergy_model.hagroups,function r(i){if(!s.isEmpty(i.cluster)&&i.cluster._id===e){i.version=t}})};m.prototype.setSystemVersion=function B(e,t){var r=s.find(this.clip.synergy_model.hagroups,{_id:e});if(r){r.version=t}};m.prototype._getDeviceIdForDrive=function X(e,t){i(e.length>8,"Shelf Id is invalid");i(s.isNumber(t),"Carrier slot must be a number");return"!"+e.slice(0,8)+"."+t};m.prototype._getDeviceIdForDrive.pure=true;m.prototype._getDeviceIdForDrive.spam=true;m.prototype._getSystemByIdFromClip=function G(e){return s.find(this.clip.synergy_model.hagroups,{_id:e})};m.prototype._getMaxAutoNamedCluster=function U(){var e=s(this.clip.synergy_model.hagroups).map(function(e){return e.cluster&&/^cluster(\d+)$/.exec(e.cluster.name)}).where(function(e){return e}).map(function(e){return parseInt(e[1])}).max().value();return e};m.prototype._getMaxAutoNamedSystemCount=function V(e){i(e,"_getMaxAutoNamedSystemCount hagroups list not defined");i(Array.isArray(e),"_getMaxAutoNamedSystemCount hagroups list not an array");var t=s(e).map(function(e){return e._x_bom&&e._x_bom.system&&e._x_bom.system.names}).where(function(e){return e}).map(function(e){return e.split("/")}).flatten().map(function(e){return/^netapp(\d+)$/.exec(e)}).where(function(e){return e}).map(function(e){return parseInt(e[1])}).max().value();var r=s(e).flatten("controllers").flatten("name").map(function(e){return/^netapp(\d+)$/.exec(e)}).where(function(e){return e}).map(function(e){return parseInt(e[1])}).max().value();return Math.max(t,r)};m.prototype._makeNewMap=function H(){return new p(this._productInfo,this.clip)};m.prototype._isPureEmbeddedSystem=function Y(e){var t=e.shelves&&e.shelves.length===1,r=t&&s.first(e.shelves)._isembedded;return r};m.prototype._buildAggregates=function z(e){var t=this._makeNewMap(),r=a(t.inspect(e));if(r&&r.length){this.attachAggregatesToControllers(this.clip.synergy_model.hagroups,r)}this.assignFlashPoolWhereAvailable(e)};m.prototype.addManualAggregate=function W(e,t){if(t){this.deleteAutoAggregates(e);this.attachAggregatesToControllers(this.clip.synergy_model.hagroups,[t]);this.buildAutoAggregates(e)}return t};m.prototype.attachAggregatesToControllers=function(e,t){if(t&&t.length>0){if(t[0]instanceof Array){t=s.flatten(t)}}if(e){s.forEach(e,function(e){var r=e.controllers;if(r){s.forEach(r,function(e){if(!e.aggregates){e.aggregates=[]}e.aggregates=r(e.aggregates);e.aggregates.push(s.where(t,function(t){return t._controller===e._id}));e.aggregates=s.flatten(e.aggregates);function r(e){return s.where(e,function(e){return!s.contains(s.map(t,"_id"),e._id)})}})}})}};t.exports=m},{"../constants":65,"../units":123,"./aggregates/planner":79,"./build/adp":88,"./build/flash-pool-assignment":89,"./build/storage-pools":90,"./build/trace":91,"./map":102,"./util":104,assert:127,uuid:183}],93:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("./aggregates/aggregateReporter.js"),a=e("./spec"),o=e("./util"),l=e("../lcprop"),c=e("../policies"),u=e("../units.js");function p(e,t,r){i.equal(typeof e,"object","map object");i.equal(typeof t,"object","addingTo object");i.equal(s.isEmpty(t),false,"bad addingTo selector");i(r===undefined||s.isPlainObject(r),"bad options");this._map=e;this._addingTo=t;this._addingToHagroups=t.id?[]:this._getHagroups(e.resolveSelection(t));this._impactedHagroups=this._getImpactedHagroups(t);this._options=r||{};this._proposals=[];s.bindAll(this)}p.prototype.addingSystem=function d(e){i(e===undefined||typeof e==="object","bad replacing selector");var t=this._resolveReplacing(e),r=this._getHagroups(t);var n=this._addingToHagroups.concat(r),a=this._addingTo.id?[this._addingTo]:this._getUniqueConfigGroups(n),o=s.first(a);i(a.length,"no config group");i.equal(a.length,1,"multiple config groups");var l=this._addingTo.id?null:this._map.inspect(s.first(n)),c=l?l.nodeSummary(t):{},u=l?l.versionRange(t):undefined;this._buildSystemOptions(o,u);this._applyAggregateLimits(t);this._applyConfigLimits(o);this._applyClusterLimits(c,u);this._applyHagroupLimits(t);this._applyHardwareLimits(r);return this._proposals};p.prototype.deletingSystem=function f(e){i(typeof e==="object","bad replacing selector");var t=this._resolveReplacing(e),r=this._getHagroups(t);i(r.length,"no hagroup");var n=this._map,a=this._addingToHagroups,o=s.reduce(r,u,r),l=p(o),c=d(l);function u(e,t){return e.concat(t.shelves)}function p(e){var t=s.where(e,{_type:"hagroup"});return s.filter(a,r);function r(e){return!s.some(t,{_id:e._id})}}function d(e){return s.reduce(e,t,undefined);function t(e,t){var r=n.inspect(t),i=r.versionRange(o);return e?s.intersection(e,i):i}}this._buildVersionOptions(c);this._applyVersionChangeLimits(l);var f=s(this._proposals).sortBy("newVersion"),h=this._options.version,m;if(h){m=f.where({newVersion:h}).last()}else{var g=f.where(function y(e){return s.isEmpty(e.conflicts)});m=g.isEmpty()?f.last():g.last()}return[m]};p.prototype.addingShelf=function h(e){i(e===undefined||typeof e==="object","bad replacing selector");i(this._addingToHagroups.length,"no hagroup");var t=s.first(this._addingToHagroups),r=this._map.inspect(t);var n=this._resolveReplacing(e),a=r.nodeSummary(n),o=r.versionRange(n);this._buildShelfOptions(r,o,n.length);this._applyAggregateLimits(n);this._applyClusterLimits(a,o);this._applyHagroupLimits(n);this._applyEmbeddedLimits(n);return this._proposals};p.prototype.deletingShelf=function m(e){i(typeof e==="object","bad replacing selector");i(this._addingToHagroups.length,"no hagroup");var t=this._resolveReplacing(e),r=this._getHagroups(t),n=this._addingToHagroups.concat(r);var a=s.first(n),o=this._map.inspect(a),l=s.where(t,{_type:"shelf",_isembedded:false}),c=o.versionRange(l);this._buildVersionOptions(c);this._applyVersionChangeLimits(n);var u=s(this._proposals).sortBy("newVersion"),p=this._options.version,d;if(p){d=u.where({newVersion:p}).last()}else{var f=u.where(function v(e){return s.isEmpty(e.conflicts)});d=f.isEmpty()?u.last():f.last()}var h=this._map,m=s.where(t,{_type:"shelf"}),g=s.some(m,y);function y(e){return h.inspect(e).isUsedByManualAggregate()}if(g){this._disable(d,"aggr.manual",true,false)}return[d]};p.prototype.policies=function g(){i(this._addingToHagroups.length,"no hagroup");var e=s.first(this._addingToHagroups),t=this._map.inspect(e);this._buildPolicyOptions();this._applyPolicyLimits(t.productLine);return this._proposals};p.prototype.changingVersion=function y(e){i(typeof e==="object","bad replacing selector");var t=this._resolveReplacing(e),r=this._getHagroups(t),n=this._addingToHagroups.concat(r);i(n.length,"no hagroup");var a=s.first(n),o=this._map.inspect(a),l=o.versionRange();this._buildVersionOptions(l);this._applyVersionChangeLimits(n);return s.sortBy(this._proposals,"newVersion")};p.prototype._buildSystemOptions=function v(e,t){this._proposals=s.map(e.where({}),r,this);function r(r){var i=this._map,n=s.clone(r),o=n.matrix.versions,c=t?s.intersection(o,t):o;var u=r.isEmbedded?this._getDefaultEmbeddedShelf(r,c):{},p=s.compact(s.pluck(u.versions,"version")),d=this._getLatestVersion(o,t,p)||"",f=d?n.matrix.getLimitsForVersion(d):{};l(n,"buildSpec",function h(){return new a(i,n).build});l(n,"isEnabled",function m(){return s.isEmpty(n.conflicts)});return s.assign(n,{quantity:1,groupId:e.id,effects:{node:{},drive:{},shelf:{}},newVersion:d,newLimits:f,newEmbeddedShelf:u,conflicts:[]})}};p.prototype._buildShelfOptions=function _(e,t,r){var i=e.config.matrix,n=e.getShelfConfigs(),o=this._map;this._proposals=s.map(n,c,this);function c(e){var n=s.clone(e),c=s.compact(s.pluck(n.versions,"version")),u=this._getLatestVersion(c,t)||"",p=u?i.getLimitsForVersion(u):{};l(n,"buildSpec",function d(){return new a(o,n).build});l(n,"isEnabled",function f(){return s.isEmpty(n.conflicts)});return s.assign(n,{quantity:r||1,effects:{node:{},drive:{},shelf:{}},newVersion:u,newLimits:p,conflicts:[]})}};p.prototype._buildPolicyOptions=function E(){this._proposals=s.map(new c,e);function e(e){l(e,"isEnabled",function t(){return s.isEmpty(e.conflicts)});return s.assign(e,{conflicts:[]})}};p.prototype._buildVersionOptions=function b(e){this._proposals=s.map(e,t);function t(e){var t={newVersion:e,conflicts:[]};l(t,"isEnabled",function r(){return s.isEmpty(t.conflicts)});return t}};p.prototype._resolveReplacing=function w(e){var t=this._map.resolveSelection(e),r=this._getHagroups(t);return s.reduce(r,function i(e,t){var r=s.where(t.shelves,{_type:"shelf",_isembedded:true});Array.prototype.push.apply(e,r);return e},t)};p.prototype._getImpactedHagroups=function S(e){var t;if(s.has(e,"cluster")){t=s.pick(e,["installation","cluster"])}else if(s.has(e,"hagroup")){t=s.pick(e,["installation","hagroup"])}var r=s.isEmpty(t)?[]:this._map.resolveSelection(t),i=this._getHagroups(r);return i};p.prototype._getHagroups=function A(e){var t=s.where(e,{_type:"cluster"}),r=s.reduce(t,i,s.where(e,{_type:"hagroup"}));function i(e,t){Array.prototype.push.apply(e,t.hagroups);return e}return r};p.prototype._getUniqueConfigGroups=function C(e){var t=s.reduce(e,r,[],this);function r(e,t){var r=this._map.inspect(t),i=r.configGroup,n=!s.some(e,{id:i.id});if(n){e.push(i)}return e}return t};p.prototype._getDefaultEmbeddedShelf=function T(e,t){var r=s.first(this._addingToHagroups)||{},i=s.where(r.shelves||[],{_isembedded:false}),n=p();var a=u(e.matrix.hardwareOptions),o=s.filter(a,d),l=s.sortBy(o,h),c=s.find(l,g)||{};function u(e){var t=[];Array.prototype.push.apply(t,e.embeddedShelves);Array.prototype.push.apply(t,e.shelfPresets);return s.where(t,{isEmbedded:true})}function p(){var e;if(!s.isEmpty(i)){e=s.some(i,t)}function t(e){var t=e._x_bom?e._x_bom.drive_specs||[]:[];return s.some(t,r)}function r(e){return e.encrypted}return e}function d(e){if(n===undefined){return true}else{var t=s.some(e.drives,f);return t===n}}function f(e){return e.drive.encrypted}function h(e){var t=e.shelf.sellable,r=s.every(e.drives,m);return!(t&&r)}function m(e){return e.drive.sellable}function g(e){var r=s.compact(s.pluck(e.versions,"version")),i=t?s.intersection(r,t):r;return i.length?true:false}return c};p.prototype._getLatestVersion=function R(e,t,r){var i=this._options.version,n=i?s.intersection(e,[i]):e,a=s(n);var o=s.isEmpty(r)?t:l(t,r);function l(e,t){return e?s.intersection(e,t):t}return o?a.intersection(o).sort().last():a.sort().last()};p.prototype._applyAggregateLimits=function P(e){var t=this._map,r=s.where(e,{_type:"shelf"}),i=s.some(r,n);function n(e){return t.inspect(e).isUsedByManualAggregate()}if(i){s.forEach(this._proposals,function a(e){this._disable(e,"aggr.manual",true,false)},this)}};p.prototype._applyConfigLimits=function N(e){var t=e.parent?e.parent.id:e.id,r=this._sampleProductLine();if(r&&r!==t){s.forEach(this._proposals,function i(e){this._disable(e,"productLine",r,t)},this)}s.forEach(this._proposals,function n(t){this._enforceConfigLimit(t,e);this._enforceEmbeddedShelf(t)},this)};p.prototype._applyClusterLimits=function D(e,t){s.forEach(this._proposals,function r(i){this._enforceNodeLimit(i,e);this._enforceVersionLimit(i,t)},this)};p.prototype._applyHagroupLimits=function x(e){s.forEach(this._addingToHagroups,function t(r){if(!this._map.inspect(r).isESeries){s.forEach(this._proposals,function i(t){var i=this._getEncryptionLimit(t,r,e);this._enforceEncryptionLimit(t,i)},this)}},this);s.forEach(this._impactedHagroups,function r(t){var r=this._map.inspect(t),i=r.shelfDriveSummary(e);s.forEach(this._proposals,function n(e){var t=this._addEmbeddedCounts(i,e);this._enforceAggregateLimit(e,r);this._enforceCapacityLimit(e,t);this._enforceDriveLimit(e,t);this._enforceShelfLimit(e,t)},this)},this)};p.prototype._applyHardwareLimits=function k(e){s.forEach(this._proposals,t,this);function t(t){var n=r(t.matrix.hardwareOptions);s.forEach(e,s.partial(i,n,t),this)}function r(e){var t=[];Array.prototype.push.apply(t,e.shelves);Array.prototype.push.apply(t,e.shelfPresets);return s.where(t,{isEmbedded:false})}function i(e,t,r){var i=s.where(r.shelves,{_isembedded:false}),a=s.some(i,function o(t){return n(t,e)});if(a){this._disable(t,"hardware.shelf",true,false)}}function n(e,t){var r=o.chooseClosestShelfConfig(e,t);return r?false:true}};p.prototype._applyEmbeddedLimits=function O(e){s.forEach(this._proposals,t,this);function t(t){this._enforceEmbeddedLimit(t,e)}};p.prototype._applyPolicyLimits=function I(e){s.forEach(this._proposals,t,this);function t(t){if(!s.contains(t.productLines,e)){this._disable(t,"productLine",t.productLines,e)}}};p.prototype._applyVersionChangeLimits=function M(e){s.forEach(this._proposals,t,this);function t(t){s.forEach(e,s.partial(r,t),this)}function r(e,t){var r=this._map.inspect(t),i=r.shelfDriveSummary(),a=r.config.matrix.getLimitsForVersion(e.newVersion);if(a.capacity_gb&&i.capacity>a.capacity_gb){this._disable(e,"capacity_gb",a.capacity_gb,i.capacity)}s.forOwn(i.drive||{},function u(t,r){var i=a.drive[r]||0,s="drive."+r;if(t>i){this._disable(e,s,i,t)}},this);if(a.ext_shelves&&i.shelf.external>a.ext_shelves){this._disable(e,"ext_shelves",a.ext_shelves,i.shelf.external)}var o=new n(r),l=a.cache_no_flash||0,c=this._getTotalCacheCapacity(r,o);this._enforceFpSize(e,c,l);if(a.aggr){this._enforceAggrSize(e,r,o,a.aggr)}if(!r.isESeries){this._enforceEncryptionLimit(e,this._getEncryptionLimit(e,t))}}};p.prototype._addEmbeddedCounts=function F(e,t){var r=s.cloneDeep(e),i=t.newEmbeddedShelf,n=0,a={};if(!s.isEmpty(i)){s.forEach(i.drives,function l(e){var t=e.quantity,r=e.drive.type,i=e.drive.capacity.marketing||0;n+=i*t;a[r]=(a[r]||0)+t});var o=s.reduce(a,function c(e,t){return e+t},0);r.capacity+=n;r.shelf.total++;r.drive.total+=o;r.drive.fc+=a["FC"]||0;r.drive.sas+=(a["SAS"]||0)+(a["NL-SAS"]||0);r.drive.sata+=(a["SATA"]||0)+(a["MSATA"]||0);r.drive.ssd+=a["SSD"]||0}return r};p.prototype._enforceAggregateLimit=function q(e,t){var r=new n(t),i=e.newLimits;if(i){var s=i.cache_no_flash||0,a=this._getTotalCacheCapacity(t,r);this._enforceFpSize(e,a,s);if(i.aggr){this._enforceAggrSize(e,t,r,i.aggr)}}};p.prototype._enforceAggrSize=function L(e,t,r,i){var n=i.size_64_tb||0,a=i.min_fp_drives||0;s.forEach(t.hagroup.controllers,o,this);function o(e){var t=s.where(e.aggregates,{_manual:true,is_root_aggregate:false});s.forEach(t,l,this)}function l(i){var s=r.createAggregateReport(i,t.versionNumber),o=s.summary;var l=new u(n,"TB"),c=l.value_gb,p=o.usableCapacity,d=o.driveRoleSummary.cacheData;if(n&&p>c){this._disable(e,"aggr.size_64_tb",c,p)}if(a&&i.is_hybrid&&a>d){this._disable(e,"aggr.min_fp_drives",a,d)}}};p.prototype._enforceFpSize=function j(e,t,r){var i=new u(r,"TB"),s=i.value_gb;if(r&&t>s){this._disable(e,"cache_no_flash",s,t)}};p.prototype._getTotalCacheCapacity=function B(e,t){var r={_manual:true,is_root_aggregate:false,is_hybrid:true},i=s.reduce(e.hagroup.controllers,n,0);function n(e,t){var i=s.where(t.aggregates,r);return e+s.reduce(i,a,0)}function a(r,i){var s=t.createAggregateReport(i,e.versionNumber),n=s.summary;return r+n.cacheCapacity}return i};p.prototype._sampleProductLine=function X(){var e;s.forEach(this._map.installations,t);function t(t){if(t.hagroups.length){e=t.hagroups[0]}else if(t.clusters.length){s.forEach(t.clusters,r)}}function r(t){if(t.hagroups.length){e=t.hagroups[0]}}return e?this._map.inspect(e).productLine:""};p.prototype._getEncryptionLimit=function G(e,t,r){if(!s.isEmpty(e.newEmbeddedShelf)){return s.some(e.newEmbeddedShelf.drives,i)}function i(e){return e.drive.encrypted}var n=this._remainingShelves(t,r),a;if(!s.isEmpty(n)){a=s.some(n,o)}function o(e){var t=e._x_bom?e._x_bom.drive_specs||[]:[];return s.some(t,l)}function l(e){return e.encrypted}return a};p.prototype._remainingShelves=function U(e,t){var r=s.where(t,{_type:"shelf"});return s.filter(e.shelves||[],function i(e){return!s.some(r,{_id:e._id})})};p.prototype._enforceConfigLimit=function V(e,t){if(!t.enabled){this._disable(e,"enabled",true,false)}};p.prototype._enforceNodeLimit=function H(e,t){var r=t.limits?t.limits.nas:undefined,i=e.newLimits.nas_nodes||0,s=r===undefined?i:Math.min(r,i);var n=t.quantity||0,a=e.controllerCount||0,o=n+a;if(s&&o>s){this._disable(e,"nas_nodes",s,o)}else{e.effects.node.total=o;e.effects.node.limit=s}};p.prototype._enforceVersionLimit=function Y(e,t){var r;if(s.has(e,"matrix")){r=e.matrix.versions}else{r=s.compact(s.pluck(e.versions,"version"))}if(!e.newVersion){this._disable(e,"version",s.sortBy(t),s.sortBy(r))}else{var i=t?s(r).intersection(t).sort().value():s(r).sort().value();e.effects.versions=i}};p.prototype._enforceCapacityLimit=function z(e,t){var r=s.isEmpty(e.newLimits)?undefined:e.newLimits.capacity_gb;var i=s.reduce(e.drives,function n(t,r){var i=r.drive.capacity.marketing;return t+i*r.quantity*e.quantity},t.capacity);if(r&&i>r){this._disable(e,"capacity_gb",r,i)}else{e.effects.capacityGb=i}};p.prototype._enforceDriveLimit=function W(e,t){var r=s.isEmpty(e.newLimits)?undefined:e.newLimits.drive,i={};if(r){s.forEach(e.drives||[],function a(t){var r=this._normalizeDriveType(t.drive.type);i[r]=(i[r]||0)+t.quantity*e.quantity},this);var n=s.reduce(i,function o(e,t){return e+t},0);i.total=n;s.forOwn(t.drive||{},function l(t,s){var n=(i[s]||0)+t,a=r[s]||0,o="drive."+s;if(n>a){this._disable(e,o,a,n)}else{e.effects.drive[s]=n}},this)}};p.prototype._normalizeDriveType=function J(e){switch(e){case"SATA":return"sata";case"FC":return"fc";case"SAS":return"sas";case"SSD":return"ssd";case"MSATA":return"sata";case"NL-SAS":return"sas";default:return undefined}};p.prototype._enforceShelfLimit=function Q(e,t){var r=s.isEmpty(e.newLimits)?undefined:e.newLimits.ext_shelves,i=s.has(e,"matrix"),n=i||e.isEmbedded?0:e.quantity,a=t.shelf.external+n;if(r&&a>r){this._disable(e,"ext_shelves",r,a)}else{var o=i&&!e.isEmbedded?a:a+1;e.effects.shelf.total=o;e.effects.shelf.external=a}};p.prototype._enforceEncryptionLimit=function Z(e,t){var r=s.some(e.drives,i);function i(e){return e.drive.encrypted}if(t!==undefined&&!s.isEmpty(e.drives)&&r!==t){this._disable(e,"drive.nse",t,r)}};p.prototype._enforceEmbeddedLimit=function K(e,t){var r=s.where(t,{_type:"shelf"});if(s.isEmpty(r)){if(e.isEmbedded){this._disable(e,"embedded",false,true)}}else{s.forEach(r,function i(t){if(t._isembedded!==e.isEmbedded){this._disable(e,"embedded",t._isembedded,e.isEmbedded)}},this)}};p.prototype._enforceEmbeddedShelf=function $(e){if(e.isEmbedded&&s.isEmpty(e.newEmbeddedShelf)){this._disable(e,"embeddedShelf",true,false)}};p.prototype._disable=function et(e,t,r,i){e.conflicts.push({attribute:t,limit:r,proposal:i})};t.exports=p},{"../lcprop":72,"../policies":106,"../units.js":123,"./aggregates/aggregateReporter.js":76,"./spec":103,"./util":104,assert:127}],94:[function(e,t,r){"use strict";var i=window._;var s=[a];function n(e){e(this);for(var t in s){var r=s[t];Object.defineProperty(this,r.name,{get:i.bind(r,this)})}}function a(){return i(this.aggregate._raid_groups||[]).map("_devices").flatten().value()}t.exports=n},{}],95:[function(e,t,r){"use strict";var i=window._;function s(e){e(this)}s.prototype.nodeSummary=function n(e){var t=0,r,s,n=this.inspect;i.forEach(this._remainingHagroups(e),function a(e){var i=n(e),a=i.limits.nas_nodes,o=i.limits.san_nodes;t+=e.controllers.length||0;r=r===undefined?a:Math.min(r,a);s=s===undefined?o:Math.min(s,o)},this);return{quantity:t,limits:{nas:r||undefined,san:s||undefined}}};s.prototype.versionRange=function a(e){var t=this.inspect;
return i.reduce(this.cluster.hagroups||[],function r(s,n){var a=t(n),o=a.shelfVersionRange(e);var l=i.some(e,{_type:"hagroup",_id:n._id}),c;if(l){c=o?o:s}else{var u=a.config.matrix.versions;c=o?i.intersection(u,o):u}return s?i.intersection(s,c):c},undefined,this)};s.prototype._remainingHagroups=function o(e){var t=i.where(e,{_type:"hagroup"});return i.filter(this.cluster.hagroups||[],function r(e){return!i.some(t,{_id:e._id})})};t.exports=s},{}],96:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("../../units.js");function a(e){e(this)}a.prototype.devicesConsumedByAggregates=function c(e){var t=i(this.controller.aggregates||[]).filter(e?l:null).map("_raid_groups").flatten().map(o).flatten().value();return t};function o(e){if(e===undefined){return[]}else{return e._devices||[]}}function l(e){return e._manual||e.is_root_aggregate}a.prototype.storagePoolDevices=function u(){var e=[],t=this;if(this.controller.storage_pools){s(i.isArray(this.controller.storage_pools),"Controller storage pools must be an array");i.forEach(this.controller.storage_pools,function(r){var s=r.__deviceSpecs?i.first(r.__deviceSpecs).spec:undefined;e.push({devices:r._devices,spec:s,storagePoolId:r._id,isPhysical:true});i.forEach(r._allocations,function(s){var n=s.__deviceSpecs?i.first(s.__deviceSpecs).spec:undefined,a=t._waflBlocksToGb(s.used_blocks);e.push({devices:s.devices,spec:n,storagePoolId:r._id,isPhysical:false,sliceName:s.slice,rsGBPerDevice:a})})})}return e};a.prototype.assignedStorageSlices=function(){var e=[],t=this;if(this.controller._assigned_storage){i.forEach(this.controller._assigned_storage,function(r){if(!r.slice_details.devices){return}var i=r.slice_details,s=t._waflBlocksToGb(i.used_blocks);e.push({owningControllerId:t.controller._id,sliceName:i.slice,waflBlocksPerDevice:i.used_blocks,rsGBPerDevice:s,devices:i.devices})})}return e};a.prototype._waflBlocksToGb=function(e){var t=new n(4,"KiB").mult(e);return t.value_gb};t.exports=a},{"../../units.js":123,assert:127}],97:[function(e,t,r){"use strict";var i=window._,s=e("assert");function n(e,t){s(t instanceof Array,"87f630a3");s(i.has(e,"inspect"),"e6f2781d");this._selectedHaGroups=t;this.inspect=e.inspect}n.prototype._initSummary=function(){this.summary={completeStatsAvailable:true,power_spec:{v_100:{typical:{amps:0,watts:0,BTU:0},worst:{amps:0,watts:0,BTU:0}},v_200:{typical:{amps:0,watts:0,BTU:0},worst:{amps:0,watts:0,BTU:0}}},rack_units:0,max_psu:0,weight_g:0}};n.prototype.create=function(){var e=this;this._initSummary();i.forEach(e._selectedHaGroups,function(t){var r=e.inspect(t);s(r);i.forEach(t.controllers,function(){e._addController(t)});i.forEach(t.shelves,function(t){e._addShelf(t)})});return this.summary};n.prototype._addPartPowerSpec=function(e){var t=this.inspect(e),r=t.config||t.config(),i=r.stats.power_spec||r.stats.power.power_spec;this._addPowerSpecsToSummary(i)};n.prototype._addController=function(e){var t=this.inspect(e),r=t.config.stats,i=r.power.power_spec;if(!t.config.isEmbedded){this._addSpecsToSummary(r.rack_units,r.max_psu,r.weight.weight_g);this._addPowerSpecsToSummary(i)}};n.prototype._addShelf=function(e){var t=this.inspect(e),r=t.config(true),i=r.shelf.stats;var s=r.power_spec;this._addSpecsToSummary(i.rack_units,i.max_psu,r.weight_g);this._addPowerSpecsToSummary(s)};n.prototype._addSpecsToSummary=function(e,t,r){this._updateCompleteStatsAvailable(e&&t&&r);this.summary.rack_units+=e;this.summary.max_psu+=t;this.summary.weight_g+=r};n.prototype._addPowerSpecsToSummary=function(e){this._updateCompleteStatsAvailable(e&&e.v_100&&e.v_200);this.summary.power_spec=this._addPowerSpecs(this.summary.power_spec,e)};n.prototype._updateCompleteStatsAvailable=function(e){this.summary.completeStatsAvailable=this.summary.completeStatsAvailable&&e};n.prototype._addPowerSpecs=function(e,t){return{v_100:e.v_100&&t.v_100?this._addPowerSpecVoltages(e.v_100,t.v_100):e.v_100||t.v_100,v_200:e.v_200&&t.v_200?this._addPowerSpecVoltages(e.v_200,t.v_200):e.v_200||t.v_200}};n.prototype._addPowerSpecVoltages=function(e,t){return{typical:this._addPowerSpecCase(e.typical,t.typical),worst:this._addPowerSpecCase(e.worst,t.worst)}};n.prototype._addPowerSpecCase=function(e,t){return{amps:e.amps+t.amps,watts:e.watts+t.watts,BTU:e.BTU+t.BTU}};n.prototype._nullToZero=function(e){if(e===undefined||e===null){return 0}else{return e}};n.prototype.weightGtoKg=function(e){return e/1e3};n.prototype.weightGtoLbs=function(e){return e*2.20462262185/1e3};n.prototype.powerWattsToVoltAmps=function(e){var t=.95;return e/t};n.prototype.powerWattsToKWhPerYear=function(e){return 8.76581277*e};t.exports=n},{assert:127}],98:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("../util"),a=e("../../lcprop"),o=e("../../clip/device-info"),l=e("../../add-query-api"),c=e("./lookup");function u(e){e(this);var t=this.info,r=this.hagroup;i.notEqual(t,undefined,"a4bc15c3");i.notEqual(r,undefined,"4b3aa363");a(this,"config",function n(){return t.getConfig(r)});a(this,"configGroup",function o(){return t.determineConfigGroup(r)});a(this,"productLine",function l(){var e=this.configGroup,t=e.parent;return t?t.id:e.id});a(this,"limits",function u(){return this.config.matrix.getLimitsForVersion(r.version)});a(this,"isESeries",function p(){if(!this.config||!this.config.platformModel){return false}return this.config.platformModel.toUpperCase().indexOf("E")===0});a(this,"isFlashRay",function d(){if(!this.config.platformModel){return false}return this.config.platformModel.toUpperCase().indexOf("RAY")===0});a(this,"versionNumber",function h(){var e=this.hagroup.version,t=this.hagroup.version.indexOf(" "),r=t?e:e.substring(0,t);return r});a(this,"embeddedShelf",s.partial(f,r));a(this,"controllers",this._get_controllers);a(this,"aggregates",this._get_aggregates);a(this,"deviceInfo",this._get_deviceInfo);a(this,"fpStatusByDriveModel",function(){var e=this.config.matrix,t={},i=s.last(this.config.matrix.versions);s.forEach(r.shelves,function(r){s.forEach(r._x_bom.drive_specs,function(s){t[s.model]=e.checkVersionShelfDrive(i,r.model,s.model).fp_support_drive})});return t});a(this,"lookup",function(){return new c(this)})}var p={manual:{_manual:true}},d={};u.prototype._get_controllers=function h(){return l(this.hagroup.controllers,d)};u.prototype._get_deviceInfo=function(){return o.from.hagroup(this.hagroup)};u.prototype._get_aggregates=function m(){var e=this.controllers.map("aggregates").filter();return l(s.flatten(e),p)};u.prototype.latestDeviceInfo=function(){return this._get_deviceInfo()};u.prototype.availableDevices=function g(){return this.transformDriveInfoSequence(this.latestDeviceInfo().where.unused)};u.prototype.availablePhysicalDevices=function y(){return this.transformDriveInfoSequence(this.latestDeviceInfo().where.physical.and.unused)};u.prototype.availableStoragePoolDevices=function v(){return this.transformDriveInfoSequence(this.latestDeviceInfo().where.storagepool.and.unused)};u.prototype.allDevices=function _(){return this.transformDriveInfoSequence(this.latestDeviceInfo())};u.prototype.allPhysicalDevices=function E(){return this.transformDriveInfoSequence(this.latestDeviceInfo().where.physical)};u.prototype.unlockedPhysicalDevices=function b(){return this.transformDriveInfoSequence(this.latestDeviceInfo().where.physical.and.unlocked)};u.prototype.transformDriveInfoSequence=function w(e){var t=null,r=null,i={},n={};for(var a in e){var o=e[a],l=o.spec,c=d(l);if(!s.has(i,c)){l.fp_support=this.fpStatusByDriveModel[l.model];i[c]=l;n[c]=[]}n[c].push(o.id)}var u=[];for(var p in i){u.push({spec:i[p],devices:n[p]})}return u;function d(e){if(e===t){return r}else{t=e;r=e.model;if(e.slice){r=r+"/"+e.slice+"="+e.rsgb}return r}}};u.prototype.storagePools=function S(){var e=s.flatten(s.map(this.hagroup.controllers,function(e){if(e.storage_pools){return e.storage_pools}return[]}));return e};u.prototype.nodeSummary=function A(e){if(this.hagroup.is_clustered){return this.inspect(this.cluster).nodeSummary(e)}else{var t=0,r,i;var n=s.some(e,{_type:"hagroup",_id:this.hagroup._id});if(!n){var a=this.limits.nas_nodes,o=this.limits.san_nodes;t+=this.hagroup.controllers.length||0;r=r===undefined?a:Math.min(r,a);i=i===undefined?o:Math.min(i,o)}return{quantity:t,limits:{nas:r||undefined,san:i||undefined}}}};u.prototype.shelfDriveSummary=function C(e){var t=0,r={},i=this._remainingShelves(e);s.forEach(i,function a(e){var i=e._x_bom?e._x_bom.drive_specs||[]:[],n=e._x_bom?e._x_bom.drive_spec_members||[]:[];s.forEach(i,function a(e,i){var s=n[i].length;t+=(e.rawgb||0)*s;r[e.type]=(r[e.type]||0)+s})});var n=s.reduce(r,function o(e,t){return e+t},0);return{capacity:t,shelf:{total:i.length,external:s.where(i,{_isembedded:false}).length},drive:{total:n,fc:r["FC"]||0,sas:(r["SAS"]||0)+(r["NL-SAS"]||0),sata:(r["SATA"]||0)+(r["MSATA"]||0),ssd:r["SSD"]||0}}};u.prototype.versionRange=function T(e){if(this.hagroup.is_clustered){return this.inspect(this.cluster).versionRange(e)}else{var t=this.shelfVersionRange(e),r=s.some(e,{_type:"hagroup",_id:this.hagroup._id});if(r){return t?t:undefined}else{var i=this.config.matrix.versions;return t?s.intersection(i,t):i}}};u.prototype.shelfVersionRange=function R(e){var t=this._impactedShelves(e),r=this.getShelfConfigs();return s.reduce(t||[],function i(e,t){var i=n.chooseClosestShelfConfig(t,r),a=i?s.pluck(i.versions,"version"):[];return e?s.intersection(e,a):a},undefined)};u.prototype.getShelfConfigs=function P(){var e=this.config.matrix.hardwareOptions,t=e.shelves,r=e.embeddedShelves,i=e.shelfPresets,s=[];Array.prototype.push.apply(s,t);Array.prototype.push.apply(s,r);Array.prototype.push.apply(s,i);return s};u.prototype._impactedShelves=function N(e){var t=s.where(e,{_type:"shelf"});return s.filter(this.hagroup.shelves||[],function r(e){return!s.some(t,{_id:e._id})})};u.prototype._remainingShelves=function D(e){var t=s.where(e,{_type:"shelf"});return s.filter(this.hagroup.shelves||[],function r(e){return!s.some(t,{_id:e._id})})};u.prototype.availableDeviceIdsForSpec=function x(e){var t=this.availableDevices(),r=s.where(t,{spec:e}),i=r.length>0?s.first(r).devices:null;return i};u.prototype.findSpecForDeviceId=function k(e){i(e,"Must provide deviceId to locate spec");var t=null,r=this._getShelfIdForGivenDeviceId(e);if(r){t=this._getDeviceSpecGivenShelfIdAndDeviceId(r,e)}return t};u.prototype._getShelfIdForGivenDeviceId=function O(e){i(e,"Must provide a deviceId to find shelfId");i(e.length>8,"Invalid deviceId");var t=e.slice(1,9),r=s.where(this.hagroup.shelves,function(e){return e._id.indexOf(t)===0});if(r.length){return s.first(r)._id}return null};u.prototype._getDeviceSpecGivenShelfIdAndDeviceId=function I(e,t){i(e,"Must provide a shelfId to resolve a device spec");i(t,"Must provide a deviceId to resolve a device spec");var r=this,n=s.first(s.where(r.hagroup.shelves,{_id:e})),a=this._findDeviceSpecIndexInShelfGivenDeviceId(n,t),o=n._x_bom.drive_specs[a];return o};u.prototype._findDeviceSpecIndexInShelfGivenDeviceId=function M(e,t){i(e,"Must provide a shelf to look for spec index");i(e._x_bom,"Shelf is missing _x_bom");i(t,"Must provide a deviceId to find device spec index");var r=e._x_bom.drive_spec_members,n=-1;for(var a=0;a<r.length;a++){if(s.contains(r[a],t)){n=a;break}}return n};function f(e){var t=s.where(e.shelves||[],{_isembedded:true});if(t.length){i.equal(t.length,1,">1 embedded shelf");return t[0]}else{return null}}t.exports=u},{"../../add-query-api":52,"../../clip/device-info":55,"../../lcprop":72,"../util":104,"./lookup":100,assert:127}],99:[function(e,t,r){"use strict";var i=e("assert"),s=window._;function n(e){e(this)}var a={cluster:e("./cluster"),hagroup:e("./hagroup"),shelf:e("./shelf"),controller:e("./controller"),aggregate:e("./aggregate"),storage_pool:n,raidgroup:n};var o={installation:["clusters","hagroups"],cluster:["hagroups"],hagroup:["controllers","shelves"],controller:["aggregates","storage_pools"],aggregate:["_raid_groups"]};function l(e,t){i(s.isArray(e),"37f76914");i(s.isObject(t),"cb89b509");this._installations=e;this._info=t;this._locs={};this.inspect=s.bind(this.inspect,this);this.find=s.bind(this.find,this);for(var r in a){this.find[r]=s.bind(l.prototype.find,this,r);this.inspect[r]=s.bind(l.prototype.inspect,this,r)}}l.prototype.inspectCluster=l.prototype.inspectHaGroup=l.prototype.inspectController=l.prototype.inspectShelf=l.prototype.inspect=function c(e,t){var r;if(arguments.length>=2){i.equal(typeof e,"string","inspector, missing _type");i.equal(typeof t,"string","inspector, missing _id");r=e}else{i.equal(s.isPlainObject(e),true,"inspector, part is not object");t=e._id;r=e._type}var n=this._find(r,t);if(!n.inspector){n.inspect=this.inspect;n.find=this.find;n.info=this._info;var o=a[r];n.inspector=new o(l)}return n.inspector;function l(e){s.forEach(n,function(t,r){Object.defineProperty(e,r,{get:s.constant(t)})})}};l.prototype.find=function u(e,t){var r=this._find(e,t);return r[e]};l.prototype._find=function p(e,t){i.equal(typeof e,"string","need _type");i.equal(typeof t,"string","need _id");i.equal(s.has(a,e),true,"invalid _type "+e);this._indexTo(e);var r=this._locs[e]||{},n=r[t];i.notEqual(n,undefined,e+" not found: "+t);return n};l.prototype._indexTo=function d(e){var t=this._locs;if(!s.has(t,e)){s.forEach(this._installations,r)}function r(e){i({},e)}function i(e,t){var r=t._type,a=s.clone(e);a[r]=t;n(t,a);if(s.has(o,r)){var l=o[r];s.forEach(l,c)}function c(e){var r=t[e];s.forEach(r,s.partial(i,a))}}function n(e,r){var i=e._type,n=e._id;if(!s.has(t,i)){t[i]={}}t[i][n]=r}};t.exports=l},{"./aggregate":94,"./cluster":95,"./controller":96,"./hagroup":98,"./shelf":101,assert:127}],100:[function(e,t,r){"use strict";var i=e("assert"),s=e("../aggregates/raid-limits"),n=new s,a=n._raidTypes,o=e("../aggregates/aggregate-types"),l=e("../../lcprop"),c=e("uuid"),u=e("../aggregates/aggregateLimitFinder"),p=e("../../prodinfo/tables/spares"),d=e("../util"),f=window._;i(a);function h(e){i(this instanceof h);this._hagi=e;this._limits=e.limits;this._version=e.hagroup.version;this._versionNumber=e.versionNumber;this._isFAS=m(e);this._ALF=new u(e);l(this,"possibleRaidTypes",this._get_possibleRaidTypes);l(this,"possibleAggrTypes",this._get_possibleAggrTypes);l(this,"minimumFPDevicesForAggregate",this._get_minFPDevicesFromLimits)}h.prototype._perfDeviceTypes=["SAS","FC_SAS","SSD","FC"];h.prototype._capacityDeviceTypes=["MSATA","SATA","NL_SAS"];h.prototype.isDeviceTypePerformance=function y(e){return f.contains(this._perfDeviceTypes,e)};h.prototype._get_minFPDevicesFromLimits=function(){return this._limits.aggr.min_fp_drives||0};h.prototype._get_possibleRaidTypes=function(){if(this._isFAS){return[a.RAID_DP,a.RAID_4]}else{return[a.DDP,a.RAID_0,a.RAID_1,a.RAID_3,a.RAID_5,a.RAID_6,a.RAID_10]}};h.prototype._get_possibleAggrTypes=function(){if(this._isFAS){return[o.AGGR_64_BIT,o.AGGR_32_BIT]}else{return[o.VOL_GROUP]}};h.prototype.minimalRootAggregateDriveCount=function(e,t){e=g(e);return n.minDrivesNeededForDedicatedRootAggregate(this._hagi,e,t)};h.prototype.raidLimits=function(e,t){e=g(e);return n.findLimits(this._hagi,t,e)};h.prototype.lowestOverheadRaidSize=function(e,t,r){e=g(e);return n.getEffectiveRaidSize(this._hagi,t,e,r,this._hagi.hagroup.policies)};h.prototype.defaultAggrProps=function(){return{_id:c(),_strategy:undefined,_type:"aggregate",_manual:false,_controller:undefined,name:"aggr"+c().slice(0,8),block_type:this.possibleAggrTypes[0],raid_type:this.possibleRaidTypes[0],cache_raid_type:this.possibleRaidTypes[0],is_hybrid:false,is_mirrored:false,is_root_aggregate:false,_snapreserve_proportion:0,_ddpreserve:0}};h.prototype.reserveRecommendationForDDP=function(e){return a._getDdpReserveRecommendation(e)};h.prototype.maxAggrDataDeviceCount=function v(e,t,r,i,s){return this._ALF.maxDataDevices(e,t,r,i,s)};h.prototype.maxAggrCacheDeviceCount=function _(e,t,r,i,s){return this._ALF.maxCacheDevices(e,t,r,i,s)};h.prototype.maxAggrDeviceCount=function E(e,t,r,i,s,n){e=g(e);return this._ALF.maximumDriveCountGiven(e,t,r,i,s,n)};h.prototype.minAggrDeviceCount=function(e){return a.getParityCountForRaidType(e)+1};h.prototype.expectedSpares=function(e){var t=this._hagi.hagroup.shelves.length===1,r=t&&this._hagi.config.isEmbedded,i={isEmbeddedShelfOnly:r};return p(f.merge({},i,e))};function m(e){var t=e.configGroup,r=e.configGroup.parent||{};return t.id==="FAS"||r.id==="FAS"}function g(e){return f.merge({},e,{type:d.rpmToEffectiveDriveType(e.rpm),_type_faked:true})}t.exports=h},{"../../lcprop":72,"../../prodinfo/tables/spares":111,"../aggregates/aggregate-types":74,"../aggregates/aggregateLimitFinder":75,"../aggregates/raid-limits":85,"../util":104,assert:127,uuid:183}],101:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("../util");function a(e){e(this)}a.prototype.isUsedByManualAggregate=function o(){var e="!"+this.shelf._id.slice(0,8)+".",t=i.some(this.hagroup.controllers,r);function r(e){return i.some(e.aggregates,s)}function s(e){return e._manual&&i.some(e._raid_groups,n)}function n(e){return i.some(e._devices,a)}function a(t){return t.indexOf(e)===0}return t};a.prototype.config=function l(e){var t=this.inspect(this.hagroup),r=t.getShelfConfigs();return e?n.chooseClosestShelfConfig(this.shelf,r):n.chooseMatchingShelfConfig(this.shelf,r)};a.prototype.devices=function c(){var e=[];if(this.shelf._x_bom){var t=this.shelf._x_bom;if(!t.drive_specs||!t.drive_spec_members){console.warn("SHELF IS MALFORMED -- CANNOT INSPECT");console.warn(t);return e}s(i.isArray(t.drive_specs),"Shelf bom drive specs must be an array");s(i.isArray(t.drive_spec_members),"Shelf bom drive spec members must be an array");s(t.drive_specs.length===t.drive_spec_members.length,"Shelf bom drive spec and members array must be the same length");for(var r=0;r<t.drive_specs.length;r++){var n=t.drive_specs[r];e.push({spec:i.omit(n,"model"),devices:t.drive_spec_members[r]})}}return e};t.exports=a},{"../util":104,assert:127}],102:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("./guard"),a=e("./inspect");function o(e,t){i(typeof e==="object","prodinfo not object");i(s.isPlainObject(t),"clip");this._prodinfo=e;s.bindAll(this);var r=this.installations=[{_id:"_PLACEHOLDER",_type:"installation",hagroups:[],clusters:[]}];s.forEach(t.synergy_model.hagroups,this._moveToInstallation);s.forEach(this.installations,this._moveClusteredToClusters);var n=new a(r,e);this.inspect=n.inspect;this.find=n.find}o.prototype._moveToInstallation=function c(e){var t=this.installations[0];t.hagroups.push(e)};o.prototype._moveClusteredToClusters=function u(e){var t={},r=[];function n(e){if(e.is_clustered||e.cluster){i(s.isPlainObject(e.cluster));var n=l(t,e.cluster._id,{_id:e.cluster._id,_type:"cluster",name:e.cluster.name,hagroups:[]});n.hagroups.push(e)}else{r.push(e)}}s.forEach(e.hagroups,n);s.forEach(t,function(t){e.clusters.push(t)});e.hagroups=r};function l(e,t,r){if(s.has(e,t)){return e[t]}else{return e[t]=s.clone(r)}}o.prototype.guard=function p(e,t){return new n(this,e,t)};o.prototype.resolveSelection=function d(e){if(!e||s.isPlainObject(e)&&s.isEmpty(e)){return[]}i(s.isPlainObject(e),"resolveSelection: selector object");i(e.installation,"resolveSelection: selector installation");var t=this._where(this.installations,e.installation);return this.installations.length?this._searchInstallations(t,e):[]};o.prototype.rehydrate=function f(){s.forEach(this.installations,function e(t){this._rehydrateClustered(t.clusters);this._rehydrateNonClustered(t.hagroups)},this)};o.prototype._rehydrateClustered=function h(e){s.forEach(e,function t(e){s.forEach(e.hagroups,this._rehydrateAggregateMetaInfo)},this)};o.prototype._rehydrateNonClustered=function m(e){s.forEach(e,this._rehydrateAggregateMetaInfo)};o.prototype._rehydrateAggregateMetaInfo=function g(e){var t=this.inspect(e),r=t.allDevices(),i=this._createDeviceAndSpecMapping(r),n=this;s.forEach(e.controllers,a);function a(e){s.forEach(e.storage_pools,s.partial(o,e));e.storage_pools=n._withoutEjected(e.storage_pools);s.forEach(e.aggregates,s.partial(l,e));e.aggregates=n._withoutOrphanedAggregates(e.aggregates)}function o(t,r){n._populateDeviceSpecsForRaidGroup(e,r,i)}function l(t,r){r._controller=t._id;s.forEach(r._raid_groups,function(t){n._populateDeviceSpecsForRaidGroup(e,t,i)});r._raid_groups=n._withoutEjected(r._raid_groups)}};o.prototype._withoutOrphanedAggregates=function y(e){return s.where(e,function(e){var t=e._raid_groups&&e._raid_groups.length>0;if(!t){console.warn("aggregate "+e.name+" could no longer be satisfied, so we are ejecting it.")}return t})};o.prototype._withoutEjected=function v(e){return s.where(e,function(e){return!e.__eject})};o.prototype._populateDeviceSpecsForRaidGroup=function _(e,t,r){var i={};var n=s.every(t._devices,function(e){return s.has(r,e)}),a=t.__deviceSpecs&&s.every(t.__deviceSpecs,function(e){return e.spec&&e.count}),o=!a;if(!n){this._updateDeviceIdsAfterRebuild(e,t)}if(o){s.forEach(t._devices,function(e){var t=r[e];if(s.has(i,t)){i[t].push(e)}else{i[t]=[e]}});t.__deviceSpecs=s.map(s.keys(i),function(e){return{spec:r.specs[e],count:i[e].length}})}};o.prototype._updateDeviceIdsAfterRebuild=function E(e,t){var r=this.inspect(e),i=r.availableDevices(),n=this._createDeviceAndSpecMapping(i),a=s.uniq(s.map(s.keys(n),function(e){return n[e]})),o=this;if(i.length>0&&a.length>0&&t.__deviceSpecs){var l=s.map(t.__deviceSpecs,function(e){return{count:e.count,hash:o._createDeviceSpecHash(e.spec)}});s.forEach(l,function(e){var r=s.where(s.keys(n),function(t){return n[t]===e.hash});if(r.length>=e.count){var i=r.splice(0,e.count);t._devices=i;c(i)}else{console.warn("Cannot update raid group deviceIds, as there are no longer enough devices to satisfiy it. Ejecting the Rg.: ",t);t.__eject=true}})}else{console.warn("Could not rehydrate rg, likely invalid number of drives / devices different. Ejecting the Rg: ",t);t.__eject=true}function c(e){s.forEach(e,u)}function u(e){delete n[e]}};o.prototype._createDeviceAndSpecMapping=function b(e){var t=this,r={specs:{}};s.forEach(e,function(e){var i=t._createDeviceSpecHash(e.spec);r.specs[i]=e.spec;s.forEach(e.devices,function(e){r[e]=i})});return r};o.prototype._createDeviceSpecHash=function w(e){var t=s.sortBy(s.keys(s.omit(e,"quantity","_slice_name","slice","model"))),r=s.map(t,function(t){var r=e[t],i=r===undefined||r===null?"_":r.toString();return t+"-"+i.replace(".","_")}).join("-");return r};o.prototype._searchInstallations=function S(e,t){i.equal(e.length,1,"resolveSelection: installation scope too wide");var r=s.omit(t,"installation");if(r.cluster){var n=this._where(e[0].clusters,r.cluster);return s.isEmpty(n)?[]:this._searchClusters(n,r)}else if(r.hagroup){return this._searchHagroups(e[0].hagroups,r)}else{return e}};o.prototype._searchClusters=function A(e,t){var r=s.omit(t,"cluster");if(r.hagroup){i.equal(e.length,1,"resolveSelection: cluster scope too wide");return this._searchHagroups(e[0].hagroups,r)}else{return e}};o.prototype._searchHagroups=function C(e,t){var r=this._where(e,t.hagroup),i=s.omit(t,"hagroup");return s.isEmpty(i)?r:this._searchHardware(r,i)};o.prototype._searchHardware=function T(e,t){if(t.shelf){var r=this._searchShelves(e,t),i=s.omit(t,"shelf");return s.isEmpty(i)?r:this._searchDrives(r,i)}else if(t.controller){var n=this._searchControllers(e,t),a=s.omit(t,"controller");return s.isEmpty(a)?n:this._searchAggregates(n,a)}else{throw new Error("resolveSelection: unknown hardware selector")}};o.prototype._searchControllers=function R(e,t){var r=s.reduce(e,function i(e,r){return e.concat(this._where(r.controllers,t.controller))},[],this);return r};o.prototype._searchAggregates=function P(e,t){if(t.aggregate){var r=s.reduce(e,function i(e,r){return e.concat(this._where(r.aggregates,t.aggregate))},[],this);return r}else{throw new Error("resolveSelection: unknown aggregate selector")}};o.prototype._searchShelves=function N(e,t){var r=s.omit(t.shelf,"_x_bom"),i=t.shelf._x_bom?t.shelf._x_bom.drive_specs||[]:[];var n=s.reduce(e,function l(e,t){return e.concat(this._where(t.shelves,r))},[],this);function a(e){return s.every(i,s.partial(o,e))}function o(e,t,r){return s.every([e._x_bom.drive_specs[r]],t)}return s.filter(n,a)};o.prototype._searchDrives=function D(e,t){if(t.drive){var r=s.reduce(e,function i(e,r){var i=s.isEmpty(r._x_bom)?[]:r._x_bom.drive_specs;return e.concat(this._where(i,t.drive))},[],this);return r}else{throw new Error("resolveSelection: unknown drive selector")}};o.prototype._where=function x(e,t){return s.isEmpty(t)?s.where(e):s.where(e,t)};t.exports=o},{"./guard":93,"./inspect":99,assert:127}],103:[function(e,t,r){"use strict";var i=e("assert"),s=window._;function n(e,t){this._map=e;this._guardOption=t;this.build=s.bind(this.build,this)}n.prototype.build=function a(e,t,r){i.equal(typeof e,"object","addingTo object");i.equal(s.isEmpty(e),false,"bad addingTo selector");i(t===undefined||typeof t==="object","bad replacing selector");i(r===undefined||s.isPlainObject(r),"bad options");i.equal(s.isEmpty(this._guardOption.conflicts),true,"cannot resolve conflicts");return this._handleCreatingBuildSpecsFor(e,t,this._guardOption,r)};n.prototype._addCurrentInstallationToSelector=function(e){if(!e.installation){e=s.extend(e,{installation:this._map.installations[0]})}};n.prototype._resolveSystemSelectorUsingMap=function(e){if(!e){return null}var t=s.omit(e,"shelf","drive");return this._resolveSelectorUsingMap(t)};n.prototype._resolveSelectorUsingMap=function(e){if(!e){return null}this._addCurrentInstallationToSelector(e);var t=this._map.resolveSelection(e);if(t){return t}else{return null}};n.prototype._handleCreatingBuildSpecsFor=function(e,t,r,i){var s=this._resolveSystemSelectorUsingMap(e),n=this._resolveSelectorUsingMap(t),a=!this._isSelectorConfigGroup(e),o=this._determineVersionWithSelection(r),l=this._determineLimitsWithSelection(r),c=[];i=i||{};if(a){var u=this._selectionToArrayOfSystems(s);c=this._createSpecsForSystemGroup(u,n,r,o,l,i)}else{var p=this._createBaseBuildSpecFor(r,o,l),d=this._defaultShelfOptionForConfig(r,o,l);if(d){p.shelves.push(d)}c.push(p)}return c};n.prototype._isSelectorConfigGroup=function(e){return e&&e.title&&e.id};n.prototype._createSpecsForSystemGroup=function(e,t,r,i,n,a){var o=this,l=[],c=s.without(e,t);s.forEach(c,function(e){var s=o._createBuildSpecForHagroup(e,t,r,i,n,a);l.push(s)});if(r.configModel){var u=t?t.length:1;var p=s.cloneDeep(l);l=[];for(var d=0;d<u;d++){var f=this._createBaseBuildSpecFor(r,i,n),h=this._defaultShelfOptionForConfig(r,i,n);if(h){f.shelves.push(h)}if(t){var m=s.where(p[d].shelves,{isEmbedded:false});f.shelves.push.apply(f.shelves,m);f.existingId=this._determineExistingId(f,t[d])}l.push(f)}}return l};n.prototype._createBuildSpecForHagroup=function(e,t,r,i,n){var a=this._determineExistingId(e,t),o=this._determineCompleteDetailForBuildSpec(e,r),l=this._createBaseBuildSpecFor(o.config,i,n);s.extend(l,{shelves:this._getShelfSummaryFromExistingSystem(e,t),existingId:a});if(o.isShelfOption){var c=this._shelfOptionToBuildSpec(r);if(c){l.shelves.push(c)}else{console.warn("_createBuildSpecForHagroup -> Unable to get the new shelf spec")}}else if(o.isDriveOption){console.warn("_createBuildSpecForHagroup -> Update Drive in Shelf TODO")}else if(o.isSystemOption){var u=this._defaultShelfOptionForConfig(o.config,i,n);if(u){l.shelves.push(u)}}else{console.warn("_createBuildSpecForHagroup -> Unknown option")}return l};n.prototype._determineExistingId=function(e,t){if(t&&!s.isArray(t)){return t._model?t._id:null}else{return e._model?e._id:null}};n.prototype._determineCompleteDetailForBuildSpec=function(e,t){var r={isSystemOption:false,isShelfOption:false,isDriveOption:false,noOption:t?false:true,option:t,config:null};if(t.shelf){r.isShelfOption=true;r.config=this._determineConfigFromSystemSelection(e)}else if(t.drives){r.isDriveOption=true;r.config=this._determineConfigFromSystemSelection(e)}else if(t.configModel){r.isSystemOption=true;r.config=t}return r};n.prototype._defaultShelfOptionForConfig=function(e){var t=e.newEmbeddedShelf;return s.isEmpty(t)?null:this._shelfOptionToBuildSpec(t)};n.prototype._determineVersionWithSelection=function(e){return e.newVersion};n.prototype._determineLimitsWithSelection=function(e){return e.newLimits};n.prototype._shelfOptionToBuildSpec=function(e){var t={};if(e.shelf&&e.drives){s.extend(t,{model:e.shelf.model,isEmbedded:e.isEmbedded,quantity:e.quantity||1,drives:s.map(e.drives,function(e){return{model:e.drive.model,quantity:e.quantity}})})}else{console.warn("Poorly formed shelf option");return null}return t};n.prototype._getShelfSummaryFromExistingSystem=function(e,t){i(e,"Must have a system to get shelf summary from");var r=e.shelves||[];if(t){var n=s.map(t,function(e){return e._id});r=s.where(r,function(e){return!s.contains(n,e._id)})}return s.map(r,function(e){var t=s.isEmpty(e._x_bom)?[]:e._x_bom.drive_specs;return{model:e.model,quantity:1,isEmbedded:!e._isembedded?false:true,drives:s.map(t,function(e){return{model:e.model,quantity:e.quantity}})}})};n.prototype._createBaseBuildSpecFor=function(e,t,r){if(!e){return{}}return{platformModel:e.platformModel,configModel:e.configModel,controllerCount:e.controllerCount,isESeries:e.isESeries,isFlashRay:e.isFlashRay,shelves:[],version:t,limits:r,existingId:null}};n.prototype._determineConfigGroupFromSelection=function(e){i(e,"Must provide a selection to determine config group");var t=this._selectionToArrayOfSystems(e),r=this._getUniqueConfigGroups(t);if(r.length){return s.first(r)}else{console.warn("Determine Config Group from selection yielded varying group types")}return null};n.prototype._getUniqueConfigGroups=function o(e){var t=s.reduce(e,function r(e,t){var r=this._map.inspect(t),i=r.configGroup,n=!s.some(e,{id:i.id});if(n){e.push(i)}return e},[],this);return t};n.prototype._selectionToArrayOfSystems=function(e){if(s.isArray(e)){var t=s.map(e,function(e){return e.hagroups});if(s.every(t)){return s.flatten(t)}return e}else{return e.hagroups||[e]}};n.prototype._determineConfigFromSystemSelection=function(e,t){i(e,"Must provide a system selection to determine config");var r=t||this._determineConfigGroupFromSelection(e);if(r&&r.getConfig){var s=this._getSystemSelectionModel(e);return r.getConfig(s)}else{console.warn("Unable to determine config group for system selector");console.warn(e)}return null};n.prototype._getSystemSelectionModel=function(e){i(e,"Must provide a system selection to determine model");var t=null,r=null;if(s.isArray(e)){r=s.first(e)}else{r=e}if(r.hagroups){t=s.first(r.hagroups)}else{t=r}return t?t._model||t.model:null};t.exports=n},{assert:127}],104:[function(e,t,r){"use strict";var i=window._,s=e("assert");function n(e,t){s(e,"hagroup is not defined");s(t,"shelf is not defined");s(e.drives,"hagroup is not an HAGroup");s(t.shelf_number||t.shelf_number===0,"shelf is not a Shelf : "+t);var r=i.where(e.drives,function(e){return e.shelf===t.shelf_number});return r}function a(e){return i.uniq(i.map(e,function(e){return e.disk_model}))}function o(e){var t=i.isEmpty(e._x_bom)?[]:e._x_bom.drive_specs;return JSON.stringify({model:e.model,drive_specs:i(t).sortBy(function(e){return e.model}).value()}).replace(/"/g,"")}function l(e,t,r){var i=e.model===t.model,s=e.quantity==t.quantity;return r?i:i&&s}function c(e,t,r){var s=i.isEmpty(e._x_bom)?[]:e._x_bom.drive_specs,n=i.isEmpty(t._x_bom)?[]:t._x_bom.drive_specs;if(e.model===t.model&&s.length===n.length){var a=i.sortBy(s,function(e){return e.model});var o=i.sortBy(n,function(e){return e.model});for(var c=0;c<a.length;c++){if(!l(a[c],o[c],r)){return false}}return true}else{return false}}function u(e,t,r){s(e._x_bom,e+" shelfDrive must at least have_x_bom in order to compare");s(t._x_bom,t+" shelfDrive must at least have_x_bom in order to compare");return c(e,t,r)}function p(e){return i.groupBy(e,function(e){return o(e)})}function d(e,t){return h(e,t,false)}function f(e,t){return h(e,t,true)}function h(e,t,r){var s=i(t),n=s.where(function(t){return m(t,e)}).first();if(!n&&r){n=s.where(function(t){return m(t,e,true)}).first()}return n}function m(e,t,r){if(e.isEmbedded===t._isembedded){var s=i.map(e.drives,function a(e){return{model:e.drive.model,quantity:e.quantity}
});var n={model:e.shelf.model,_x_bom:{drive_specs:s}};return u(n,t,r)}else{return false}}function g(e){var t=i.pick(e.spec,"rpm","rsgb","slice","encrypted","_for_controller");return JSON.stringify(t)}function y(e){switch(e){case 50:return"SSD";case 15:case 10:return"FC_SAS";case 7.2:return"SATA"}}t.exports={findDrivesBelongingToShelf:n,driveModels:a,shelfDriveComboEquals:u,groupShelves:p,isConfigForShelf:m,minimalSpecKey:g,rpmToEffectiveDriveType:y,chooseMatchingShelfConfig:d,chooseClosestShelfConfig:f}},{assert:127}],105:[function(e,t,r){"use strict";var i=e("assert");var s;function n(e,t){i(this instanceof n,"use new");i(t instanceof Array||typeof t==="string","invalid path");this._value=e;this._cache={};if(t instanceof Array){this._path=t.slice(0)}else{this._path=t.split(".")}Object.defineProperties(this,{path:{get:function(){return this._path.join(".")}},value:{get:function(){return this._value}}})}n.prototype.assert=function(e,t){if(typeof e==="function"){e=e(this._value)}i(typeof e==="boolean");i(typeof t==="string");i(e,this.path+": "+t);return this};n.prototype.assertType=function(e){this.assert(typeof this.value===e,"expected "+e);return this};n.prototype.get=function(e){var t=this.maybe(e);if(t.exists){return t}else{i(false,t.path+": expected value")}};n.prototype.has=function(e){return this.maybe(e).exists};n.prototype.exists=true;n.prototype.maybe=function(e){i.equal(typeof e,"string","invalid path");return this._maybe(e.split("."))};n.prototype._maybe=function(e){i(e instanceof Array);e=e.slice();var t=e.shift();if(t in this._cache){if(e.length){return this._cache[t]._maybe(e)}else{return this._cache[t]}}var r=this._path.concat([t]);if(this._value.hasOwnProperty(t)){var a=new n(this._value[t],r);this._cache[t]=a;if(e.length){return a._maybe(e)}else{return a}}else{var o=r.join("."),l=r.concat(e).join(".");return new s(l,o)}};n.isWrapped=function(e){return e instanceof n||e instanceof s};s=function o(e,t){i(this instanceof o,"use new");i(typeof(this._path=e)==="string");i(typeof(this._because=t)==="string");var r=this.NO.bind(this);Object.defineProperties(this,{path:{get:function(){return this._path}},value:{get:function(){r("get")}},exists:{value:false,writable:false}});for(var s in n.prototype){if(!(s in o.prototype)){this[s]=this.NO.bind(this,s)}}};s.prototype.exists=false;s.prototype.maybe=function(e){var t=this._path+"."+e;return new s(t,this._because)};s.prototype.NO=function l(){i(false,this._because+": expected value")};for(var a in n.prototype){if(!(a in s.prototype)){s[a]=s.NO}}t.exports=n},{assert:127}],106:[function(e,t,r){"use strict";var i=e("assert"),s=e("./constants");var n=s.CONFIG_GROUPS;function a(){i(this instanceof a,"use new");return o()}function o(){return[{scope:"Aggregates",policy:"manual",label:"Automatically fill system with Aggregates",defaultValue:false,inverted:true,impactsCluster:false,productLines:[n.FAS]},{scope:"Aggregates",policy:"manual",label:"Automatically fill system with Storage Containers",defaultValue:false,inverted:true,impactsCluster:false,productLines:[n.E]},{scope:"ADP",policy:"prohibitedByUser",label:"Use Root-Data Partitioning when available",defaultValue:false,inverted:true,impactsCluster:false,productLines:[n.FAS]},{scope:"Aggregates",policy:"ssdsForFlashPool",label:"Prefer using SSDs for Flash Pool",defaultValue:true,inverted:false,impactsCluster:false,productLines:[n.FAS]},{scope:"version",policy:"pin",label:"Automatically select the latest compatible OS version",defaultValue:true,inverted:true,impactsCluster:true,productLines:[n.FAS,n.E]},{scope:"spare_allocation",policy:"enforce",label:"Enforce spare allocation policy",defaultValue:s.POLICIES.SPARES.DEFAULT,allowedValues:s.POLICIES.SPARES.ALLOWED,inverted:false,impactsCluster:false,productLines:[n.FAS]}]}t.exports=a},{"./constants":65,assert:127}],107:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("./config");function a(e,t,r,n){if(!(this instanceof a)){return new a(e,t,r,n)}var o=s.partialRight(a,this),l={enabled:false},c={parent:n||null,_configs:[],_configsByModel:{}};i(this instanceof a,"use new");i.equal(typeof e,"object","options "+typeof e);i(n===undefined||n instanceof a,"parent");i(!(n!==undefined&&this.subGroups),"depth limit: 2");s.merge(this,l,e,c);if(!this.subGroups){this.subGroups=[]}else{i(this.subGroups instanceof Array);this.subGroups=s.map(this.subGroups,o)}}a.prototype.inhaleRawSystem=function o(e,t){i(s.isPlainObject(e),"rawSystem");var r=e.name,a;if(s.has(this._configsByModel,r)){a=this._configsByModel[r]}else if(e){this._configsByModel[r]=a=new n(e,t);this._configs.push(a)}return a};a.prototype.getConfigByModel=function l(e){i.equal(typeof e,"string","configModel "+typeof e);i(s.has(this._configsByModel,e),"unknown configModel "+e);return this._configsByModel};a.prototype.getConfigs=function c(){return this._configs};a.prototype.getConfig=function u(e){var t=s.where(this._configs,{configModel:e});i.equal(t.length,1,"cannot find "+e);return t[0]};a.prototype.getSubGroup=function p(e){if(e===""){return this}var t=s.where(this.subGroups,{id:e});i.equal(t.length,1,"subgroup lookup "+e);return t[0]};a.prototype.where=function d(e){if(s.isEmpty(e)){return s.where(this._configs)}else{return s.where(this._configs,e)}};t.exports=a},{"./config":108,assert:127}],108:[function(e,t,r){"use strict";var i=e("assert"),s=e("./matrix"),n=window._;function a(e,t){if(!(this instanceof a)){return new a(e)}i.equal(typeof e,"object","rawSystem "+typeof e);var r=e.stats,o=r.chassis_count*r.controller_per_chassis;n.merge(this,{platformModel:t,configModel:e.name,configDesc:e.config,controllerCount:o,isHA:o>1,isEmbedded:e.hardware.embedded_shelves.length>0,isSellable:e.sellable,stats:e.stats,matrix:new s(e.name)})}t.exports=a},{"./matrix":110,assert:127}],109:[function(e,t,r){"use strict";var i=e("assert"),s=e("../constants"),n=window._,a=e("./config-group"),o=e("async");var l=s.CONFIG_GROUPS;function c(e){i(this instanceof c,"use new");i(typeof e==="object","rcd "+typeof e);this._initConfigGroups();this._rawConfigData=e;this._inhaled=false}c.prototype.getConfigGroups=function p(){i(this._inhaled);return this._configGroups};c.prototype.getConfigGroup=function d(e,t){i(this._inhaled);var r=n.where(this._configGroups,{id:e});i.equal(r.length,1,"subgroup lookup "+e);var s=r[0];if(t){return s.getSubGroup(t)}else{return s}};c.prototype._initConfigGroups=function f(){this._configGroups=n.map([{id:l.FAS,title:"Fabric-Attached Storage",subtitle:"Data ONTAP",img:"../media/img/FAS8020_front_view.png",enabled:true,subGroups:[{id:l.FAS_CMODE_NORMAL,title:"Clustered Data ONTAP",enabled:true},{id:l.FAS_7MODE_NORMAL,title:"7-Mode",enabled:true},{id:l.FAS_7MODE_MC,title:"MetroCluster",enabled:false},{id:l.FAS_CMODE_MCC,title:"Clustered Metro Cluster",enabled:false},{id:l.FAS_VSERIES,title:"V Series",enabled:false}]},{id:l.E,title:"E-Series",subtitle:"SANtricity",img:"../media/img/E2660_front_view.png",enabled:true,subGroups:[{id:l.E_NORMAL,title:"E-Series",enabled:true},{id:l.EF_NORMAL,title:"EF-Series",enabled:true}]}],a)};c.prototype.determineConfigGroup=function h(e){i(this._inhaled);i(e,"Cannot determine config group without hagroup");var t=n.where(this._configGroups,function(t){var r=e._model||e.model;if(t.id===l.FAS&&r&&r.toUpperCase().indexOf(l.FAS_VSERIES)===0){return true}return r&&r.toUpperCase().indexOf(t.id)===0});if(t.length>0){if(t.length>1){t=n.sortBy(t,function(e){return e.id.length*-1})}var r=n.first(t);if(r.subGroups.length>0){var s=null;if(r.id===l.FAS){if(e.is_clustered&&e.is_metrocluster){s=l.FAS_CMODE_MCC}else if(e.is_clustered){s=l.FAS_CMODE_NORMAL}else if(e.is_metrocluster){s=l.FAS_7MODE_MC}else{s=l.FAS_7MODE_NORMAL}}if(r.id===l.E){var a=e.model||e._model;if(a.indexOf("EF")===0){s=l.EF_NORMAL}else{s=l.E_NORMAL}}return this.getConfigGroup(r.id,s)}return this.getConfigGroup(r.id)}return[]};c.prototype.getConfig=function m(e){i(this._inhaled);var t=this.determineConfigGroup(e);return t.getConfig(e._model)};c.prototype.inhale=function g(e){i(!this._inhaled);var t=this._rawConfigData,r=[this._inhaleLimits,this._inhaleReleases,this._inhaleShelves,this._inhaleDrives,this._inhaleShelfPresets,this._inhaleCards,this._inhalePlatforms],s=n.map(r,l,this);o.series(s,a.bind(this));function a(t){i(this instanceof c);if(!t){this._inhaled=true}return e(t)}function l(e){i(this instanceof c);if(e.length===2){return e.bind(this,t)}var r=n.bind(s,this);return n.bind(setImmediate,this,r);function s(r){i(this instanceof c);try{e.call(this,t);setImmediate(r,null)}catch(s){console.error(s.stack);setImmediate(r,s)}}}};c.prototype._inhaleLimits=function y(e){i.notEqual(e.limits,undefined);this._limits=e.limits};c.prototype._inhaleReleases=function v(e){var t=this._inhaleReleaseFamilies(e),r={};function s(e){var s=e.version;i.equal(n.has(r,s),false,"dup version "+s);var a={family:t[e.family],version:s,sys_version:u(s),cMode:e.clustered,status:e.release_status};a.family.releases.push(a);return a}this._releases=n.map(e.os_releases,s)};function u(e){i.equal(typeof e,"string");var t=e.split(" ");return t[0]}c.prototype._inhaleReleaseFamilies=function _(e){function t(e){var t={name:e.name,releases:[]};return t}return this._families=n.map(e.os_families,t)};c.prototype._inhaleShelves=function E(e){this._shelves=e.shelves};c.prototype._inhaleDrives=function b(e){this._drives=n.map(e.drives,function t(e){switch(e.fp_support){case"yes":e.fp_support=true;break;case"no":e.fp_support=false;break;default:break}return e})};c.prototype._inhaleCards=function w(e){this._cards=e.cards};c.prototype._inhaleShelfPresets=function S(e){i(this._shelves,"Please inhale shelves first");i(this._drives,"Please inhale drives first");var t=this;this._shelfPresets=n.map(e.presets,function(e){var r=[];n.forEach([e.primary,e.secondary],function(e){if(e){r.push({quantity:e.quantity,drive:t._drives[e.drive]})}});return{ref:e,shelf:t._shelves[e.shelf],drives:r}})};c.prototype._inhalePlatforms=function A(e,t){i(this instanceof c);i(e);this._systemConfigs={};var r=e.platforms,s=n.bind(this._inhalePlatform,this),a=this.delay(t);o.eachSeries(r,s,a)};c.prototype._inhalePlatform=function C(e,t){i(this instanceof c);i.equal(typeof e,"object");i.equal(typeof t,"function");var r=this._getPrimaryConfigGroupIDGivenEpicFamily(e.family),s=n(this._configGroups).where({id:r}).first(),a=n.bind(this._inhaleModel,this,s),l=this.delay(t);o.eachSeries(e.models,a,l)};c.prototype._inhaleModel=function T(e,t,r){i(this instanceof c);i.equal(typeof e,"object");i.equal(typeof t,"object");i.equal(typeof r,"function");i(e instanceof a);i(n.isPlainObject(t));var s=t.platform,l=n.bind(this._inhaleSystem,this,e,s),u=this.delay(r);o.eachSeries(t.systems,this.asyncify(l),u)};c.prototype._inhaleSystem=function R(e,t,r){i(e instanceof a);i(typeof t==="string");var s=this,o={cards:this._cards,drives:this._drives,shelfPresets:this._shelfPresets,shelves:this._shelves};n.forEach(r.os_limits,function(i){var a=s._limits[i.limits],l=s._releases[i.os[0]],c=l.cMode,u=s._getSubGroupGivenEpicData(e,r,c),p=e.getSubGroup(u),d=p.inhaleRawSystem(r,t);n.forEach(i.os,function(e){var t=n.extend(s._releases[e],{_index:e});d.matrix.inhaleRelease(t,a)});d.matrix.inhaleHardware(r.hardware,o,d.stats);if(d.isEmbedded){if(!d.stats.power.power_spec){d.stats.power.power_spec={}}if(!d.stats.weight.weight_g){d.stats.weight.weight_g=0}}})};c.prototype._getPrimaryConfigGroupIDGivenEpicFamily=function(e){var t=e.match(/^([A-Z]+)([0-9\-]+)/);i.notEqual(t,null,"cannot parse model family: "+e);switch(t[1]){case"E":return l.E;case"EF":return l.E;case"FAS":return l.FAS;case"V":return l.FAS}i.fail(t[1],"E, FAS, or V","unknown model prefix"+t[1]+" for "+e,"match")};c.prototype._getSubGroupGivenEpicData=function(e,t,r){var s=t.config.match(/Metro/)!==null,n=t.name.match(/MCC/)!==null,a=t.name.match(/EF/)!==null;switch(e.id){case l.E:if(a){return l.EF_NORMAL}else{return l.E_NORMAL}break;case l.FAS:if(r){if(n){return l.FAS_CMODE_MCC}else if(!n&&!s){return l.FAS_CMODE_NORMAL}else{i.equal(s,false,"c-mode MC unsupported")}}else{if(s){return l.FAS_7MODE_MC}else{return l.FAS_7MODE_NORMAL}}break}i.fail(e.id,"E, EF, or FAS","unknown config group "+e.id,"=")};c.prototype.getDriveByModel=function(e){i(this._inhaled);return n.find(this._drives,function(t){return t.model===e})};c.prototype.delay=function P(e){return function t(){var t=n.toArray(arguments);setImmediate(r,1);function r(){e.apply(this,t)}}};c.prototype.asyncify=function N(e){i(this instanceof c);return n.bind(t,this);function t(){var t=n.toArray(arguments),r=t.pop();i(this instanceof c);i.equal(typeof r,"function");try{var s=e.apply(this,t);setImmediate(r,s)}catch(a){setImmediate(r,a)}}};t.exports=c},{"../constants":65,"./config-group":107,assert:127,async:126}],110:[function(e,t,r){(function(r){"use strict";var i=window._,s=e("util"),n=e("assert");function a(e){n(this instanceof a,"use new");this.configModel=e;this._={rbi:{},rik:[],sv:{},t:{d:{},dR:{},rsd:{},r:{},s:{},sR:{}},v:{}};Object.defineProperty(this,"versions",{get:function t(){this.finalize();return i.keys(this._.v)}});this.hardwareOptions={};this.checkVersionShelfDrive=i.memoize(i.bind(this.checkVersionShelfDrive,this),function(e,t,r){return[e,t,r].join("\x00")});this._showEnvStatChecks=false;this._envStatChecks={configModel:e}}a.prototype.getFullNameForVersion=function c(e){n(i.has(this._.v,e),s.format("unknown version %s; need %s for %s",e,i.keys(this._.v).join(", "),this.configModel));this.finalize();var t=this._.v[e].sys_version,r=this._.v[e].family.name;return t+" "+r};a.prototype.isCompatibleWithVersion=function u(e){this.finalize();return i.has(this._.v,e)};a.prototype.getLimitsForVersion=function p(e){n(i.has(this._.v,e),s.format("unknown version %s; need %s for %s",e,i.keys(this._.v).join(", "),this.configModel));this.finalize();var t=this._.v[e]._index;return this._.rbi[t].limits};a.prototype.checkVersionShelfDrive=function d(e,t,r){this.finalize();var s={compatible:false,fp_slicing:false,fp_support_drive:false,root_slicing:false},a=this._.t,o=a.sR[t],l=a.dR[r];if(!i.has(this._.v,e)||o===undefined||l===undefined){return s}var c=this._.v[e],u=c._index,p=this._.rbi[c._index].limits,d=this._mkRSDspec(u,o,l);if(!i.has(a.rsd,d)){return s}return{compatible:true,drive:a.d[l],fp_slicing:f(p.fp_slicing),fp_support_drive:f(p.fp_support_drive),root_slicing:f(p.root_slicing)};function f(e){var t=i.where(e,{shelf:o});if(t.length){n(t.length===1);return i.contains(t[0].drives,l)}else{return false}}};a.prototype.inhaleRelease=function f(e,t){this._.v[e.version]=e;this._.sv[e.sys_version]=e;this._.t.r[e._index]=e;this._.rbi[e._index]={release:e,limits:t};if(this._.rik.indexOf(e._index)===-1){this._.rik.push(e._index)}};a.prototype.inhaleHardware=function h(e,t,r){this._bindHardware(e,t,r)};a.prototype.finalize=function m(){this._reverseIndexes();this._lockDown()};a.prototype._reverseIndexes=function g(){var e=this._.t;i.forEach(e.d,function(t,r){e.dR[t.model]=0|r});i.forEach(e.s,function(t,r){e.sR[t.model]=0|r})};a.prototype._lockDown=function y(){this.inhaleRelease=this.inhaleHardware=e;this.finalize=i.noop;function e(){n(false,"matrix locked after hardware inhalation")}};a.prototype._bindHardware=function(e,t,r){this._cacheEntries(e,t);var i={shelves:this._bindShelves(e.shelves,e.drives,t,false),embeddedShelves:this._bindShelves(e.embedded_shelves,e.drives,t,true,r),shelfPresets:this._bindShelfPresets(e.presets,e.embedded_shelves,t),cards:this._bindCards(e.cards,t)};this._outputEnvStatChecks();this.hardwareOptions=i};a.prototype._cacheEntries=function v(e,t){var r=this,s=this._.t,n=s.rsd;i.forEach(e.shelves,a);i.forEach(e.embedded_shelves,a);i.forEach(e.drives,o);function a(e){var r=e.shelf;s.s[r]=t.shelves[r]}function o(e){var a=e.drive;s.d[a]=t.drives[a];i.forEach(e.os,function(t){i.forEach(e.shelves,function(e){n[r._mkRSDspec(t,e,a)]=true})})}};a.prototype._mkRSDspec=function _(e,t,r){return e<<24|t<<16|r};a.prototype._bindShelfPresets=function(e,t,r){var s=this,n=i.map(t,function(e){return e.shelf}),a=[];i.forEach(e,function(e){var t=r.shelfPresets[e.preset],o=i.contains(n,t.ref.shelf),l=s._mapRawOsIntoReleaseVersions(e.os),c=t.shelf,u=c.stats,p=i(u.weight).find({preset:e.preset}),d=p?p.weight_g:0,f=i(u.power).find({preset:e.preset});s._checkEnvironmentalStats(p,f,c,e);if(!f){f={}}if(o){var h={shelf:c,isEmbedded:true,drives:t.drives,power_spec:f,weight_g:d,versions:l};a.push(h)}if(!c.embedded_only){var m={shelf:c,isEmbedded:false,drives:t.drives,power_spec:f,weight_g:d,versions:l};a.push(m)}});return a};a.prototype._bindShelves=function(e,t,r,s,n){var a=this,o=i.map(e,"shelf"),l=i.where(t,function(e){return i.any(e.shelves,function(e){return i.contains(o,e)})}),c=[];i.forEach(l,function(e){i.forEach(e.shelves,function(t){if(i.contains(o,t)){var l=r.shelves[t],u=l.stats,p=s?n.weight.with_internal:u.weight,d=i(p).find({drive:e.drive}),f=d?d.weight_g:0,h=s?n.power.with_internal:u.power,m=i(h).find({drive:e.drive});a._checkEnvironmentalStats(d,m,l,e);if(!m){m={}}var g={shelf:l,isEmbedded:s,drives:[{quantity:u.drive_slots*u.drives_per_carrier,drive:r.drives[e.drive]}],power_spec:m,weight_g:f,versions:a._mapRawOsIntoReleaseVersions(e.os)};c.push(g)}})});return c};a.prototype._checkEnvironmentalStats=function(e,t,r,i){if(this._showEnvStatChecks){var s=this;var n=function(e){if(!s._envStatChecks[e]){s._envStatChecks[e]={}}if(i.drive){s._envStatChecks[e][":drive:"+i.drive+",shelf:"+r]=[r,i]}else if(i.preset){s._envStatChecks[e][":preset:"+i.preset+",shelf:"+r]=[r,i]}};if(e&&t){}if(!e){n("missing-weight")}if(!t){n("missing-power_spec")}else{if(!t.v_100){n("missing-power_spec.v_100")}if(!t.v_200){n("missing-power_spec.v_200")}}}};a.prototype._outputEnvStatChecks=function(){if(this._showEnvStatChecks){console.warn(this._envStatChecks)}};a.prototype._bindCards=function(e,t){var r=this,s=[];i.forEach(e,function(e){var n={card:t[e.card],assignments:i.map(e.assignments,function(e){return{slots:e.slots,versions:r._mapRawOsIntoReleaseVersions(e.os)}}),versions:r._mapRawOsIntoReleaseVersions(e.os)};s.push(n)});return s};a.prototype._mapRawOsIntoReleaseVersions=function(e){var t=this;if(e){return i.without(i.map(e,function(e){return t._getReleaseIfInTable(e)}),-1)}return[]};a.prototype._getReleaseIfInTable=function(e){if(this._.rik.indexOf(e)!==-1){return this._.rbi[e].release}return-1};a.prototype._osAgnosticIsEqual=function(e,t){var r=i.without(i.keys(e),"_os"),s=[];s=i.map(r,function(r){if(!i.has(t,r)){return false}return i.isEqual(e[r],t[r])});return i.all(s)};a.prototype._safeArrayConcat=function(e,t){var r=[];if(e){r=r.concat(e)}if(t){r=r.concat(t)}return r};function o(e,t){var i=0,s=true;t=t||e.name||"(unknown)";function n(e){var t=r.hrtime(e),s=t[0]+t[1]/1e9;i=i+s}return function a(){if(s){s=false;console.error("MEASURING:",t);r.on("exit",function(){console.error("MEASURED:",t,i.toPrecision(5))})}var a=r.hrtime(),o;try{o=e.apply(this,arguments);n(a);return o}catch(l){n(a);throw l}}}var l=["inhaleRelease","inhaleHardware","finalize","_cacheEntries","_updateUniqueLimits","_bindShelves","_bindShelfPresets","_bindCards"];if(r.env.SR_MEASURE_MATRIX){i.forEach(l,function(e){a.prototype[e]=o(a.prototype[e],e)})}t.exports=a}).call(this,e("_process"))},{_process:130,assert:127,util:132}],111:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("../../constants"),a=e("../../enforce");var o={sparesLevel:["string",n.POLICIES.SPARES.DEFAULT.toLowerCase(),p],deviceCount:["number",d],raidCount:["number",2],isEmbeddedShelfOnly:["boolean",false]},l={minimum:[4,2,1,2,2],balanced:[6,4,2,2,2],maximum:[8,6,2,2,4]},c={HUGE:0,LARGE:1,ENTRY:2,SINGLE:3,MEDIUM:4};function u(e){s(i.isPlainObject(e));e=a(o,e);var t=l[e.sparesLevel];if(e.deviceCount>=1200){return t[c.HUGE]}else if(e.deviceCount>=300){return t[c.LARGE]}else if(e.isEmbeddedShelfOnly){return t[c.ENTRY]}else if(e.raidCount<2){return t[c.SINGLE]}else{return t[c.MEDIUM]}}function p(e){s(i.has(l,e),"invalid spares level: "+e);return e}function d(e){s(e>1);return e}t.exports=u},{"../../constants":65,"../../enforce":70,assert:127}],112:[function(e,t,r){"use strict";var i=e("assert"),s=e("async"),n=window._,a=e("./constants");function o(e){i(this instanceof o,"use new");i(typeof e==="function","need xhr");this.xhr=e;this.readQueue=s.queue(n.bind(this.worker,this),a.SERVER_READ_CONCURRENCY);this.writeQueue=s.queue(n.bind(this.worker,this),a.SERVER_WRITE_CONCURRENCY)}o.prototype.worker=function l(e,t){i(e instanceof Object);i(typeof t==="function");i(typeof e.method==="string");i(typeof e.basePath==="string","buildUrl: basePath string");i(e.options instanceof Object);function r(e,t,r){var s=[e];if(t===null){i(r===null,"buildUrl: version null if uuid null")}else{s.push(t);if(r!==null){s.push(r)}}return s.join("/")}var s=e.options.payload&&e.options.payload._uuid||null,n=e.options.payload&&e.options.payload._version||null,a=r(e.basePath,s,n);this.xhr(e.method,a,e.options,function(e,r){if(e){console.error(e);return t(e)}if(r.statusCode!==200){t(new Error(a+" -> "+r.statusCode))}else{var i;try{i=JSON.parse(r.body)}catch(e){t(new Error("cannot parse response"))}t(null,i)}})};o.prototype.pauseReadQueue=function c(){if(!this.readQueue.paused){this.readQueue.pause()}};o.prototype.pauseWriteQueue=function u(){if(!this.writeQueue.paused){this.writeQueue.pause()}};o.prototype.resumeReadQueue=function p(){if(this.readQueue.paused){this.readQueue.resume()}};o.prototype.resumeWriteQueue=function d(){if(this.writeQueue.paused){this.writeQueue.resume()}};o.prototype.pushToReadQueue=function f(e,t){this.readQueue.push(e,t)};o.prototype.pushToWriteQueue=function h(e,t){this.writeQueue.push(e,t)};o.prototype.queueStatus=function m(){return{readQueueLength:this.readQueue.length&&this.readQueue.length()||0,readQueueRunning:this.readQueue.running&&this.readQueue.running()||0,readQueuePaused:this.readQueue.paused,writeQueueLength:this.writeQueue.length&&this.writeQueue.length()||0,writeQueueRunning:this.writeQueue.running&&this.writeQueue.running()||0,writeQueuePaused:this.writeQueue.paused}};t.exports=o},{"./constants":65,assert:127,async:126}],113:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=e("./store");function a(){i(this instanceof a,"use new");n.call(this,"EVENTJOURNAL");this.events=[];this.open=false}s.inherits(a,n);a.prototype._act=n.prototype.act;a.prototype.act=function o(e){i(typeof e==="string","need action ID");var t=[];for(var r=0;r<arguments.length;r++){t.push(arguments[r])}this.events.push(t);var s=this._act.apply(this,arguments);this.changed();return s};a.prototype.getState=function l(){return{events:this.events}};a.prototype.EVENTJOURNAL_CLEAR=function c(){this.events=[]};t.exports=a},{"./store":120,assert:127,util:132}],114:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("./store"),o=e("../client-cache");function l(){i(this instanceof l,"use new");a.call(this,"HARDWARE");this.cache=null;this.col2View=null;this.col3View=null;this.selector=null;this.uuid=null;var e=this;o(function t(r,i){if(r){console.error(r)}else{e.cache=i;e.restoreCacheState()}})}n.inherits(l,a);l.prototype.getState=function c(){return{uuid:this.uuid,selector:this.selector,col2View:this.col2View,col3View:this.col3View}};l.prototype.HARDWARE_CLEAR=function u(){this.col2View=null;this.col3View=null;this.selector=null;this.uuid=null;this.saveToLocalStorage();this.changed()};l.prototype.HARDWARE_SELECT=function p(e,t,r,s){i(typeof e==="string","string uuid");this.col2View=r||null;this.col3View=s||null;this.selector=t||null;this.uuid=e;this.saveToLocalStorage();this.changed()};l.prototype.restoreCacheState=function d(){if(this.cache){var e=this;this.cache.get("synergy.hardware.selection",function t(r,i){if(r){console.error(r)}else if(e.isValidSelection(i)){e.col2View=i.col2View||null;e.col3View=i.col3View||null;e.selector=i.selector||null;e.uuid=i.uuid}else{e.col2View=null;e.col3View=null;e.selector=null;e.uuid=null}})}};l.prototype.saveToLocalStorage=function f(){if(this.cache){var e={uuid:this.uuid,selector:this.selector,col2View:this.col2View,col3View:this.col3View},t=this.isValidSelection(e)?e:{};this.cache.set("synergy.hardware.selection",t,s.noop)}};l.prototype.isValidSelection=function h(e){var t=s(e).has("uuid")&&e.uuid,r=s(e).has("selector"),i=s(e).has("col2View");return t&&r&&i};t.exports=l},{"../client-cache":53,"./store":120,assert:127,util:132}],115:[function(e,t,r){"use strict";var i=e("assert"),s=e("./store"),n=e("util"),a=e("uuid"),o=window._;var l=500;function c(e){e=this.options=o.cloneDeep(e||{});i(o.isPlainObject(e));s.call(this,"LOGS");e.entryLimit=e.entryLimit||l;this._entries=[];this._confirmed=0;this._overflowed=0;this._draining=false;this._sessionId=a()}n.inherits(c,s);c.prototype.getState=function m(){return{entries:this._entries,confirmed:this._confirmed,overflowed:this._overflowed,draining:this._draining}};c.prototype.drain=function g(e){var t=this,r=this._entries.slice(this._confirmed),i={entries:r,sessionId:this._sessionId,now:h()};if(!t._draining){t._draining=true;t.changed();e(i,function s(i){if(!i){t._confirmed+=r.length}t._draining=false;if(t._confirmed<t._entries.length){t.drain(e)}t.changed()})}};c.prototype.log=function y(e,t){i.equal(arguments.length,2,"log: 2-arity");i(o.isArray(e),"tags: array of strings");i(o.every(e,o.isString),"tags: array of strings");t=u(e,t);if(this._entries.length>=this.options.entryLimit){this._entries.shift();this._overflowed++;this._confirmed=this._confirmed-1<0?0:this._confirmed-1}this._entries.push(t);this.changed()};function u(e,t){if(typeof t==="string"){return p(e,t)}else if(t instanceof Error){return d(e,t)}else if(o.isPlainObject(t)){return f(e,t)}else{i(false,"invalid log entry "+typeof t)}}function p(e,t){return{tags:e,timestamp:h(),message:t}}function d(e,t){return{tags:e,timestamp:h(),err:t.toString(),message:t.message||t.toString(),stack:t.stack}}function f(e,t){i(o.isPlainObject(t),"invalid entry");t=o.clone(t);i(!o.contains(t,"timestamp"),"no cheating: timestamps");i(!o.contains(t,"timestamp"),"no cheating: tags");t.tags=e;t.timestamp=h();return t}function h(){return Date.now()}t.exports=c},{"./store":120,assert:127,util:132,uuid:183}],116:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=e("./store"),a=e("../xhr");function o(){i(this instanceof o,"use new");this.baseURL=""}o.prototype.fetch=function c(e){var t=this.baseURL+"/motd",r={};a("GET",t,r,function(r,i){if(r){console.error(r);return e(r)}if(i.statusCode!==200){e(new Error(t+" -> "+i.statusCode))}else{var s;try{s=JSON.parse(i.body)}catch(r){e(new Error("cannot parse response"))}e(null,s)}})};function l(e){i(this instanceof l,"use new");i(!e||e instanceof Object);n.call(this,"MOTD");e=e||{};this.backEnd=e.backEnd||new o;this.content=null;this.fetching=false;this.fetched=false;this.err=null}s.inherits(l,n);l.prototype.getState=function u(){return{projects:this.projects,fetching:this.fetching,fetched:this.fetched,err:this.err}};l.prototype.MOTD_FETCH=function p(){var e=this;if(this.fetching){console.error("already fetching");return}this.fetching=true;this.err=null;this.changed();this.backEnd.fetch(function t(r,i){if(r){e.err=r}else{e.content=i;e.fetched=true}e.fetching=false;e.changed()})};t.exports=l},{"../xhr":125,"./store":120,assert:127,util:132}],117:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("uuid"),o=e("./store"),l=e("../client-cache"),c=e("../constants"),u=e("../debounce"),p=e("../request-queue");var d="New Project";function f(e){i(this instanceof f,"use new");i(typeof e==="object","need options object");i(typeof e.xhr==="function","need options.xhr");o.call(this,"PORTFOLIO");this.requestQueue=new p(e.xhr);this.debouncedRead=u(s.bind(this.requestQueue.pushToReadQueue,this.requestQueue));this.debouncedWrite=u(s.bind(this.requestQueue.pushToWriteQueue,this.requestQueue));this.cache=undefined;this.allProjects=[];this.matchingProjects=[];this.adjustingProjects={};this.errorProjects={};this.projectMap={};this.projectUuidsBeingEdited={};this.search="";this.fetching=false;this.fetched=false;this.err=null;this.restoreCacheState()}n.inherits(f,o);f.prototype.getState=function _(){return{search:this.search,projects:this.matchingProjects,fetching:this.fetching,fetched:this.fetched,projectIdsInEditMode:this.projectUuidsBeingEdited}};f.prototype.PORTFOLIO_SEARCH=function E(e){this.search=e;this.updateMatches();this.changed()};f.prototype.PORTFOLIO_ADD_NEW=function b(){var e=a(),t=(new Date).getTime();this.PORTFOLIO_ADJUST(e,null,null,{_type:"solution",_timestamp:t,_x_original_timestamp:t,_x_project_name:this.search||d,synergy_model:{hagroups:[]}})};f.prototype.PORTFOLIO_SET_NAME=function w(e,t,r){var i=e||a();this.PORTFOLIO_FETCH();this.PORTFOLIO_ADJUST(i,e,t,{_uuid:i,_version:t,_timestamp:(new Date).getTime(),_x_project_name:r})};f.prototype.PORTFOLIO_ARCHIVE=function S(e,t){var r=e||a();this.PORTFOLIO_ADJUST(r,e,t,{_uuid:r,_version:t,_timestamp:(new Date).getTime(),_x_archived:true})};f.prototype.PORTFOLIO_ADJUST=function A(e,t,r,i){var n=this,a,o;console.log("PORTFOLIO_ADJUST",e,t,r,i);delete n.errorProjects[e];n.adjustingProjects[e]={uuid:t,version:r,adjustments:i};if(s.has(this.projectMap,e)){a=this.projectMap[e];o=s.clone(a);s.merge(a,i)}else{console.log("adjusting unknown clip",e,t,this.projectMap)}n.updateMatches();n.changed();this.adjust(e,t,r,i,function l(r,i){if(r){n.errorProjects[e]=r;s.merge(a,o)}else{var l=s.find(n.allProjects,function c(t){return t._uuid&&t._uuid===e});if(l){s.merge(l,i)}else{n.allProjects=s.filter(n.allProjects,function u(t){return t._uuid!==e});n.allProjects.push(i)}n.updateLocalStorageProjects();n.updateProjectsBeingEdited(t,i)}delete n.adjustingProjects[e];n.updateMatches();n.changed()})};f.prototype.PORTFOLIO_FETCH=function C(){var e=this;if(this.fetching){console.error("already fetching");return}this.fetching=true;this.err=null;this.changed();this.list(function t(r,i){if(r){e.err=r}else{e.allProjects=i;e.updateMatches();e.fetched=true;e.updateLocalStorageProjects()}e.fetching=false;e.changed()})};function h(e,t){return(e._x_project_name||"").toLowerCase().indexOf(t)>=0}function m(e,t){return e._uuid.toLowerCase()===t}function g(e,t){var r=e._x_autotags||[];r=r.concat(e._x_usertags||[]);for(var i in r){if(r[i].toLowerCase().indexOf(t)>=0){return true}}return false}var y=[h,m,g];f.prototype.updateMatches=function T(){var e=this.search.toLowerCase(),t=this,r=this.projectMap={};this.matchingProjects=s.sortBy(s.filter(s.map(this.allProjects,function(i){r[i._uuid]=i;i=s.clone(i);i._X_STATE={adjusting:s.has(t.adjustingProjects,i._uuid),err:s.has(t.errorProjects,i._uuid)};for(var n in y){var a=y[n];if(a(i,e)){return i}}return null})),"_timestamp").reverse()};f.prototype.updateLocalStorageProjects=function R(){if(this.cache){var e=s.filter(this.allProjects,function i(e){return e&&e._x_archived?false:true});var t=s.first(s.sortBy(s.map(e,function(e){return{_timestamp:e._timestamp,_uuid:e._uuid,_version:e._version,_x_autodesc:e._x_autodesc,_x_autotags:e._x_autotags,_x_usertags:e._x_usertags,_x_project_name:e._x_project_name,_x_original_timestamp:e._x_original_timestamp}}),"_timestamp").reverse(),20);for(var r=0;r<20;r++){this.cache.remove("synergy.project."+r,s.noop)}s.forEach(t,function n(e,t){this.cache.set("synergy.project."+t,e,s.noop)},this)}};f.prototype.updateProjectsBeingEdited=function P(e,t){var r=e===null;if(r){this.projectUuidsBeingEdited[t._uuid]=true}else{delete this.projectUuidsBeingEdited[e]}};function v(e,t,r){if(e){console.error(e)}else if(t){r.push(t)}}f.prototype.restoreCacheState=function N(){var e=this;l(function(t,r){if(t){console.error(t)}else{e.cache=r}});if(this.cache){for(var t=0;t<20;t++){this.cache.get("synergy.project."+t,s.partialRight(v,this.allProjects))}this.updateMatches()}};f.prototype.list=function D(e){var t=c.PROJECT_LIST_PATH,r={};this.debouncedRead(t,{method:"GET",basePath:t,options:r},e)};f.prototype.adjust=function x(e,t,r,s,n){i(typeof e==="string","adjust: requestId string");i(typeof t==="string"||t===null,"adjust: uuid string or null");
i(typeof r==="number"||r===null,"adjust: version number or null");i(typeof s==="object"&&!(s instanceof Array),"adjust: adjustments object");var a=c.PROJECT_ADJUST_PATH,o={payload:s};this.debouncedWrite(e,{method:"POST",basePath:a,options:o},n)};t.exports=f},{"../client-cache":53,"../constants":65,"../debounce":67,"../request-queue":112,"./store":120,assert:127,util:132,uuid:183}],118:[function(e,t,r){"use strict";var i=e("assert"),s=e("async"),n=e("lz-string"),a=e("util"),o=e("./store"),l=e("../client-cache"),c=e("../constants"),u=e("../prodinfo");var p="prod-info";function d(e){i(this instanceof d,"use new");i.equal(typeof(this.log=e.log),"function","options.log");i.equal(typeof(this.xhr=e.xhr),"function","options.xhr")}d.prototype.getRawProdInfo=function h(e){var t=this.log,r=this.xhr;return s.auto({cache:[i],cached:["cache",n],served:["cached",a],winner:["cached","served",o],recached:["cache","served",u]},function(r,i){if(r){t([p,p+"-fatal"],r);return e(r)}else{return e(null,i.winner)}});function i(e){return l(r);function r(r,i){t([p,"client-cache"],{available:!!!r});e(null,r?null:i)}}function n(e,r){if(!r.cache){return setImmediate(e,null,null)}t([p,"client-cache-get"],"loading...");return r.cache.get("synergy.prodinfo",i);function i(r,i){if(r){t(["client-cache-pre-miss"],r);return e(null,null)}else{t(["client-cache-pre-hit"],"loaded");return e(null,i)}}}function a(e,i){var s=i.cache&&i.cached,n=s?i.cached.digest:"",a=c.PLATFORM_OPTIONS_GET_PATH;if(n){a=a+"/"+n}t(["client-fetch"],{previous:n});return r("GET",a,{},function(r,i){t(["client-fetch","response"],{err:r,body:typeof i});if(r){return e(r)}var s;if(typeof i.body==="string"){try{s=JSON.parse(i.body)}catch(n){return e(n)}return e(null,s)}else if(typeof i.body==="object"){return e(null,i.body)}else{return e(new Error("server response"))}})}function o(e,r){var i=r.cached&&typeof r.cached==="object",s=i&&!r.served.options,n="client-cache-"+(s?"hit":"miss"),a=s?r.cached.options:r.served.options;t([p,n],{length:a.length});e(null,a)}function u(e,r){if(!r.cache||!r.served.options){return setImmediate(e,null,null)}t([p,"client-cache-set"],"saving new product info...");r.cache.set("synergy.prodinfo",r.served,e)}};function f(e){i(this instanceof f,"use new");i.equal(typeof e,"object","options object");i.equal(typeof e.xhr,"function","options.xhr");i.equal(typeof e.log,"function","options.log");o.call(this,"PRODUCTINFO");this.backEnd=e.backEnd||new d(e);this.log=e.log;this.fetching=false;this.fetched=false;this.err=null;this.platformConfigData=null}a.inherits(f,o);f.prototype.getState=function m(){return{productInfo:this._productInfo,fetching:this.fetching,fetched:this.fetched,err:this.err}};f.prototype.PRODUCTINFO_FETCH=function g(){var e=this,t=this.log;if(e.fetching){console.error("already fetching");return}e.fetching=e.fetched?false:true;e.err=null;e.changed();e.backEnd.getRawProdInfo(function r(i,s){var a=Date.now();function o(){var e=Date.now(),t=e-a;a=e;return{elapsed:t}}if(i){e.err=i}else{try{t([p,p+"-extract"],"extracting...");var l=n.decompressFromBase64(s);t([p,p+"-parse"],o());var c=JSON.parse(l);t([p,p+"-inhale"],o());e._productInfo=new u(c);e._productInfo.inhale(f)}catch(d){f(d)}}function f(r){if(r){t([p,p+"-fatal"],r);e.err=r}else{t([p,p+"-ready"],o());e.fetched=true}e.fetching=false;e.changed()}})};t.exports=f},{"../client-cache":53,"../constants":65,"../prodinfo":109,"./store":120,assert:127,async:126,"lz-string":133,util:132}],119:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("./store"),o=e("../clip/reduce"),l=e("../constants"),c=e("../debounce"),u=e("../model/builder"),p=e("../model/map"),d=e("../request-queue");function f(){i(this instanceof f,"use new");this.baseURL=""}f.prototype.load=function m(e,t,r){var i=l.PROJECT_LOAD_PATH,n=s.filter([i,e,t]),a=this.baseURL+n.join("/"),o={};this.debouncedRead(a,{method:"GET",basePath:a,options:o},r)};function h(e){i(this instanceof h,"use new");i(s.isPlainObject(e));i(e.productInfo);i(typeof e.xhr==="function","need options.xhr");a.call(this,"PROJECT");this.backEnd=e.backEnd||new f;this.productInfoStore=e.productInfo;this.requestQueue=new d(e.xhr);this.backEnd.debouncedRead=c(s.bind(this.requestQueue.pushToReadQueue,this.requestQueue));this.debouncedWrite=c(s.bind(this.requestQueue.pushToWriteQueue,this.requestQueue));this._unload()}n.inherits(h,a);h.prototype.getState=function g(){return{uuid:this.clip?this.clip._uuid||"":"",name:this.clip?this.clip._x_project_name||"":"",map:this.map.bind(this),actions:this.actions,err:this.err,fetching:this.fetching,fetched:this.fetched,queueStatus:this.requestQueue.queueStatus()}};h.prototype.map=function y(){if(this.clip){if(!this._modelMap){var e=this.productInfoStore.getState().productInfo;this._modelMap=new p(e,this.clip);this._builder=new u(e,this.clip)}return this._modelMap}else{return null}};h.prototype._unload=function v(){this.clip=null;this.actions=null;this.err=null;this.fetched=false;this.fetching=false};h.prototype._clearCaches=function _(){delete this._modelMap};h.prototype._save=function E(){var e=o(this.clip);var t=l.PROJECT_REPLACE_PATH,r={payload:e},i=this;this.debouncedWrite(this.clip._uuid,{method:"POST",basePath:t,options:r},function(e,t){if(!e&&t){i.clip._uuid=t._uuid||i.clip._uuid;i.clip._version=t._version||i.clip._version;i.clip._timestamp=t._timestamp&&t._timestamp>i.clip._timestamp?t._timestamp:i.clip._timestamp;i.changed()}});this.changed()};h.prototype.PROJECT_UNLOAD=function b(e){if(this.clip&&this.clip._uuid===e){this._unload();this.changed()}};h.prototype.PROJECT_LOAD=function w(e,t){var r=this;if(r.fetching){console.error("already fetching");return}r._unload();r.fetching=true;r.changed();this.backEnd.load(e,t,function i(e,t){if(e){r.err=e}else{r.clip=t;r.fetched=true}r.fetching=false;r.changed()})};h.prototype.PROJECT_ADD_STANDALONE=function S(e,t){var r=this._builder.addSystem(e);this._save();t(null,r)};h.prototype.PROJECT_ADD_CLUSTER=function A(e,t){var r=this._builder.addSystemToCluster(e);this._save();t(null,r)};h.prototype.PROJECT_EXPAND_CLUSTER=function C(e,t){this._builder.addSystemToCluster(t,e);this._save()};h.prototype.PROJECT_CHANGE_SYSTEMS=function T(e){this._builder.changeSystems(e);this._save()};h.prototype.PROJECT_REMOVE_SYSTEM=function R(e){this._builder.removeSystem(e);this._save()};h.prototype.PROJECT_NAME_CLUSTER=function P(e,t){this._builder.nameCluster(e,t);this._save()};h.prototype.PROJECT_NAME_CONTROLLERS=function N(e,t,r){this._builder.nameSystem(e,t,r);this._save()};h.prototype.PROJECT_DELETE_SHELF=function D(e,t){this._builder.deleteShelf(e,t);this._save()};h.prototype.PROJECT_DELETE_SHELVES=function x(e,t){this._builder.deleteAllShelves(e,t);this._save()};h.prototype.PROJECT_REBUILD_AUTO_AGGREGATES=function k(e){this._builder.rebuildAutoAggregates(e);this._save()};h.prototype.PROJECT_ADD_MANUAL_AGGREGATE=function O(e,t,r){this._builder.addManualAggregate(e,t);r(t);this._save()};h.prototype.PROJECT_DELETE_AGGREGATE=function I(e,t){this._builder.deleteAggregate(e,t);this._save()};h.prototype.PROJECT_DELETE_ALL_AGGREGATES=function M(e){this._builder.deleteAllAggregates(e);this._save()};h.prototype.PROJECT_SET_SYSTEM_POLICY=function F(e,t,r){this._builder.setSystemPolicy(e,t,r);this._save()};h.prototype.PROJECT_SET_CLUSTER_POLICY=function q(e,t,r){this._builder.setClusterPolicy(e,t,r);this._save()};h.prototype.PROJECT_FP_ADD_POOL=function L(e,t,r,i){this._builder.addStoragePool(e,t,r,i,true);this._save()};h.prototype.PROJECT_FP_RESIZE_POOL=function j(e,t){this._builder.resizeStoragePool(e,t);this._save()};h.prototype.PROJECT_FP_CLAIM=function B(e,t,r,i){this._builder.claimAllocationUnit(e,t,r,i);this._save()};h.prototype.PROJECT_FP_RELEASE=function X(e,t,r){this._builder.releaseAllocationUnit(e,t,r);this._save()};h.prototype.PROJECT_FP_DEL_POOL=function G(e){this._builder.deleteStoragePool(e);this._save()};h.prototype.PROJECT_FP_ADD_AGGR_RG=function U(e,t,r,i){this._builder.addFlashPoolRaidGroupToAggregate(e,t,r,i);this._save()};h.prototype.PROJECT_FP_DEL_AGGR_RG=function V(e){this._builder.deleteFlashPoolRaidGroupFromAggregate(e);this._save()};h.prototype.PROJECT_SET_CLUSTER_VERSION=function H(e,t){this._builder.setClusterVersion(e,t);this._save()};h.prototype.PROJECT_SET_SYSTEM_VERSION=function Y(e,t){this._builder.setSystemVersion(e,t);this._save()};t.exports=h},{"../clip/reduce":57,"../constants":65,"../debounce":67,"../model/builder":92,"../model/map":102,"../request-queue":112,"./store":120,assert:127,util:132}],120:[function(e,t,r){"use strict";var i=e("assert"),s=e("events"),n;var a="change";function o(e){var t=[];for(var r=1;r<e.length;r++){t.push(e[r])}return t}function l(e){i(this instanceof l,"use new");i(typeof e==="string"&&e.match(/[A-Z]+/));this._guard=null;this._prefix=e;this._emitter=new s.EventEmitter;this.name=e.toLowerCase()}l.prototype.changed=function c(){this._clearCaches();this._emitter.emit(a)};l.prototype.watch=function u(e){this._emitter.on(a,e)};l.prototype.unwatch=function p(e){this._emitter.removeListener(a,e)};l.prototype.getState=function d(){throw new Error("subclass forgot to override getState")};l.prototype._clearCaches=function f(){};l.prototype.getGuard=function h(){i(this._guard!==undefined,"Store constructor not called");if(this._guard===null){this._guard=new n(this)}return this._guard};l.prototype.act=function m(e){i(typeof e==="string","need action ID");if(e.indexOf(this._prefix+"_")<0){return false}var t=this[e];i(typeof t==="function","invalid action: "+e);i(arguments.length===t.length+1,"invalid arg count");t.apply(this,o(arguments));return true};n=function g(e){i(this instanceof g,"use new");i(e instanceof l,"need Store to guard");this.act=e.act.bind(e);this.getState=e.getState.bind(e);this.watch=e.watch.bind(e);this.unwatch=e.unwatch.bind(e);this.name=e.name};n.prototype.getGuard=function y(){return this};t.exports=l},{assert:127,events:128}],121:[function(e,t,r){"use strict";var i=e("assert"),s=window._,n=e("util"),a=e("./store"),o=e("../client-cache");var l={collapseCapacity:false,collapseClusters:false,currentSystemsView:false,useBase10Yields:false,mainsVoltage:"v_200"},c=s.keys(l),u="synergy.preferences.user";function p(e){i(this instanceof p,"use new");i.equal(typeof(this.log=e.log),"function","options.log");a.call(this,"USER_PREFERENCES");this.cache=undefined;this.prefs=s.clone(l);var t=this;o(function r(e,i){if(e){console.error(e)}else{t.cache=i;t.restoreCacheState()}})}n.inherits(p,a);p.prototype.getState=function d(){var e=s.defaults({},this.prefs,l);return e};p.prototype.USER_PREFERENCES_ADJUST=function f(e){var t=s.keys(s.omit(e,c));if(s.keys(t).length){this.log.warn("ignoring unknown user preference adjustments",t)}s.merge(this.prefs,s.pick(e,c));this.updateLocalStoragePrefs();this.changed()};p.prototype.restoreCacheState=function h(){if(this.cache){var e=this;this.log(["prefs","loading"],"...");this.cache.get(u,function t(r,i){if(r){e.log(["prefs","load-failed"],r)}else{e.log(["prefs","loaded"],{prefs:i});e.prefs=i||{}}})}};p.prototype.updateLocalStoragePrefs=function m(){if(this.cache){var e=this;this.log(["prefs","saving"],"...");this.cache.set(u,this.prefs,function(t){if(t){e.log(["prefs","save-failed"],t)}else{e.log(["prefs","saved"],"...")}})}};t.exports=p},{"../client-cache":53,"./store":120,assert:127,util:132}],122:[function(e,t,r){"use strict";var i=e("assert"),s=e("util"),n=e("./store"),a=e("../xhr");function o(){i(this instanceof o,"use new");this.baseURL=""}o.prototype.fetch=function c(e){var t=this.baseURL+"/whoami",r={};a("GET",t,r,function(r,i){if(r){console.error(r);return e(r)}if(i.statusCode!==200){e(new Error(t+" -> "+i.statusCode))}else{var s;try{s=JSON.parse(i.body)}catch(r){e(new Error("cannot parse response"))}e(null,s)}})};function l(e){i(this instanceof l,"use new");i(!e||e instanceof Object);n.call(this,"USER_SESSION");e=e||{};this.backEnd=e.backEnd||new o;this.content=null;this.fetching=false;this.fetched=false;this.err=null;this.firstName="";this.sessionExpirationUTC=2534022324e5;this.authenticatedServerTimeUTC=(new Date).getTime();this.authenticatedClientTimeUTC=(new Date).getTime();this.currentClientTimeUTC=(new Date).getTime();this.timestampDelta=this.authenticatedClientTimeUTC-this.authenticatedServerTimeUTC}s.inherits(l,n);l.prototype.getState=function u(){if(this.content){this.firstName=this.content.firstName||this.firstName;this.sessionExpirationUTC=this.content.expires;this.authenticatedClientTimeUTC=this.content.clientTime;this.authenticatedServerTimeUTC=this.content.serverTime}this.currentClientTimeUTC=(new Date).getTime();this.timestampDelta=0;return{firstName:this.firstName,expires:this.sessionExpirationUTC,now:this.currentClientTimeUTC-this.timestampDelta,isExpired:this.isExpired()}};l.prototype.isExpired=function p(){return this.currentClientTimeUTC-this.timestampDelta>this.sessionExpirationUTC};l.prototype.calculateTimestampDelta=function d(e,t){return e-t};l.prototype.USER_SESSION_FETCH=function f(){var e=this;if(this.fetching){console.error("already fetching");return}this.fetching=true;this.err=null;this.changed();this.backEnd.fetch(function t(r,i){if(r){e.err=r}else{e.content=i;e.timestampDelta=e.calculateTimestampDelta(i.clientTime,i.serverTime);e.fetched=true}e.fetching=false;e.changed()})};t.exports=l},{"../xhr":125,"./store":120,assert:127,util:132}],123:[function(e,t,r){"use strict";var i=window._,s=e("assert"),n=e("util");function a(e,t){if(!(this instanceof a)){return new a(e)}if(!t){t=this.DEFAULTS.type}if(e!==0&&!e){e=this.DEFAULTS.modifier}s(e>=0,"Unit value cannot be negative");var r=this._findUnitType(t);i.merge(this,this._packageUnit(r.type,r.name,e,r.unit.base,r.unit.pow));i.merge(this,{value_gb:this._inGb()})}a.prototype.to=function(e){if(!i.isObject(e)&&i.isString(e)){e=this._findUnitType(e)}var t=this._convert(e);return new a(t.value,e)};a.prototype.add=function(e){this._assertIsUnitObject(e);var t=this.value_gb+e.value_gb;return this._packAndReturnArithmeticResult(t)};a.prototype.subtract=function(e){this._assertIsUnitObject(e);var t=this.value_gb-e.value_gb;return this._packAndReturnArithmeticResult(t)};a.prototype.mult=function(e){var t=this.value_gb*e;return this._packAndReturnArithmeticResult(t)};a.prototype.divide=function(e){var t=this.value_gb/e;return this._packAndReturnArithmeticResult(t)};a.prototype.makeHappyFriendly=function(e,t,r){var s=this;var n=null,a=i.where(this.TYPES,function(e){return e.unit.base===s.unit.base});i.forEach(a,function(e){var t=s.to(e.type);if(t.value<1e3&&!n){n=t}});if(n){return n.friendly(e,t,r)}else{return"Unknown"}};a.prototype.friendly=function(e,t,r){var i=r||this.DEFAULTS.friendly.formatString,s=e||this.DEFAULTS.friendly.toPlaces,a=t||this.DEFAULTS.friendly.useName,o=this.value,l=this.type;if(e===0){s=e}if(o>0&&o%1!==0){o=o.toFixed(s)}if(a){var c="s";if(o===1){c=""}l=n.format("%s%s",this.name,c)}return n.format(i,o,l)};a.prototype.types=function(){return i.map(this.TYPES,function(e){return{type:e.type,name:e.name,base:e.unit.base}})};a.prototype._packAndReturnArithmeticResult=function(e){return new a(e).to(this.type)};a.prototype._assertIsUnitObject=function(e){s(e instanceof a,"You must provide a Unit object to arithmetic operators.")};a.prototype._findUnitType=function(e){if(i.isObject(e)){return e}var t=i.first(i.where(this.TYPES,function(t){return t.type===e}));s(t,n.format("No matching unit of type %s",e));return t};a.prototype._convert=function(e){var t=Math.pow(this.unit.base,this.unit.pow)/Math.pow(e.unit.base,e.unit.pow);return{value:this.value*t,from:this}};a.prototype._inGb=function(){var e=this._findUnitType("GB");return this._convert(e).value};a.prototype._packageUnit=function(e,t,r,i,s){return{value:r,type:e,name:t,unit:{base:i,pow:s}}};a.prototype.DEFAULTS={type:"GB",modifier:0,friendly:{toPlaces:2,useName:false,formatString:"%d %s"}};a.prototype.TYPES=[{type:"B",name:"Byte",unit:{base:2,pow:1}},{type:"KB",name:"Kilobyte",unit:{base:10,pow:3}},{type:"KiB",name:"Kibibyte",unit:{base:2,pow:10}},{type:"MB",name:"Megabyte",unit:{base:10,pow:6}},{type:"MiB",name:"Mibibyte",unit:{base:2,pow:20}},{type:"GB",name:"Gigabyte",unit:{base:10,pow:9}},{type:"GiB",name:"Gibibyte",unit:{base:2,pow:30}},{type:"TB",name:"Terabyte",unit:{base:10,pow:12}},{type:"TiB",name:"Tibibyte",unit:{base:2,pow:40}},{type:"PB",name:"Petabyte",unit:{base:10,pow:15}},{type:"PiB",name:"Pebibyte",unit:{base:2,pow:50}}];t.exports=a},{assert:127,util:132}],124:[function(e,t,r){"use strict";var i=window._,s=e("assert");function n(e,t,r,a){if(arguments.length===2){return i.partial(n,e,t)}if(r===undefined){return r}if(arguments.length>3){t=t+"["+a+"]"}var o={};for(var l in e){var c=t+"."+l,u=e[l],p=r[l];if(!i.has(r,l)&&typeof u==="boolean"){}else if(u===true){if(!i.has(r,l)){}if(p===null||p===undefined){o[l]=p}else{s(!(p instanceof Array),c+": array needs spec");s.notEqual(typeof p,"object",c+": object needs spec");o[l]=p}}else if(u===false){}else if(typeof u==="function"){o[l]=u(p,c)}else if(u instanceof Array){s(u.length===1,c+": array specs must have one member");var d=u[0];if(p===undefined||l===null){o[l]=p}else{s(p instanceof Array,c+": value not an array");if(i.isPlainObject(d)){o[l]=i.map(p,n(d,c))}else if(typeof d==="function"){o[l]=i.map(p,d)}else{s(false,c+": invalid array spec")}}}else if(i.isPlainObject(u)){o[l]=n(u,c,p)}else{try{console.error("invalid spec:",u)}catch(f){}s(false,c+": invalid spec")}}return o}function a(e,t,r){if(arguments.length===1){return i.partial(a,e)}if(arguments.length===2&&typeof t==="string"){return i.partial(n,e,r)}return n(e,r||"top",t)}function o(e,t){if(typeof e==="function"){s.notEqual(t,undefined,"need expectedType for function defaults");return i}else{t=t||typeof e;s.equal(typeof e,t,"default type mismatch");return r}function r(r,i){if(r===undefined){return e}else{return n(r,i,t)}}function i(r,i){if(r===undefined){return n(e(),i,t," from default function")}else{return n(r,i,t)}}function n(e,t,r,i){i=i||"";if(typeof r==="function"){try{return r(e,t)}catch(n){if(n.message&&n.message.indexOf(t)===0){throw n}else{var a=n.message||n.toString(),o=new Error(t+": "+a+i);o.original=n;throw o}}}else{s.equal(typeof e,r,t+": type mismatch"+i);return e}}}function l(e){var t=JSON.stringify(e);return function r(i,n){if(i===undefined){return e}else{s.equal(i,e,n+" !== "+t);return i}}}a.setdefault=o;a.constant=l;t.exports=a},{assert:127}],125:[function(e,t,r){"use strict";var i=e("assert");function s(e,t,r,s){i.equal(typeof e,"string");i.equal(typeof t,"string");i.equal(typeof r,"object");i.equal(typeof s,"function");var n=r.headers||{},a=new XMLHttpRequest,o,l=r.payload;a.open(e,t,true);for(var c in r.headers){a.setRequestHeader(c,n[c]);if(c.toLowerCase()==="content-type"){o=n[c]}}if(l){if(e.toLowerCase()!=="post"){console.error("xhr: payload set on non-POST")}if(typeof l==="object"){l=JSON.stringify(l);if(o){console.error("xhr: content-type set for object POST")}else{o="application/json";a.setRequestHeader("content-type",o)}}else{if(!o){console.error("xhr: content-type not set for POST")}}}else{if(e.toLowerCase()==="post"){console.error("xhr: payload absent on POST")}}a.ontimeout=function u(){s(new Error("request timed out"))};a.onreadystatechange=function p(){if(a.readyState!==4){return}s(null,{statusCode:a.status,body:a.responseText,bodyType:a.responseType,headers:a.getAllResponseHeaders()})};if(e==="POST"||e==="PUT"){a.send(l||"")}else{a.send()}}t.exports=s},{assert:127}],126:[function(e,t,r){(function(e){(function(){var r={};var i,s;i=this;if(i!=null){s=i.async}r.noConflict=function(){i.async=s;return r};function n(e){var t=false;return function(){if(t)throw new Error("Callback was already called.");t=true;e.apply(i,arguments)}}var a=Object.prototype.toString;var o=Array.isArray||function(e){return a.call(e)==="[object Array]"};var l=function(e,t){if(e.forEach){return e.forEach(t)}for(var r=0;r<e.length;r+=1){t(e[r],r,e)}};var c=function(e,t){if(e.map){return e.map(t)}var r=[];l(e,function(e,i,s){r.push(t(e,i,s))});return r};var u=function(e,t,r){if(e.reduce){return e.reduce(t,r)}l(e,function(e,i,s){r=t(r,e,i,s)});return r};var p=function(e){if(Object.keys){return Object.keys(e)}var t=[];for(var r in e){if(e.hasOwnProperty(r)){t.push(r)}}return t};if(typeof e==="undefined"||!e.nextTick){if(typeof setImmediate==="function"){r.nextTick=function(e){setImmediate(e)};r.setImmediate=r.nextTick}else{r.nextTick=function(e){setTimeout(e,0)};r.setImmediate=r.nextTick}}else{r.nextTick=e.nextTick;if(typeof setImmediate!=="undefined"){r.setImmediate=function(e){setImmediate(e)}}else{r.setImmediate=r.nextTick}}r.each=function(e,t,r){r=r||function(){};if(!e.length){return r()}var i=0;l(e,function(e){t(e,n(s))});function s(t){if(t){r(t);r=function(){}}else{i+=1;if(i>=e.length){r()}}}};r.forEach=r.each;r.eachSeries=function(e,t,r){r=r||function(){};if(!e.length){return r()}var i=0;var s=function(){t(e[i],function(t){if(t){r(t);r=function(){}}else{i+=1;if(i>=e.length){r()}else{s()}}})};s()};r.forEachSeries=r.eachSeries;r.eachLimit=function(e,t,r,i){var s=d(t);s.apply(null,[e,r,i])};r.forEachLimit=r.eachLimit;var d=function(e){return function(t,r,i){i=i||function(){};if(!t.length||e<=0){return i()}var s=0;var n=0;var a=0;(function o(){if(s>=t.length){return i()}while(a<e&&n<t.length){n+=1;a+=1;r(t[n-1],function(e){if(e){i(e);i=function(){}}else{s+=1;a-=1;if(s>=t.length){i()}else{o()}}})}})()}};var f=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[r.each].concat(t))}};var h=function(e,t){return function(){var r=Array.prototype.slice.call(arguments);return t.apply(null,[d(e)].concat(r))}};var m=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[r.eachSeries].concat(t))}};var g=function(e,t,r,i){t=c(t,function(e,t){return{index:t,value:e}});if(!i){e(t,function(e,t){r(e.value,function(e){t(e)})})}else{var s=[];e(t,function(e,t){r(e.value,function(r,i){s[e.index]=i;t(r)})},function(e){i(e,s)})}};r.map=f(g);r.mapSeries=m(g);r.mapLimit=function(e,t,r,i){return y(t)(e,r,i)};var y=function(e){return h(e,g)};r.reduce=function(e,t,i,s){r.eachSeries(e,function(e,r){i(t,e,function(e,i){t=i;r(e)})},function(e){s(e,t)})};r.inject=r.reduce;r.foldl=r.reduce;r.reduceRight=function(e,t,i,s){var n=c(e,function(e){return e}).reverse();r.reduce(n,t,i,s)};r.foldr=r.reduceRight;var v=function(e,t,r,i){var s=[];t=c(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){r(e.value,function(r){if(r){s.push(e)}t()})},function(e){i(c(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};r.filter=f(v);r.filterSeries=m(v);r.select=r.filter;r.selectSeries=r.filterSeries;var _=function(e,t,r,i){var s=[];t=c(t,function(e,t){return{index:t,value:e}});e(t,function(e,t){r(e.value,function(r){if(!r){s.push(e)}t()})},function(e){i(c(s.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};r.reject=f(_);r.rejectSeries=m(_);var E=function(e,t,r,i){e(t,function(e,t){r(e,function(r){if(r){i(e);i=function(){}}else{t()}})},function(e){i()})};r.detect=f(E);r.detectSeries=m(E);r.some=function(e,t,i){r.each(e,function(e,r){t(e,function(e){if(e){i(true);i=function(){}}r()})},function(e){i(false)})};r.any=r.some;r.every=function(e,t,i){r.each(e,function(e,r){t(e,function(e){if(!e){i(false);i=function(){}}r()})},function(e){i(true)})};r.all=r.every;r.sortBy=function(e,t,i){r.map(e,function(e,r){t(e,function(t,i){if(t){r(t)}else{r(null,{value:e,criteria:i})}})},function(e,t){if(e){return i(e)}else{var r=function(e,t){var r=e.criteria,i=t.criteria;return r<i?-1:r>i?1:0};i(null,c(t.sort(r),function(e){return e.value}))}})};r.auto=function(e,t){t=t||function(){};var i=p(e);var s=i.length;if(!s){return t()}var n={};var a=[];var c=function(e){a.unshift(e)};var d=function(e){for(var t=0;t<a.length;t+=1){if(a[t]===e){a.splice(t,1);return}}};var f=function(){s--;l(a.slice(0),function(e){e()})};c(function(){if(!s){var e=t;t=function(){};e(null,n)}});l(i,function(i){var s=o(e[i])?e[i]:[e[i]];var a=function(e){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1){s=s[0]}if(e){var a={};l(p(n),function(e){a[e]=n[e]});a[i]=s;t(e,a);t=function(){}}else{n[i]=s;r.setImmediate(f)}};var h=s.slice(0,Math.abs(s.length-1))||[];var m=function(){return u(h,function(e,t){return e&&n.hasOwnProperty(t)},true)&&!n.hasOwnProperty(i)};if(m()){s[s.length-1](a,n)}else{var g=function(){if(m()){d(g);s[s.length-1](a,n)}};c(g)}})};r.retry=function(e,t,i){var s=5;var n=[];if(typeof e==="function"){i=t;t=e;e=s}e=parseInt(e,10)||s;var a=function(s,a){var o=function(e,t){return function(r){e(function(e,i){r(!e||t,{err:e,result:i})},a)}};while(e){n.push(o(t,!(e-=1)))}r.series(n,function(e,t){t=t[t.length-1];(s||i)(t.err,t.result)})};return i?a():a};r.waterfall=function(e,t){t=t||function(){};if(!o(e)){var i=new Error("First argument to waterfall must be an array of functions");return t(i)}if(!e.length){return t()}var s=function(e){return function(i){if(i){t.apply(null,arguments);t=function(){}}else{var n=Array.prototype.slice.call(arguments,1);var a=e.next();if(a){n.push(s(a))}else{n.push(t)}r.setImmediate(function(){e.apply(null,n)})}}};s(r.iterator(e))()};var b=function(e,t,r){r=r||function(){};if(o(t)){e.map(t,function(e,t){if(e){e(function(e){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}t.call(null,e,r)})}},r)}else{var i={};e.each(p(t),function(e,r){t[e](function(t){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1){s=s[0]}i[e]=s;r(t)})},function(e){r(e,i)})}};r.parallel=function(e,t){b({map:r.map,each:r.each},e,t)};r.parallelLimit=function(e,t,r){b({map:y(t),each:d(t)},e,r)};r.series=function(e,t){t=t||function(){};if(o(e)){r.mapSeries(e,function(e,t){if(e){e(function(e){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}t.call(null,e,r)})}},t)}else{var i={};r.eachSeries(p(e),function(t,r){e[t](function(e){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1){s=s[0]}i[t]=s;r(e)})},function(e){t(e,i)})}};r.iterator=function(e){var t=function(r){var i=function(){if(e.length){e[r].apply(null,arguments)}return i.next()};i.next=function(){return r<e.length-1?t(r+1):null};return i};return t(0)};r.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var w=function(e,t,r,i){var s=[];e(t,function(e,t){r(e,function(e,r){s=s.concat(r||[]);t(e)})},function(e){i(e,s)})};r.concat=f(w);r.concatSeries=m(w);r.whilst=function(e,t,i){if(e()){t(function(s){if(s){return i(s)}r.whilst(e,t,i)})}else{i()}};r.doWhilst=function(e,t,i){e(function(s){if(s){return i(s)}var n=Array.prototype.slice.call(arguments,1);if(t.apply(null,n)){r.doWhilst(e,t,i)}else{i()}})};r.until=function(e,t,i){if(!e()){t(function(s){if(s){return i(s)}r.until(e,t,i)})}else{i()}};r.doUntil=function(e,t,i){e(function(s){if(s){return i(s)}var n=Array.prototype.slice.call(arguments,1);if(!t.apply(null,n)){r.doUntil(e,t,i)}else{i()}})};r.queue=function(e,t){if(t===undefined){t=1}function i(e,t,i,s){if(!e.started){e.started=true}if(!o(t)){t=[t]}if(t.length==0){return r.setImmediate(function(){if(e.drain){e.drain()}})}l(t,function(t){var n={data:t,callback:typeof s==="function"?s:null};if(i){e.tasks.unshift(n)}else{e.tasks.push(n)}if(e.saturated&&e.tasks.length===e.concurrency){e.saturated()}r.setImmediate(e.process)})}var s=0;var a={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:false,paused:false,push:function(e,t){i(a,e,false,t)},kill:function(){a.drain=null;a.tasks=[]},unshift:function(e,t){i(a,e,true,t)},process:function(){if(!a.paused&&s<a.concurrency&&a.tasks.length){var t=a.tasks.shift();if(a.empty&&a.tasks.length===0){a.empty()}s+=1;var r=function(){s-=1;if(t.callback){t.callback.apply(t,arguments)}if(a.drain&&a.tasks.length+s===0){a.drain()}a.process()};var i=n(r);e(t.data,i)}},length:function(){return a.tasks.length},running:function(){return s},idle:function(){return a.tasks.length+s===0},pause:function(){if(a.paused===true){return}a.paused=true;a.process()},resume:function(){if(a.paused===false){return}a.paused=false;a.process()}};return a};r.priorityQueue=function(e,t){function i(e,t){return e.priority-t.priority}function s(e,t,r){var i=-1,s=e.length-1;while(i<s){var n=i+(s-i+1>>>1);if(r(t,e[n])>=0){i=n}else{s=n-1}}return i}function n(e,t,n,a){if(!e.started){e.started=true}if(!o(t)){t=[t]}if(t.length==0){return r.setImmediate(function(){if(e.drain){e.drain()}})}l(t,function(t){var o={data:t,priority:n,callback:typeof a==="function"?a:null};e.tasks.splice(s(e.tasks,o,i)+1,0,o);if(e.saturated&&e.tasks.length===e.concurrency){e.saturated()}r.setImmediate(e.process)})}var a=r.queue(e,t);a.push=function(e,t,r){n(a,e,t,r)};delete a.unshift;return a};r.cargo=function(e,t){var i=false,s=[];var n={tasks:s,payload:t,saturated:null,empty:null,drain:null,drained:true,push:function(e,i){if(!o(e)){e=[e]}l(e,function(e){s.push({data:e,callback:typeof i==="function"?i:null});n.drained=false;if(n.saturated&&s.length===t){n.saturated()}});r.setImmediate(n.process)},process:function a(){if(i)return;if(s.length===0){if(n.drain&&!n.drained)n.drain();n.drained=true;return}var r=typeof t==="number"?s.splice(0,t):s.splice(0,s.length);var o=c(r,function(e){return e.data});if(n.empty)n.empty();i=true;e(o,function(){i=false;var e=arguments;l(r,function(t){if(t.callback){t.callback.apply(null,e)}});a()})},length:function(){return s.length},running:function(){return i}};return n};var S=function(e){return function(t){var r=Array.prototype.slice.call(arguments,1);t.apply(null,r.concat([function(t){var r=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(t){if(console.error){console.error(t)}}else if(console[e]){l(r,function(t){console[e](t)})}}}]))}};r.log=S("log");r.dir=S("dir");r.memoize=function(e,t){var i={};var s={};t=t||function(e){return e};var n=function(){var n=Array.prototype.slice.call(arguments);var a=n.pop();var o=t.apply(null,n);if(o in i){r.nextTick(function(){a.apply(null,i[o])})}else if(o in s){s[o].push(a)}else{s[o]=[a];e.apply(null,n.concat([function(){i[o]=arguments;var e=s[o];delete s[o];for(var t=0,r=e.length;t<r;t++){e[t].apply(null,arguments)}}]))}};n.memo=i;n.unmemoized=e;return n};r.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}};r.times=function(e,t,i){var s=[];for(var n=0;n<e;n++){s.push(n)}return r.map(s,t,i)};r.timesSeries=function(e,t,i){var s=[];for(var n=0;n<e;n++){s.push(n)}return r.mapSeries(s,t,i)};r.seq=function(){var e=arguments;return function(){var t=this;var i=Array.prototype.slice.call(arguments);var s=i.pop();r.reduce(e,i,function(e,r,i){r.apply(t,e.concat([function(){var e=arguments[0];var t=Array.prototype.slice.call(arguments,1);i(e,t)}]))},function(e,r){s.apply(t,[e].concat(r))})}};r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var A=function(e,t){var r=function(){var r=this;var i=Array.prototype.slice.call(arguments);var s=i.pop();return e(t,function(e,t){e.apply(r,i.concat([t]))},s)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return r.apply(this,i)}else{return r}};r.applyEach=f(A);r.applyEachSeries=m(A);r.forever=function(e,t){function r(i){if(i){if(t){return t(i)}throw i}e(r)}r()};if(typeof t!=="undefined"&&t.exports){t.exports=r}else if(typeof define!=="undefined"&&define.amd){define([],function(){return r})}else{i.async=r}})()}).call(this,e("_process"))},{_process:130}],127:[function(e,t,r){var i=e("util/");var s=Array.prototype.slice;var n=Object.prototype.hasOwnProperty;var a=t.exports=p;a.AssertionError=function v(e){this.name="AssertionError";this.actual=e.actual;this.expected=e.expected;this.operator=e.operator;if(e.message){this.message=e.message;this.generatedMessage=false}else{this.message=c(this);this.generatedMessage=true}var t=e.stackStartFunction||u;if(Error.captureStackTrace){Error.captureStackTrace(this,t)}else{var r=new Error;if(r.stack){var i=r.stack;
var s=t.name;var n=i.indexOf("\n"+s);if(n>=0){var a=i.indexOf("\n",n+1);i=i.substring(a+1)}this.stack=i}}};i.inherits(a.AssertionError,Error);function o(e,t){if(i.isUndefined(t)){return""+t}if(i.isNumber(t)&&!isFinite(t)){return t.toString()}if(i.isFunction(t)||i.isRegExp(t)){return t.toString()}return t}function l(e,t){if(i.isString(e)){return e.length<t?e:e.slice(0,t)}else{return e}}function c(e){return l(JSON.stringify(e.actual,o),128)+" "+e.operator+" "+l(JSON.stringify(e.expected,o),128)}function u(e,t,r,i,s){throw new a.AssertionError({message:r,actual:e,expected:t,operator:i,stackStartFunction:s})}a.fail=u;function p(e,t){if(!e)u(e,true,t,"==",a.ok)}a.ok=p;a.equal=function _(e,t,r){if(e!=t)u(e,t,r,"==",a.equal)};a.notEqual=function E(e,t,r){if(e==t){u(e,t,r,"!=",a.notEqual)}};a.deepEqual=function b(e,t,r){if(!d(e,t)){u(e,t,r,"deepEqual",a.deepEqual)}};function d(e,t){if(e===t){return true}else if(i.isBuffer(e)&&i.isBuffer(t)){if(e.length!=t.length)return false;for(var r=0;r<e.length;r++){if(e[r]!==t[r])return false}return true}else if(i.isDate(e)&&i.isDate(t)){return e.getTime()===t.getTime()}else if(i.isRegExp(e)&&i.isRegExp(t)){return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase}else if(!i.isObject(e)&&!i.isObject(t)){return e==t}else{return h(e,t)}}function f(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function h(e,t){if(i.isNullOrUndefined(e)||i.isNullOrUndefined(t))return false;if(e.prototype!==t.prototype)return false;if(i.isPrimitive(e)||i.isPrimitive(t)){return e===t}var r=f(e),n=f(t);if(r&&!n||!r&&n)return false;if(r){e=s.call(e);t=s.call(t);return d(e,t)}var a=y(e),o=y(t),l,c;if(a.length!=o.length)return false;a.sort();o.sort();for(c=a.length-1;c>=0;c--){if(a[c]!=o[c])return false}for(c=a.length-1;c>=0;c--){l=a[c];if(!d(e[l],t[l]))return false}return true}a.notDeepEqual=function w(e,t,r){if(d(e,t)){u(e,t,r,"notDeepEqual",a.notDeepEqual)}};a.strictEqual=function S(e,t,r){if(e!==t){u(e,t,r,"===",a.strictEqual)}};a.notStrictEqual=function A(e,t,r){if(e===t){u(e,t,r,"!==",a.notStrictEqual)}};function m(e,t){if(!e||!t){return false}if(Object.prototype.toString.call(t)=="[object RegExp]"){return t.test(e)}else if(e instanceof t){return true}else if(t.call({},e)===true){return true}return false}function g(e,t,r,s){var n;if(i.isString(r)){s=r;r=null}try{t()}catch(a){n=a}s=(r&&r.name?" ("+r.name+").":".")+(s?" "+s:".");if(e&&!n){u(n,r,"Missing expected exception"+s)}if(!e&&m(n,r)){u(n,r,"Got unwanted exception"+s)}if(e&&n&&r&&!m(n,r)||!e&&n){throw n}}a.throws=function(e,t,r){g.apply(this,[true].concat(s.call(arguments)))};a.doesNotThrow=function(e,t){g.apply(this,[false].concat(s.call(arguments)))};a.ifError=function(e){if(e){throw e}};var y=Object.keys||function(e){var t=[];for(var r in e){if(n.call(e,r))t.push(r)}return t}},{"util/":132}],128:[function(e,t,r){function i(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(e){if(!n(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};i.prototype.emit=function(e){var t,r,i,n,l,c;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||a(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}throw TypeError('Uncaught, unspecified "error" event.')}}r=this._events[e];if(o(r))return false;if(s(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=arguments.length;n=new Array(i-1);for(l=1;l<i;l++)n[l-1]=arguments[l];r.apply(this,n)}}else if(a(r)){i=arguments.length;n=new Array(i-1);for(l=1;l<i;l++)n[l-1]=arguments[l];c=r.slice();i=c.length;for(l=0;l<i;l++)c[l].apply(this,n)}return true};i.prototype.addListener=function(e,t){var r;if(!s(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,s(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(a(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(a(this._events[e])&&!this._events[e].warned){var r;if(!o(this._maxListeners)){r=this._maxListeners}else{r=i.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function(e,t){if(!s(t))throw TypeError("listener must be a function");var r=false;function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};i.prototype.removeListener=function(e,t){var r,i,n,o;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];n=r.length;i=-1;if(r===t||s(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(a(r)){for(o=n;o-->0;){if(r[o]===t||r[o].listener&&r[o].listener===t){i=o;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(s(r)){this.removeListener(e,r)}else{while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};i.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(s(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};i.listenerCount=function(e,t){var r;if(!e._events||!e._events[t])r=0;else if(s(e._events[t]))r=1;else r=e._events[t].length;return r};function s(e){return typeof e==="function"}function n(e){return typeof e==="number"}function a(e){return typeof e==="object"&&e!==null}function o(e){return e===void 0}},{}],129:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function i(e,t){e.super_=t;e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function s(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}}},{}],130:[function(e,t,r){var i=t.exports={};var s=[];var n=false;function a(){if(n){return}n=true;var e;var t=s.length;while(t){e=s;s=[];var r=-1;while(++r<t){e[r]()}t=s.length}n=false}i.nextTick=function(e){s.push(e);if(!n){setTimeout(a,0)}};i.title="browser";i.browser=true;i.env={};i.argv=[];i.version="";i.versions={};function o(){}i.on=o;i.addListener=o;i.once=o;i.off=o;i.removeListener=o;i.removeAllListeners=o;i.emit=o;i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},{}],131:[function(e,t,r){t.exports=function i(e){return e&&typeof e==="object"&&typeof e.copy==="function"&&typeof e.fill==="function"&&typeof e.readUInt8==="function"}},{}],132:[function(e,t,r){(function(t,i){var s=/%[sdj%]/g;r.format=function(e){if(!w(e)){var t=[];for(var r=0;r<arguments.length;r++){t.push(o(arguments[r]))}return t.join(" ")}var r=1;var i=arguments;var n=i.length;var a=String(e).replace(s,function(e){if(e==="%%")return"%";if(r>=n)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return e}});for(var l=i[r];r<n;l=i[++r]){if(_(l)||!T(l)){a+=" "+l}else{a+=" "+o(l)}}return a};r.deprecate=function(e,s){if(A(i.process)){return function(){return r.deprecate(e,s).apply(this,arguments)}}if(t.noDeprecation===true){return e}var n=false;function a(){if(!n){if(t.throwDeprecation){throw new Error(s)}else if(t.traceDeprecation){console.trace(s)}else{console.error(s)}n=true}return e.apply(this,arguments)}return a};var n={};var a;r.debuglog=function(e){if(A(a))a=t.env.NODE_DEBUG||"";e=e.toUpperCase();if(!n[e]){if(new RegExp("\\b"+e+"\\b","i").test(a)){var i=t.pid;n[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,i,t)}}else{n[e]=function(){}}}return n[e]};function o(e,t){var i={seen:[],stylize:c};if(arguments.length>=3)i.depth=arguments[2];if(arguments.length>=4)i.colors=arguments[3];if(v(t)){i.showHidden=t}else if(t){r._extend(i,t)}if(A(i.showHidden))i.showHidden=false;if(A(i.depth))i.depth=2;if(A(i.colors))i.colors=false;if(A(i.customInspect))i.customInspect=true;if(i.colors)i.stylize=l;return p(i,e,i.depth)}r.inspect=o;o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function l(e,t){var r=o.styles[t];if(r){return"["+o.colors[r][0]+"m"+e+"["+o.colors[r][1]+"m"}else{return e}}function c(e,t){return e}function u(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function p(e,t,i){if(e.customInspect&&t&&N(t.inspect)&&t.inspect!==r.inspect&&!(t.constructor&&t.constructor.prototype===t)){var s=t.inspect(i,e);if(!w(s)){s=p(e,s,i)}return s}var n=d(e,t);if(n){return n}var a=Object.keys(t);var o=u(a);if(e.showHidden){a=Object.getOwnPropertyNames(t)}if(P(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0)){return f(t)}if(a.length===0){if(N(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(C(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}if(R(t)){return e.stylize(Date.prototype.toString.call(t),"date")}if(P(t)){return f(t)}}var c="",v=false,_=["{","}"];if(y(t)){v=true;_=["[","]"]}if(N(t)){var E=t.name?": "+t.name:"";c=" [Function"+E+"]"}if(C(t)){c=" "+RegExp.prototype.toString.call(t)}if(R(t)){c=" "+Date.prototype.toUTCString.call(t)}if(P(t)){c=" "+f(t)}if(a.length===0&&(!v||t.length==0)){return _[0]+c+_[1]}if(i<0){if(C(t)){return e.stylize(RegExp.prototype.toString.call(t),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(t);var b;if(v){b=h(e,t,i,o,a)}else{b=a.map(function(r){return m(e,t,i,o,r,v)})}e.seen.pop();return g(b,c,_)}function d(e,t){if(A(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(b(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(_(t))return e.stylize("null","null")}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,i,s){var n=[];for(var a=0,o=t.length;a<o;++a){if(M(t,String(a))){n.push(m(e,t,r,i,String(a),true))}else{n.push("")}}s.forEach(function(s){if(!s.match(/^\d+$/)){n.push(m(e,t,r,i,s,true))}});return n}function m(e,t,r,i,s,n){var a,o,l;l=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]};if(l.get){if(l.set){o=e.stylize("[Getter/Setter]","special")}else{o=e.stylize("[Getter]","special")}}else{if(l.set){o=e.stylize("[Setter]","special")}}if(!M(i,s)){a="["+s+"]"}if(!o){if(e.seen.indexOf(l.value)<0){if(_(r)){o=p(e,l.value,null)}else{o=p(e,l.value,r-1)}if(o.indexOf("\n")>-1){if(n){o=o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{o="\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{o=e.stylize("[Circular]","special")}}if(A(a)){if(n&&s.match(/^\d+$/)){return o}a=JSON.stringify(""+s);if(a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){a=a.substr(1,a.length-2);a=e.stylize(a,"name")}else{a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");a=e.stylize(a,"string")}}return a+": "+o}function g(e,t,r){var i=0;var s=e.reduce(function(e,t){i++;if(t.indexOf("\n")>=0)i++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(s>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function y(e){return Array.isArray(e)}r.isArray=y;function v(e){return typeof e==="boolean"}r.isBoolean=v;function _(e){return e===null}r.isNull=_;function E(e){return e==null}r.isNullOrUndefined=E;function b(e){return typeof e==="number"}r.isNumber=b;function w(e){return typeof e==="string"}r.isString=w;function S(e){return typeof e==="symbol"}r.isSymbol=S;function A(e){return e===void 0}r.isUndefined=A;function C(e){return T(e)&&x(e)==="[object RegExp]"}r.isRegExp=C;function T(e){return typeof e==="object"&&e!==null}r.isObject=T;function R(e){return T(e)&&x(e)==="[object Date]"}r.isDate=R;function P(e){return T(e)&&(x(e)==="[object Error]"||e instanceof Error)}r.isError=P;function N(e){return typeof e==="function"}r.isFunction=N;function D(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}r.isPrimitive=D;r.isBuffer=e("./support/isBuffer");function x(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date;var t=[k(e.getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}r.log=function(){console.log("%s - %s",I(),r.format.apply(r,arguments))};r.inherits=e("inherits");r._extend=function(e,t){if(!t||!T(t))return e;var r=Object.keys(t);var i=r.length;while(i--){e[r[i]]=t[r[i]]}return e};function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":131,_process:130,inherits:129}],133:[function(e,t,r){var i={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var r,s,n,a,o,l,c;var u=0;e=i.compress(e);while(u<e.length*2){if(u%2==0){r=e.charCodeAt(u/2)>>8;s=e.charCodeAt(u/2)&255;if(u/2+1<e.length)n=e.charCodeAt(u/2+1)>>8;else n=NaN}else{r=e.charCodeAt((u-1)/2)&255;if((u+1)/2<e.length){s=e.charCodeAt((u+1)/2)>>8;n=e.charCodeAt((u+1)/2)&255}else s=n=NaN}u+=3;a=r>>2;o=(r&3)<<4|s>>4;l=(s&15)<<2|n>>6;c=n&63;if(isNaN(s)){l=c=64}else if(isNaN(n)){c=64}t=t+i._keyStr.charAt(a)+i._keyStr.charAt(o)+i._keyStr.charAt(l)+i._keyStr.charAt(c)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",r=0,s,n,a,o,l,c,u,p,d=0,f=i._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(d<e.length){l=i._keyStr.indexOf(e.charAt(d++));c=i._keyStr.indexOf(e.charAt(d++));u=i._keyStr.indexOf(e.charAt(d++));p=i._keyStr.indexOf(e.charAt(d++));n=l<<2|c>>4;a=(c&15)<<4|u>>2;o=(u&3)<<6|p;if(r%2==0){s=n<<8;if(u!=64){t+=f(s|a)}if(p!=64){s=o<<8}}else{t=t+f(s|n);if(u!=64){s=a<<8}if(p!=64){t+=f(s|o)}}r+=3}return i.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",r,s,n,a=0,o=i._f;e=i.compress(e);for(r=0;r<e.length;r++){s=e.charCodeAt(r);switch(a++){case 0:t+=o((s>>1)+32);n=(s&1)<<14;break;case 1:t+=o(n+(s>>2)+32);n=(s&3)<<13;break;case 2:t+=o(n+(s>>3)+32);n=(s&7)<<12;break;case 3:t+=o(n+(s>>4)+32);n=(s&15)<<11;break;case 4:t+=o(n+(s>>5)+32);n=(s&31)<<10;break;case 5:t+=o(n+(s>>6)+32);n=(s&63)<<9;break;case 6:t+=o(n+(s>>7)+32);n=(s&127)<<8;break;case 7:t+=o(n+(s>>8)+32);n=(s&255)<<7;break;case 8:t+=o(n+(s>>9)+32);n=(s&511)<<6;break;case 9:t+=o(n+(s>>10)+32);n=(s&1023)<<5;break;case 10:t+=o(n+(s>>11)+32);n=(s&2047)<<4;break;case 11:t+=o(n+(s>>12)+32);n=(s&4095)<<3;break;case 12:t+=o(n+(s>>13)+32);n=(s&8191)<<2;break;case 13:t+=o(n+(s>>14)+32);n=(s&16383)<<1;break;case 14:t+=o(n+(s>>15)+32,(s&32767)+32);a=0;break}}return t+o(n+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",r,s,n=0,a=0,o=i._f;while(a<e.length){s=e.charCodeAt(a)-32;switch(n++){case 0:r=s<<1;break;case 1:t+=o(r|s>>14);r=(s&16383)<<2;break;case 2:t+=o(r|s>>13);r=(s&8191)<<3;break;case 3:t+=o(r|s>>12);r=(s&4095)<<4;break;case 4:t+=o(r|s>>11);r=(s&2047)<<5;break;case 5:t+=o(r|s>>10);r=(s&1023)<<6;break;case 6:t+=o(r|s>>9);r=(s&511)<<7;break;case 7:t+=o(r|s>>8);r=(s&255)<<8;break;case 8:t+=o(r|s>>7);r=(s&127)<<9;break;case 9:t+=o(r|s>>6);r=(s&63)<<10;break;case 10:t+=o(r|s>>5);r=(s&31)<<11;break;case 11:t+=o(r|s>>4);r=(s&15)<<12;break;case 12:t+=o(r|s>>3);r=(s&7)<<13;break;case 13:t+=o(r|s>>2);r=(s&3)<<14;break;case 14:t+=o(r|s>>1);r=(s&1)<<15;break;case 15:t+=o(r|s);n=0;break}a++}return i.decompress(t)},compressToUint8Array:function(e){var t=i.compress(e);var r=new Uint8Array(t.length*2);for(var s=0,n=t.length;s<n;s++){var a=t.charCodeAt(s);r[s*2]=a>>>8;r[s*2+1]=a%256}return r},decompressFromUint8Array:function(e){if(e===null||e===undefined){return i.decompress(e)}else{var t=new Array(e.length/2);for(var r=0,s=t.length;r<s;r++){t[r]=e[r*2]*256+e[r*2+1]}return i.decompress(String.fromCharCode.apply(null,t))}},compressToEncodedURIComponent:function(e){return i.compressToBase64(e).replace(/=/g,"$").replace(/\//g,"-")},decompressFromEncodedURIComponent:function(e){if(e)e=e.replace(/$/g,"=").replace(/-/g,"/");return i.decompressFromBase64(e)},compress:function(e){if(e==null)return"";var t,r,s={},n={},a="",o="",l="",c=2,u=3,p=2,d="",f=0,h=0,m,g=i._f;for(m=0;m<e.length;m+=1){a=e.charAt(m);if(!Object.prototype.hasOwnProperty.call(s,a)){s[a]=u++;n[a]=true}o=l+a;if(Object.prototype.hasOwnProperty.call(s,o)){l=o}else{if(Object.prototype.hasOwnProperty.call(n,l)){if(l.charCodeAt(0)<256){for(t=0;t<p;t++){f=f<<1;if(h==15){h=0;d+=g(f);f=0}else{h++}}r=l.charCodeAt(0);for(t=0;t<8;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}else{r=1;for(t=0;t<p;t++){f=f<<1|r;if(h==15){h=0;d+=g(f);f=0}else{h++}r=0}r=l.charCodeAt(0);for(t=0;t<16;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}c--;if(c==0){c=Math.pow(2,p);p++}delete n[l]}else{r=s[l];for(t=0;t<p;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}c--;if(c==0){c=Math.pow(2,p);p++}s[o]=u++;l=String(a)}}if(l!==""){if(Object.prototype.hasOwnProperty.call(n,l)){if(l.charCodeAt(0)<256){for(t=0;t<p;t++){f=f<<1;if(h==15){h=0;d+=g(f);f=0}else{h++}}r=l.charCodeAt(0);for(t=0;t<8;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}else{r=1;for(t=0;t<p;t++){f=f<<1|r;if(h==15){h=0;d+=g(f);f=0}else{h++}r=0}r=l.charCodeAt(0);for(t=0;t<16;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}c--;if(c==0){c=Math.pow(2,p);p++}delete n[l]}else{r=s[l];for(t=0;t<p;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}}c--;if(c==0){c=Math.pow(2,p);p++}}r=2;for(t=0;t<p;t++){f=f<<1|r&1;if(h==15){h=0;d+=g(f);f=0}else{h++}r=r>>1}while(true){f=f<<1;if(h==15){d+=g(f);break}else h++}return d},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],r,s=4,n=4,a=3,o="",l="",c,u,p,d,f,h,m,g=i._f,y={string:e,val:e.charCodeAt(0),position:32768,index:1};for(c=0;c<3;c+=1){t[c]=c}p=0;f=Math.pow(2,2);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}switch(r=p){case 0:p=0;f=Math.pow(2,8);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}m=g(p);break;case 1:p=0;f=Math.pow(2,16);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}m=g(p);break;case 2:return""}t[3]=m;u=l=m;while(true){if(y.index>y.string.length){return""}p=0;f=Math.pow(2,a);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}switch(m=p){case 0:p=0;f=Math.pow(2,8);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}t[n++]=g(p);m=n-1;s--;break;case 1:p=0;f=Math.pow(2,16);h=1;while(h!=f){d=y.val&y.position;y.position>>=1;if(y.position==0){y.position=32768;y.val=y.string.charCodeAt(y.index++)}p|=(d>0?1:0)*h;h<<=1}t[n++]=g(p);m=n-1;s--;break;case 2:return l}if(s==0){s=Math.pow(2,a);a++}if(t[m]){o=t[m]}else{if(m===n){o=u+u.charAt(0)}else{return null}}l+=o;t[n++]=u+o.charAt(0);s--;u=o;if(s==0){s=Math.pow(2,a);a++}}}};if(typeof t!=="undefined"&&t!=null){t.exports=i}},{}],134:[function(e,t,r){(function(r){(function(i){var s,n="2.9.0",a=typeof r!=="undefined"&&(typeof window==="undefined"||window===r.window)?r:this,o,l=Math.round,c=Object.prototype.hasOwnProperty,u,p=0,d=1,f=2,h=3,m=4,g=5,y=6,v={},_=[],E=typeof t!=="undefined"&&t&&t.exports,b=/^\/?Date\((\-?\d+)/i,w=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,S=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,A=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,C=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,T=/\d\d?/,R=/\d{1,3}/,P=/\d{1,4}/,N=/[+\-]?\d{1,6}/,D=/\d+/,x=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,k=/Z|[\+\-]\d\d:?\d\d/gi,O=/T/i,I=/[\+\-]?\d+/,M=/[\+\-]?\d+(\.\d{1,3})?/,F=/\d/,q=/\d\d/,L=/\d{3}/,j=/\d{4}/,B=/[+-]?\d{6}/,X=/[+-]?\d+/,G=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,U="YYYY-MM-DDTHH:mm:ssZ",V=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],H=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Y=/([\+\-]|\d\d)/gi,z="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),W={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},J={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Q={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Z={},K={s:45,m:45,h:22,d:26,M:11},$="DDD w W M D d".split(" "),et="M D H h m s w W".split(" "),tt={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return bt(this.year()%100,2)},YYYY:function(){return bt(this.year(),4)},YYYYY:function(){return bt(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+bt(Math.abs(e),6)},gg:function(){return bt(this.weekYear()%100,2)},gggg:function(){return bt(this.weekYear(),4)},ggggg:function(){return bt(this.weekYear(),5)},GG:function(){return bt(this.isoWeekYear()%100,2)},GGGG:function(){return bt(this.isoWeekYear(),4)},GGGGG:function(){return bt(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return kt(this.milliseconds()/100)},SS:function(){return bt(kt(this.milliseconds()/10),2)},SSS:function(){return bt(this.milliseconds(),3)},SSSS:function(){return bt(this.milliseconds(),3)},Z:function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+bt(kt(e/60),2)+":"+bt(kt(e)%60,2)},ZZ:function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+bt(kt(e/60),2)+bt(kt(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},rt={},it=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],st=false;function nt(e,t,r){switch(arguments.length){case 2:return e!=null?e:t;case 3:return e!=null?e:t!=null?t:r;default:throw new Error("Implement me")}}function at(e,t){return c.call(e,t)}function ot(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function lt(e){if(s.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function ct(e,t){var r=true;return vt(function(){if(r){lt(e);r=false}return t.apply(this,arguments)},t)}function ut(e,t){if(!rt[e]){lt(t);rt[e]=true}}function pt(e,t){return function(r){return bt(e.call(this,r),t)}}function dt(e,t){return function(r){return this.localeData().ordinal(e.call(this,r),t)}}function ft(e,t){var r=(t.year()-e.year())*12+(t.month()-e.month()),i=e.clone().add(r,"months"),s,n;if(t-i<0){s=e.clone().add(r-1,"months");n=(t-i)/(i-s)}else{s=e.clone().add(r+1,"months");n=(t-i)/(s-i)}return-(r+n)}while($.length){u=$.pop();tt[u+"o"]=dt(tt[u],u)}while(et.length){u=et.pop();tt[u+u]=pt(tt[u],2)}tt.DDDD=pt(tt.DDD,3);function ht(e,t,r){var i;if(r==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,r)}else if(e.isPM!=null){i=e.isPM(r);if(i&&t<12){t+=12}if(!i&&t===12){t=0}return t}else{return t}}function mt(){}function gt(e,t){if(t!==false){qt(e)}_t(this,e);this._d=new Date(+e._d);if(st===false){st=true;s.updateOffset(this);st=false}}function yt(e){var t=Dt(e),r=t.year||0,i=t.quarter||0,n=t.month||0,a=t.week||0,o=t.day||0,l=t.hour||0,c=t.minute||0,u=t.second||0,p=t.millisecond||0;this._milliseconds=+p+u*1e3+c*6e4+l*36e5;this._days=+o+a*7;this._months=+n+i*3+r*12;this._data={};this._locale=s.localeData();this._bubble()}function vt(e,t){for(var r in t){if(at(t,r)){e[r]=t[r]}}if(at(t,"toString")){e.toString=t.toString}if(at(t,"valueOf")){e.valueOf=t.valueOf}return e}function _t(e,t){var r,i,s;if(typeof t._isAMomentObject!=="undefined"){e._isAMomentObject=t._isAMomentObject}if(typeof t._i!=="undefined"){e._i=t._i}if(typeof t._f!=="undefined"){e._f=t._f}if(typeof t._l!=="undefined"){e._l=t._l}if(typeof t._strict!=="undefined"){e._strict=t._strict}if(typeof t._tzm!=="undefined"){e._tzm=t._tzm}if(typeof t._isUTC!=="undefined"){e._isUTC=t._isUTC}if(typeof t._offset!=="undefined"){e._offset=t._offset}if(typeof t._pf!=="undefined"){e._pf=t._pf}if(typeof t._locale!=="undefined"){e._locale=t._locale}if(_.length>0){for(r in _){i=_[r];s=t[i];if(typeof s!=="undefined"){e[i]=s}}}return e}function Et(e){if(e<0){return Math.ceil(e)}else{return Math.floor(e)}}function bt(e,t,r){var i=""+Math.abs(e),s=e>=0;while(i.length<t){i="0"+i}return(s?r?"+":"":"-")+i}function wt(e,t){var r={milliseconds:0,months:0};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t)){--r.months}r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function St(e,t){var r;t=Gt(t,e);if(e.isBefore(t)){r=wt(e,t)}else{r=wt(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function At(e,t){return function(r,i){var n,a;if(i!==null&&!isNaN(+i)){ut(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period).");a=r;r=i;i=a}r=typeof r==="string"?+r:r;n=s.duration(r,i);Ct(this,n,e);return this}}function Ct(e,t,r,i){var n=t._milliseconds,a=t._days,o=t._months;i=i==null?true:i;if(n){e._d.setTime(+e._d+n*r)}if(a){_r(e,"Date",vr(e,"Date")+a*r)}if(o){yr(e,vr(e,"Month")+o*r)}if(i){s.updateOffset(e,a||o)}}function Tt(e){return Object.prototype.toString.call(e)==="[object Array]"}function Rt(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function Pt(e,t,r){var i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),n=0,a;for(a=0;a<i;a++){if(r&&e[a]!==t[a]||!r&&kt(e[a])!==kt(t[a])){n++}}return n+s}function Nt(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=J[e]||Q[t]||t}return e}function Dt(e){var t={},r,i;for(i in e){if(at(e,i)){r=Nt(i);if(r){t[r]=e[i]}}}return t}function xt(e){var t,r;if(e.indexOf("week")===0){t=7;r="day"}else if(e.indexOf("month")===0){t=12;r="month"}else{return}s[e]=function(n,a){var o,l,c=s._locale[e],u=[];if(typeof n==="number"){a=n;n=i}l=function(e){var t=s().utc().set(r,e);return c.call(s._locale,t,n||"")};if(a!=null){return l(a)}else{for(o=0;o<t;o++){u.push(l(o))}return u}}}function kt(e){var t=+e,r=0;if(t!==0&&isFinite(t)){if(t>=0){r=Math.floor(t)}else{r=Math.ceil(t)}}return r}function Ot(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function It(e,t,r){return fr(s([e,11,31+t-r]),t,r).week}function Mt(e){return Ft(e)?366:365}function Ft(e){return e%4===0&&e%100!==0||e%400===0}function qt(e){var t;if(e._a&&e._pf.overflow===-2){t=e._a[d]<0||e._a[d]>11?d:e._a[f]<1||e._a[f]>Ot(e._a[p],e._a[d])?f:e._a[h]<0||e._a[h]>24||e._a[h]===24&&(e._a[m]!==0||e._a[g]!==0||e._a[y]!==0)?h:e._a[m]<0||e._a[m]>59?m:e._a[g]<0||e._a[g]>59?g:e._a[y]<0||e._a[y]>999?y:-1;if(e._pf._overflowDayOfYear&&(t<p||t>f)){t=f}e._pf.overflow=t}}function Lt(e){if(e._isValid==null){e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated;if(e._strict){e._isValid=e._isValid&&e._pf.charsLeftOver===0&&e._pf.unusedTokens.length===0&&e._pf.bigHour===i}}return e._isValid}function jt(e){return e?e.toLowerCase().replace("_","-"):e}function Bt(e){var t=0,r,i,s,n;while(t<e.length){n=jt(e[t]).split("-");r=n.length;i=jt(e[t+1]);i=i?i.split("-"):null;while(r>0){s=Xt(n.slice(0,r).join("-"));if(s){return s}if(i&&i.length>=r&&Pt(n,i,true)>=r-1){break}r--}t++}return null}function Xt(t){var r=null;if(!v[t]&&E){try{r=s.locale();e("./locale/"+t);s.locale(r)}catch(i){}}return v[t]}function Gt(e,t){var r,i;if(t._isUTC){r=t.clone();i=(s.isMoment(e)||Rt(e)?+e:+s(e))-+r;r._d.setTime(+r._d+i);s.updateOffset(r,false);return r}else{return s(e).local()}}vt(mt.prototype,{set:function(e){var t,r;for(r in e){t=e[r];if(typeof t==="function"){this[r]=t}else{this["_"+r]=t}}this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,r){var i,n,a;if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){n=s.utc([2e3,i]);if(r&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[i]){a="^"+this.months(n,"")+"|^"+this.monthsShort(n,"");this._monthsParse[i]=new RegExp(a.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[i].test(e)){return i
}else if(r&&t==="MMM"&&this._shortMonthsParse[i].test(e)){return i}else if(!r&&this._monthsParse[i].test(e)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,r,i;if(!this._weekdaysParse){this._weekdaysParse=[]}for(t=0;t<7;t++){if(!this._weekdaysParse[t]){r=s([2e3,1]).day(t);i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,"");this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")}if(this._weekdaysParse[t].test(e)){return t}}},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];if(!t&&this._longDateFormat[e.toUpperCase()]){t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)});this._longDateFormat[e]=t}return t},isPM:function(e){return(e+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,r){if(e>11){return r?"pm":"PM"}else{return r?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,r){var i=this._calendar[e];return typeof i==="function"?i.apply(t,[r]):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,r,i){var s=this._relativeTime[r];return typeof s==="function"?s(e,t,r,i):s.replace(/%d/i,e)},pastFuture:function(e,t){var r=this._relativeTime[e>0?"future":"past"];return typeof r==="function"?r(t):r.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return fr(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function Ut(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function Vt(e){var t=e.match(A),r,i;for(r=0,i=t.length;r<i;r++){if(tt[t[r]]){t[r]=tt[t[r]]}else{t[r]=Ut(t[r])}}return function(s){var n="";for(r=0;r<i;r++){n+=t[r]instanceof Function?t[r].call(s,e):t[r]}return n}}function Ht(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=Yt(t,e.localeData());if(!Z[t]){Z[t]=Vt(t)}return Z[t](e)}function Yt(e,t){var r=5;function i(e){return t.longDateFormat(e)||e}C.lastIndex=0;while(r>=0&&C.test(e)){e=e.replace(C,i);C.lastIndex=0;r-=1}return e}function zt(e,t){var r,i=t._strict;switch(e){case"Q":return F;case"DDDD":return L;case"YYYY":case"GGGG":case"gggg":return i?j:P;case"Y":case"G":case"g":return X;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?B:N;case"S":if(i){return F}case"SS":if(i){return q}case"SSS":if(i){return L}case"DDD":return R;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return x;case"a":case"A":return t._locale._meridiemParse;case"x":return I;case"X":return M;case"Z":case"ZZ":return k;case"T":return O;case"SSSS":return D;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?q:T;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return T;case"Do":return i?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:r=new RegExp(rr(tr(e.replace("\\","")),"i"));return r}}function Wt(e){e=e||"";var t=e.match(k)||[],r=t[t.length-1]||[],i=(r+"").match(Y)||["-",0,0],s=+(i[1]*60)+kt(i[2]);return i[0]==="+"?s:-s}function Jt(e,t,r){var i,n=r._a;switch(e){case"Q":if(t!=null){n[d]=(kt(t)-1)*3}break;case"M":case"MM":if(t!=null){n[d]=kt(t)-1}break;case"MMM":case"MMMM":i=r._locale.monthsParse(t,e,r._strict);if(i!=null){n[d]=i}else{r._pf.invalidMonth=t}break;case"D":case"DD":if(t!=null){n[f]=kt(t)}break;case"Do":if(t!=null){n[f]=kt(parseInt(t.match(/\d{1,2}/)[0],10))}break;case"DDD":case"DDDD":if(t!=null){r._dayOfYear=kt(t)}break;case"YY":n[p]=s.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":n[p]=kt(t);break;case"a":case"A":r._meridiem=t;break;case"h":case"hh":r._pf.bigHour=true;case"H":case"HH":n[h]=kt(t);break;case"m":case"mm":n[m]=kt(t);break;case"s":case"ss":n[g]=kt(t);break;case"S":case"SS":case"SSS":case"SSSS":n[y]=kt(("0."+t)*1e3);break;case"x":r._d=new Date(kt(t));break;case"X":r._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":r._useUTC=true;r._tzm=Wt(t);break;case"dd":case"ddd":case"dddd":i=r._locale.weekdaysParse(t);if(i!=null){r._w=r._w||{};r._w["d"]=i}else{r._pf.invalidWeekday=t}break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2);if(t){r._w=r._w||{};r._w[e]=kt(t)}break;case"gg":case"GG":r._w=r._w||{};r._w[e]=s.parseTwoDigitYear(t)}}function Qt(e){var t,r,i,n,a,o,l;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){a=1;o=4;r=nt(t.GG,e._a[p],fr(s(),1,4).year);i=nt(t.W,1);n=nt(t.E,1)}else{a=e._locale._week.dow;o=e._locale._week.doy;r=nt(t.gg,e._a[p],fr(s(),a,o).year);i=nt(t.w,1);if(t.d!=null){n=t.d;if(n<a){++i}}else if(t.e!=null){n=t.e+a}else{n=a}}l=hr(r,i,n,o,a);e._a[p]=l.year;e._dayOfYear=l.dayOfYear}function Zt(e){var t,r,i=[],s,n;if(e._d){return}s=$t(e);if(e._w&&e._a[f]==null&&e._a[d]==null){Qt(e)}if(e._dayOfYear){n=nt(e._a[p],s[p]);if(e._dayOfYear>Mt(n)){e._pf._overflowDayOfYear=true}r=cr(n,0,e._dayOfYear);e._a[d]=r.getUTCMonth();e._a[f]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=i[t]=s[t]}for(;t<7;t++){e._a[t]=i[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[h]===24&&e._a[m]===0&&e._a[g]===0&&e._a[y]===0){e._nextDay=true;e._a[h]=0}e._d=(e._useUTC?cr:lr).apply(null,i);if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[h]=24}}function Kt(e){var t;if(e._d){return}t=Dt(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond];Zt(e)}function $t(e){var t=new Date;if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}else{return[t.getFullYear(),t.getMonth(),t.getDate()]}}function er(e){if(e._f===s.ISO_8601){sr(e);return}e._a=[];e._pf.empty=true;var t=""+e._i,r,n,a,o,l,c=t.length,u=0;a=Yt(e._f,e._locale).match(A)||[];for(r=0;r<a.length;r++){o=a[r];n=(t.match(zt(o,e))||[])[0];if(n){l=t.substr(0,t.indexOf(n));if(l.length>0){e._pf.unusedInput.push(l)}t=t.slice(t.indexOf(n)+n.length);u+=n.length}if(tt[o]){if(n){e._pf.empty=false}else{e._pf.unusedTokens.push(o)}Jt(o,n,e)}else if(e._strict&&!n){e._pf.unusedTokens.push(o)}}e._pf.charsLeftOver=c-u;if(t.length>0){e._pf.unusedInput.push(t)}if(e._pf.bigHour===true&&e._a[h]<=12){e._pf.bigHour=i}e._a[h]=ht(e._locale,e._a[h],e._meridiem);Zt(e);qt(e)}function tr(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,s){return t||r||i||s})}function rr(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ir(e){var t,r,i,s,n;if(e._f.length===0){e._pf.invalidFormat=true;e._d=new Date(NaN);return}for(s=0;s<e._f.length;s++){n=0;t=_t({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._pf=ot();t._f=e._f[s];er(t);if(!Lt(t)){continue}n+=t._pf.charsLeftOver;n+=t._pf.unusedTokens.length*10;t._pf.score=n;if(i==null||n<i){i=n;r=t}}vt(e,r||t)}function sr(e){var t,r,i=e._i,s=G.exec(i);if(s){e._pf.iso=true;for(t=0,r=V.length;t<r;t++){if(V[t][1].exec(i)){e._f=V[t][0]+(s[6]||" ");break}}for(t=0,r=H.length;t<r;t++){if(H[t][1].exec(i)){e._f+=H[t][0];break}}if(i.match(k)){e._f+="Z"}er(e)}else{e._isValid=false}}function nr(e){sr(e);if(e._isValid===false){delete e._isValid;s.createFromInputFallback(e)}}function ar(e,t){var r=[],i;for(i=0;i<e.length;++i){r.push(t(e[i],i))}return r}function or(e){var t=e._i,r;if(t===i){e._d=new Date}else if(Rt(t)){e._d=new Date(+t)}else if((r=b.exec(t))!==null){e._d=new Date(+r[1])}else if(typeof t==="string"){nr(e)}else if(Tt(t)){e._a=ar(t.slice(0),function(e){return parseInt(e,10)});Zt(e)}else if(typeof t==="object"){Kt(e)}else if(typeof t==="number"){e._d=new Date(t)}else{s.createFromInputFallback(e)}}function lr(e,t,r,i,s,n,a){var o=new Date(e,t,r,i,s,n,a);if(e<1970){o.setFullYear(e)}return o}function cr(e){var t=new Date(Date.UTC.apply(null,arguments));if(e<1970){t.setUTCFullYear(e)}return t}function ur(e,t){if(typeof e==="string"){if(!isNaN(e)){e=parseInt(e,10)}else{e=t.weekdaysParse(e);if(typeof e!=="number"){return null}}}return e}function pr(e,t,r,i,s){return s.relativeTime(t||1,!!r,e,i)}function dr(e,t,r){var i=s.duration(e).abs(),n=l(i.as("s")),a=l(i.as("m")),o=l(i.as("h")),c=l(i.as("d")),u=l(i.as("M")),p=l(i.as("y")),d=n<K.s&&["s",n]||a===1&&["m"]||a<K.m&&["mm",a]||o===1&&["h"]||o<K.h&&["hh",o]||c===1&&["d"]||c<K.d&&["dd",c]||u===1&&["M"]||u<K.M&&["MM",u]||p===1&&["y"]||["yy",p];d[2]=t;d[3]=+e>0;d[4]=r;return pr.apply({},d)}function fr(e,t,r){var i=r-t,n=r-e.day(),a;if(n>i){n-=7}if(n<i-7){n+=7}a=s(e).add(n,"d");return{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function hr(e,t,r,i,s){var n=cr(e,0,1).getUTCDay(),a,o;n=n===0?7:n;r=r!=null?r:s;a=s-n+(n>i?7:0)-(n<s?7:0);o=7*(t-1)+(r-s)+a+1;return{year:o>0?e:e-1,dayOfYear:o>0?o:Mt(e-1)+o}}function mr(e){var t=e._i,r=e._f,n;e._locale=e._locale||s.localeData(e._l);if(t===null||r===i&&t===""){return s.invalid({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(s.isMoment(t)){return new gt(t,true)}else if(r){if(Tt(r)){ir(e)}else{er(e)}}else{or(e)}n=new gt(e);if(n._nextDay){n.add(1,"d");n._nextDay=i}return n}s=function(e,t,r,s){var n;if(typeof r==="boolean"){s=r;r=i}n={};n._isAMomentObject=true;n._i=e;n._f=t;n._l=r;n._strict=s;n._isUTC=false;n._pf=ot();return mr(n)};s.suppressDeprecationWarnings=false;s.createFromInputFallback=ct("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function gr(e,t){var r,i;if(t.length===1&&Tt(t[0])){t=t[0]}if(!t.length){return s()}r=t[0];for(i=1;i<t.length;++i){if(t[i][e](r)){r=t[i]}}return r}s.min=function(){var e=[].slice.call(arguments,0);return gr("isBefore",e)};s.max=function(){var e=[].slice.call(arguments,0);return gr("isAfter",e)};s.utc=function(e,t,r,s){var n;if(typeof r==="boolean"){s=r;r=i}n={};n._isAMomentObject=true;n._useUTC=true;n._isUTC=true;n._l=r;n._i=e;n._f=t;n._strict=s;n._pf=ot();return mr(n).utc()};s.unix=function(e){return s(e*1e3)};s.duration=function(e,t){var r=e,i=null,n,a,o,l;if(s.isDuration(e)){r={ms:e._milliseconds,d:e._days,M:e._months}}else if(typeof e==="number"){r={};if(t){r[t]=e}else{r.milliseconds=e}}else if(!!(i=w.exec(e))){n=i[1]==="-"?-1:1;r={y:0,d:kt(i[f])*n,h:kt(i[h])*n,m:kt(i[m])*n,s:kt(i[g])*n,ms:kt(i[y])*n}}else if(!!(i=S.exec(e))){n=i[1]==="-"?-1:1;o=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n};r={y:o(i[2]),M:o(i[3]),d:o(i[4]),h:o(i[5]),m:o(i[6]),s:o(i[7]),w:o(i[8])}}else if(r==null){r={}}else if(typeof r==="object"&&("from"in r||"to"in r)){l=St(s(r.from),s(r.to));r={};r.ms=l.milliseconds;r.M=l.months}a=new yt(r);if(s.isDuration(e)&&at(e,"_locale")){a._locale=e._locale}return a};s.version=n;s.defaultFormat=U;s.ISO_8601=function(){};s.momentProperties=_;s.updateOffset=function(){};s.relativeTimeThreshold=function(e,t){if(K[e]===i){return false}if(t===i){return K[e]}K[e]=t;return true};s.lang=ct("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return s.locale(e,t)});s.locale=function(e,t){var r;if(e){if(typeof t!=="undefined"){r=s.defineLocale(e,t)}else{r=s.localeData(e)}if(r){s.duration._locale=s._locale=r}}return s._locale._abbr};s.defineLocale=function(e,t){if(t!==null){t.abbr=e;if(!v[e]){v[e]=new mt}v[e].set(t);s.locale(e);return v[e]}else{delete v[e];return null}};s.langData=ct("moment.langData is deprecated. Use moment.localeData instead.",function(e){return s.localeData(e)});s.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return s._locale}if(!Tt(e)){t=Xt(e);if(t){return t}e=[e]}return Bt(e)};s.isMoment=function(e){return e instanceof gt||e!=null&&at(e,"_isAMomentObject")};s.isDuration=function(e){return e instanceof yt};for(u=it.length-1;u>=0;--u){xt(it[u])}s.normalizeUnits=function(e){return Nt(e)};s.invalid=function(e){var t=s.utc(NaN);if(e!=null){vt(t._pf,e)}else{t._pf.userInvalidated=true}return t};s.parseZone=function(){return s.apply(null,arguments).parseZone()};s.parseTwoDigitYear=function(e){return kt(e)+(kt(e)>68?1900:2e3)};s.isDate=Rt;vt(s.fn=gt.prototype,{clone:function(){return s(this)},valueOf:function(){return+this._d-(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=s(this).utc();if(0<e.year()&&e.year()<=9999){if("function"===typeof Date.prototype.toISOString){return this.toDate().toISOString()}else{return Ht(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}else{return Ht(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return Lt(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&Pt(this._a,(this._isUTC?s.utc(this._a):s(this._a)).toArray())>0}return false},parsingFlags:function(){return vt({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.utcOffset(0,e)},local:function(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(this._dateUtcOffset(),"m")}}return this},format:function(e){var t=Ht(this,e||s.defaultFormat);return this.localeData().postformat(t)},add:At(1,"add"),subtract:At(-1,"subtract"),diff:function(e,t,r){var i=Gt(e,this),s=(i.utcOffset()-this.utcOffset())*6e4,n,a,o,l;t=Nt(t);if(t==="year"||t==="month"||t==="quarter"){o=ft(this,i);if(t==="quarter"){o=o/3}else if(t==="year"){o=o/12}}else{a=this-i;o=t==="second"?a/1e3:t==="minute"?a/6e4:t==="hour"?a/36e5:t==="day"?(a-s)/864e5:t==="week"?(a-s)/6048e5:a}return r?o:Et(o)},from:function(e,t){return s.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(s(),e)},calendar:function(e){var t=e||s(),r=Gt(t,this).startOf("day"),i=this.diff(r,"days",true),n=i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(n,this,s(t)))},isLeapYear:function(){return Ft(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=ur(e,this.localeData());return this.add(e-t,"d")}else{return t}},month:Er("Month",true),startOf:function(e){e=Nt(e);switch(e){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(e==="week"){this.weekday(0)}else if(e==="isoWeek"){this.isoWeekday(1)}if(e==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this},endOf:function(e){e=Nt(e);if(e===i||e==="millisecond"){return this}return this.startOf(e).add(1,e==="isoWeek"?"week":e).subtract(1,"ms")},isAfter:function(e,t){var r;t=Nt(typeof t!=="undefined"?t:"millisecond");if(t==="millisecond"){e=s.isMoment(e)?e:s(e);return+this>+e}else{r=s.isMoment(e)?+e:+s(e);return r<+this.clone().startOf(t)}},isBefore:function(e,t){var r;t=Nt(typeof t!=="undefined"?t:"millisecond");if(t==="millisecond"){e=s.isMoment(e)?e:s(e);return+this<+e}else{r=s.isMoment(e)?+e:+s(e);return+this.clone().endOf(t)<r}},isBetween:function(e,t,r){return this.isAfter(e,r)&&this.isBefore(t,r)},isSame:function(e,t){var r;t=Nt(t||"millisecond");if(t==="millisecond"){e=s.isMoment(e)?e:s(e);return+this===+e}else{r=+s(e);return+this.clone().startOf(t)<=r&&r<=+this.clone().endOf(t)}},min:ct("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){e=s.apply(null,arguments);return e<this?this:e}),max:ct("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){e=s.apply(null,arguments);return e>this?this:e}),zone:ct("moment().zone is deprecated, use moment().utcOffset instead. "+"https://github.com/moment/moment/issues/1779",function(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}),utcOffset:function(e,t){var r=this._offset||0,i;if(e!=null){if(typeof e==="string"){e=Wt(e)}if(Math.abs(e)<16){e=e*60}if(!this._isUTC&&t){i=this._dateUtcOffset()}this._offset=e;this._isUTC=true;if(i!=null){this.add(i,"m")}if(r!==e){if(!t||this._changeInProgress){Ct(this,s.duration(e-r,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;s.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?r:this._dateUtcOffset()}},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&this._offset===0},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.utcOffset(this._tzm)}else if(typeof this._i==="string"){this.utcOffset(Wt(this._i))}return this},hasAlignedHourOffset:function(e){if(!e){e=0}else{e=s(e).utcOffset()}return(this.utcOffset()-e)%60===0},daysInMonth:function(){return Ot(this.year(),this.month())},dayOfYear:function(e){var t=l((s(this).startOf("day")-s(this).startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")},quarter:function(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)},weekYear:function(e){var t=fr(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return e==null?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=fr(this,1,4).year;return e==null?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")},isoWeek:function(e){var t=fr(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")},isoWeekday:function(e){return e==null?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return It(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return It(this.year(),e.dow,e.doy)},get:function(e){e=Nt(e);return this[e]()},set:function(e,t){var r;if(typeof e==="object"){for(r in e){this.set(r,e[r])}}else{e=Nt(e);if(typeof this[e]==="function"){this[e](t)}}return this},locale:function(e){var t;if(e===i){return this._locale._abbr}else{t=s.localeData(e);if(t!=null){this._locale=t}return this}},lang:ct("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===i){return this.localeData()}else{return this.locale(e)}}),localeData:function(){return this._locale},_dateUtcOffset:function(){return-Math.round(this._d.getTimezoneOffset()/15)*15}});function yr(e,t){var r;if(typeof t==="string"){t=e.localeData().monthsParse(t);if(typeof t!=="number"){return e}}r=Math.min(e.date(),Ot(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r);return e}function vr(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function _r(e,t,r){if(t==="Month"){return yr(e,r)}else{return e._d["set"+(e._isUTC?"UTC":"")+t](r)}}function Er(e,t){return function(r){if(r!=null){_r(this,e,r);s.updateOffset(this,t);return this}else{return vr(this,e)}}}s.fn.millisecond=s.fn.milliseconds=Er("Milliseconds",false);s.fn.second=s.fn.seconds=Er("Seconds",false);s.fn.minute=s.fn.minutes=Er("Minutes",false);s.fn.hour=s.fn.hours=Er("Hours",true);s.fn.date=Er("Date",true);s.fn.dates=ct("dates accessor is deprecated. Use date instead.",Er("Date",true));s.fn.year=Er("FullYear",true);s.fn.years=ct("years accessor is deprecated. Use year instead.",Er("FullYear",true));s.fn.days=s.fn.day;s.fn.months=s.fn.month;s.fn.weeks=s.fn.week;s.fn.isoWeeks=s.fn.isoWeek;s.fn.quarters=s.fn.quarter;s.fn.toJSON=s.fn.toISOString;s.fn.isUTC=s.fn.isUtc;function br(e){return e*400/146097}function wr(e){return e*146097/400}vt(s.duration.fn=yt.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,r=this._months,i=this._data,s,n,a,o=0;i.milliseconds=e%1e3;s=Et(e/1e3);i.seconds=s%60;n=Et(s/60);i.minutes=n%60;a=Et(n/60);i.hours=a%24;t+=Et(a/24);o=Et(br(t));t-=Et(wr(o));r+=Et(t/30);t%=30;o+=Et(r/12);r%=12;i.days=t;i.months=r;i.years=o},abs:function(){this._milliseconds=Math.abs(this._milliseconds);this._days=Math.abs(this._days);this._months=Math.abs(this._months);this._data.milliseconds=Math.abs(this._data.milliseconds);this._data.seconds=Math.abs(this._data.seconds);this._data.minutes=Math.abs(this._data.minutes);this._data.hours=Math.abs(this._data.hours);this._data.months=Math.abs(this._data.months);this._data.years=Math.abs(this._data.years);return this},weeks:function(){return Et(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+kt(this._months/12)*31536e6},humanize:function(e){var t=dr(this,!e,this.localeData());if(e){t=this.localeData().pastFuture(+this,t)}return this.localeData().postformat(t)},add:function(e,t){var r=s.duration(e,t);this._milliseconds+=r._milliseconds;this._days+=r._days;this._months+=r._months;this._bubble();return this},subtract:function(e,t){var r=s.duration(e,t);this._milliseconds-=r._milliseconds;this._days-=r._days;this._months-=r._months;this._bubble();return this},get:function(e){e=Nt(e);return this[e.toLowerCase()+"s"]()},as:function(e){var t,r;e=Nt(e);if(e==="month"||e==="year"){t=this._days+this._milliseconds/864e5;r=this._months+br(t)*12;return e==="month"?r:r/12}else{t=this._days+Math.round(wr(this._months/12));switch(e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return t*24+this._milliseconds/36e5;case"minute":return t*24*60+this._milliseconds/6e4;case"second":return t*24*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(t*24*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}}},lang:s.fn.lang,locale:s.fn.locale,toIsoString:ct("toIsoString() is deprecated. Please use toISOString() instead "+"(notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),r=Math.abs(this.days()),i=Math.abs(this.hours()),s=Math.abs(this.minutes()),n=Math.abs(this.seconds()+this.milliseconds()/1e3);if(!this.asSeconds()){return"P0D"}return(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(r?r+"D":"")+(i||s||n?"T":"")+(i?i+"H":"")+(s?s+"M":"")+(n?n+"S":"")},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}});s.duration.fn.toString=s.duration.fn.toISOString;function Sr(e){s.duration.fn[e]=function(){return this._data[e]}}for(u in W){if(at(W,u)){Sr(u.toLowerCase())}}s.duration.fn.asMilliseconds=function(){return this.as("ms")};s.duration.fn.asSeconds=function(){return this.as("s")};s.duration.fn.asMinutes=function(){return this.as("m")};s.duration.fn.asHours=function(){return this.as("h")};s.duration.fn.asDays=function(){return this.as("d")};s.duration.fn.asWeeks=function(){return this.as("weeks")};s.duration.fn.asMonths=function(){return this.as("M")};s.duration.fn.asYears=function(){return this.as("y")};s.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=kt(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});function Ar(e){if(typeof ender!=="undefined"){return}o=a.moment;if(e){a.moment=ct("Accessing Moment through the global scope is "+"deprecated, and will be removed in an upcoming "+"release.",s)}else{a.moment=s}}if(E){t.exports=s}else if(typeof define==="function"&&define.amd){define(function(e,t,r){if(r.config&&r.config()&&r.config().noGlobal===true){a.moment=o}return s});Ar(true)}else{Ar()}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],135:[function(e,t,r){"use strict";function i(){}t.exports=i},{}],136:[function(e,t,r){"use strict";var i=e("react/lib/warning");var s=e("react/lib/invariant");function n(e,t,r){for(var s in t){if(t.hasOwnProperty(s)){var n=t[s](r,s,e);if(n instanceof Error)i(false,n.message)}}}var a={statics:{validateProps:function o(e){n(this.displayName,this.propTypes,e)}},render:function l(){s(false,"%s elements are for router configuration only and should not be rendered",this.constructor.displayName)}};t.exports=a},{"react/lib/invariant":179,"react/lib/warning":180}],137:[function(e,t,r){"use strict";var i=e("react/lib/invariant");var s=e("react/lib/ExecutionEnvironment").canUseDOM;var n={length:1,back:function a(){i(s,"Cannot use History.back without a DOM");n.length-=1;window.history.back()}};t.exports=n},{"react/lib/ExecutionEnvironment":175,"react/lib/invariant":179}],138:[function(e,t,r){"use strict";var i=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var n=e("./PathUtils");function a(e,t,r){var i=e.childRoutes;if(i){var s,l;for(var c=0,u=i.length;c<u;++c){l=i[c];if(l.isDefault||l.isNotFound)continue;if(s=a(l,t,r)){s.routes.unshift(e);return s}}}var p=e.defaultRoute;if(p&&(f=n.extractParams(p.path,t))){return new o(t,f,r,[e,p])}var d=e.notFoundRoute;if(d&&(f=n.extractParams(d.path,t))){return new o(t,f,r,[e,d])}var f=n.extractParams(e.path,t);if(f){return new o(t,f,r,[e])}return null}var o=function(){function e(t,r,i,n){s(this,e);this.pathname=t;this.params=r;this.query=i;this.routes=n}i(e,{findMatch:{value:function t(e,r){var i=n.withoutQuery(r);var s=n.extractQuery(r);var o=null;for(var l=0,c=e.length;o==null&&l<c;++l)o=a(e[l],i,s);return o},writable:true,configurable:true}});return e}();t.exports=o},{"./PathUtils":141}],139:[function(e,t,r){"use strict";var i=e("./PropTypes");var s={contextTypes:{makePath:i.func.isRequired,makeHref:i.func.isRequired,transitionTo:i.func.isRequired,replaceWith:i.func.isRequired,goBack:i.func.isRequired},makePath:function n(e,t,r){return this.context.makePath(e,t,r)},makeHref:function a(e,t,r){return this.context.makeHref(e,t,r)},transitionTo:function o(e,t,r){this.context.transitionTo(e,t,r)},replaceWith:function l(e,t,r){this.context.replaceWith(e,t,r)},goBack:function c(){return this.context.goBack()}};t.exports=s},{"./PropTypes":142}],140:[function(e,t,r){"use strict";var i=e("./PropTypes");var s={childContextTypes:{makePath:i.func.isRequired,makeHref:i.func.isRequired,transitionTo:i.func.isRequired,replaceWith:i.func.isRequired,goBack:i.func.isRequired},getChildContext:function n(){return{makePath:this.constructor.makePath.bind(this.constructor),makeHref:this.constructor.makeHref.bind(this.constructor),transitionTo:this.constructor.transitionTo.bind(this.constructor),replaceWith:this.constructor.replaceWith.bind(this.constructor),goBack:this.constructor.goBack.bind(this.constructor)}}};t.exports=s},{"./PropTypes":142}],141:[function(e,t,r){"use strict";var i=e("react/lib/invariant");var s=e("qs/lib/utils").merge;var n=e("qs");var a=/:([a-zA-Z_$][a-zA-Z0-9_$]*)|[*.()\[\]\\+|{}^$]/g;var o=/:([a-zA-Z_$][a-zA-Z0-9_$?]*[?]?)|[*]/g;var l=/\/\/\?|\/\?\/|\/\?/g;var c=/\?(.+)/;var u={};function p(e){if(!(e in u)){var t=[];var r=e.replace(a,function(e,r){if(r){t.push(r);return"([^/?#]+)"}else if(e==="*"){t.push("splat");return"(.*?)"}else{return"\\"+e}});u[e]={matcher:new RegExp("^"+r+"$","i"),paramNames:t}}return u[e]}var d={isAbsolute:function f(e){return e.charAt(0)==="/"},join:function h(e,t){return e.replace(/\/*$/,"/")+t},extractParamNames:function m(e){return p(e).paramNames},extractParams:function g(e,t){var r=p(e);var i=r.matcher;var s=r.paramNames;var n=t.match(i);if(!n){return null}var a={};s.forEach(function(e,t){a[e]=n[t+1]});return a},injectParams:function y(e,t){t=t||{};var r=0;return e.replace(o,function(s,n){n=n||"splat";if(n.slice(-1)==="?"){n=n.slice(0,-1);if(t[n]==null)return""}else{i(t[n]!=null,'Missing "%s" parameter for path "%s"',n,e)}var a;if(n==="splat"&&Array.isArray(t[n])){a=t[n][r++];i(a!=null,'Missing splat # %s for path "%s"',r,e)}else{a=t[n]}return a}).replace(l,"/")},extractQuery:function v(e){var t=e.match(c);return t&&n.parse(t[1])},withoutQuery:function _(e){return e.replace(c,"")},withQuery:function E(e,t){var r=d.extractQuery(e);if(r)t=t?s(r,t):r;var i=n.stringify(t,{indices:false});if(i){return d.withoutQuery(e)+"?"+i}return e}};t.exports=d},{qs:170,"qs/lib/utils":174,"react/lib/invariant":179}],142:[function(e,t,r){"use strict";var i=e("react/lib/Object.assign");var s=window.React.PropTypes;var n=i({falsy:function a(e,t,r){if(e[t]){return new Error("<"+r+'> may not have a "'+t+'" prop')}}},s);t.exports=n},{"react/lib/Object.assign":176}],143:[function(e,t,r){"use strict";function i(e,t,r){this.to=e;this.params=t;this.query=r}t.exports=i},{}],144:[function(e,t,r){"use strict";var i=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var n=e("react/lib/Object.assign");var a=e("react/lib/invariant");var o=e("react/lib/warning");var l=e("./PathUtils");var c;var u=function(){function e(t,r,i,n,a,o,c,u){s(this,e);this.name=t;this.path=r;this.paramNames=l.extractParamNames(this.path);this.ignoreScrollBehavior=!!i;this.isDefault=!!n;this.isNotFound=!!a;this.onEnter=o;this.onLeave=c;this.handler=u}i(e,{createRoute:{value:function t(r,i){r=r||{};if(typeof r==="string")r={path:r};var s=c;if(s){o(r.parentRoute==null||r.parentRoute===s,"You should not use parentRoute with createRoute inside another route's child callback; it is ignored")}else{s=r.parentRoute}var n=r.name;var u=r.path||n;if(u&&!(r.isDefault||r.isNotFound)){if(l.isAbsolute(u)){if(s){a(s.paramNames.length===0,'You cannot nest path "%s" inside "%s"; the parent requires URL parameters',u,s.path)}}else if(s){u=l.join(s.path,u)}else{u="/"+u}}else{u=s?s.path:"/"}if(r.isNotFound&&!/\*$/.test(u))u+="*";var p=new e(n,u,r.ignoreScrollBehavior,r.isDefault,r.isNotFound,r.onEnter,r.onLeave,r.handler);if(s){if(p.isDefault){a(s.defaultRoute==null,"%s may not have more than one default route",s);s.defaultRoute=p}else if(p.isNotFound){a(s.notFoundRoute==null,"%s may not have more than one not found route",s);s.notFoundRoute=p}s.appendChild(p)}if(typeof i==="function"){var d=c;c=p;i.call(p,p);c=d}return p},writable:true,configurable:true},createDefaultRoute:{value:function r(t){return e.createRoute(n({},t,{isDefault:true}))},writable:true,configurable:true},createNotFoundRoute:{value:function u(t){return e.createRoute(n({},t,{isNotFound:true}))},writable:true,configurable:true},createRedirect:{value:function p(t){return e.createRoute(n({},t,{path:t.path||t.from||"*",onEnter:function r(e,i,s){e.redirect(t.to,t.params||i,t.query||s)}}))},writable:true,configurable:true}},{appendChild:{value:function d(t){a(t instanceof e,"route.appendChild must use a valid Route");if(!this.childRoutes)this.childRoutes=[];this.childRoutes.push(t)},writable:true,configurable:true},toString:{value:function f(){var e="<Route";if(this.name)e+=' name="'+this.name+'"';
e+=' path="'+this.path+'">';return e},writable:true,configurable:true}});return e}();t.exports=u},{"./PathUtils":141,"react/lib/Object.assign":176,"react/lib/invariant":179,"react/lib/warning":180}],145:[function(e,t,r){"use strict";var i=window.React;var s=e("react/lib/Object.assign");var n=e("./PropTypes");var a="__routeHandler__";var o={contextTypes:{getRouteAtDepth:n.func.isRequired,setRouteComponentAtDepth:n.func.isRequired,routeHandlers:n.array.isRequired},childContextTypes:{routeHandlers:n.array.isRequired},getChildContext:function l(){return{routeHandlers:this.context.routeHandlers.concat([this])}},componentDidMount:function c(){this._updateRouteComponent(this.refs[a])},componentDidUpdate:function u(){this._updateRouteComponent(this.refs[a])},componentWillUnmount:function p(){this._updateRouteComponent(null)},_updateRouteComponent:function d(e){this.context.setRouteComponentAtDepth(this.getRouteDepth(),e)},getRouteDepth:function f(){return this.context.routeHandlers.length},createChildRouteHandler:function h(e){var t=this.context.getRouteAtDepth(this.getRouteDepth());return t?i.createElement(t.handler,s({},e||this.props,{ref:a})):null}};t.exports=o},{"./PropTypes":142,"react/lib/Object.assign":176}],146:[function(e,t,r){"use strict";var i=e("react/lib/invariant");var s=e("react/lib/ExecutionEnvironment").canUseDOM;var n=e("./getWindowScrollPosition");function a(e,t){if(!t){return true}if(e.pathname===t.pathname){return false}var r=e.routes;var i=t.routes;var s=r.filter(function(e){return i.indexOf(e)!==-1});return!s.some(function(e){return e.ignoreScrollBehavior})}var o={statics:{recordScrollPosition:function l(e){if(!this.scrollHistory)this.scrollHistory={};this.scrollHistory[e]=n()},getScrollPosition:function c(e){if(!this.scrollHistory)this.scrollHistory={};return this.scrollHistory[e]||null}},componentWillMount:function u(){i(this.constructor.getScrollBehavior()==null||s,"Cannot use scroll behavior without a DOM")},componentDidMount:function p(){this._updateScroll()},componentDidUpdate:function d(e,t){this._updateScroll(t)},_updateScroll:function f(e){if(!a(this.state,e)){return}var t=this.constructor.getScrollBehavior();if(t)t.updateScrollPosition(this.constructor.getScrollPosition(this.state.path),this.state.action)}};t.exports=o},{"./getWindowScrollPosition":161,"react/lib/ExecutionEnvironment":175,"react/lib/invariant":179}],147:[function(e,t,r){"use strict";var i=e("./PropTypes");var s={contextTypes:{getCurrentPath:i.func.isRequired,getCurrentRoutes:i.func.isRequired,getCurrentPathname:i.func.isRequired,getCurrentParams:i.func.isRequired,getCurrentQuery:i.func.isRequired,isActive:i.func.isRequired},getPath:function n(){return this.context.getCurrentPath()},getRoutes:function a(){return this.context.getCurrentRoutes()},getPathname:function o(){return this.context.getCurrentPathname()},getParams:function l(){return this.context.getCurrentParams()},getQuery:function c(){return this.context.getCurrentQuery()},isActive:function u(e,t,r){return this.context.isActive(e,t,r)}};t.exports=s},{"./PropTypes":142}],148:[function(e,t,r){"use strict";var i=e("react/lib/Object.assign");var s=e("./PropTypes");var n=e("./PathUtils");function a(e,t){return e.some(function(e){return e.name===t})}function o(e,t){for(var r in t)if(String(e[r])!==String(t[r])){return false}return true}function l(e,t){for(var r in t)if(String(e[r])!==String(t[r])){return false}return true}var c={getCurrentPath:function u(){return this.state.path},getCurrentRoutes:function p(){return this.state.routes.slice(0)},getCurrentPathname:function d(){return this.state.pathname},getCurrentParams:function f(){return i({},this.state.params)},getCurrentQuery:function h(){return i({},this.state.query)},isActive:function m(e,t,r){if(n.isAbsolute(e)){return e===this.state.path}return a(this.state.routes,e)&&o(this.state.params,t)&&(r==null||l(this.state.query,r))},childContextTypes:{getCurrentPath:s.func.isRequired,getCurrentRoutes:s.func.isRequired,getCurrentPathname:s.func.isRequired,getCurrentParams:s.func.isRequired,getCurrentQuery:s.func.isRequired,isActive:s.func.isRequired},getChildContext:function g(){return{getCurrentPath:this.getCurrentPath,getCurrentRoutes:this.getCurrentRoutes,getCurrentPathname:this.getCurrentPathname,getCurrentParams:this.getCurrentParams,getCurrentQuery:this.getCurrentQuery,isActive:this.isActive}}};t.exports=c},{"./PathUtils":141,"./PropTypes":142,"react/lib/Object.assign":176}],149:[function(e,t,r){"use strict";var i=e("./Cancellation");var s=e("./Redirect");function n(e,t){this.path=e;this.abortReason=null;this.retry=t.bind(this)}n.prototype.abort=function(e){if(this.abortReason==null)this.abortReason=e||"ABORT"};n.prototype.redirect=function(e,t,r){this.abort(new s(e,t,r))};n.prototype.cancel=function(){this.abort(new i)};n.from=function(e,t,r,i){t.reduce(function(t,i,s){return function(n){if(n||e.abortReason){t(n)}else if(i.onLeave){try{i.onLeave(e,r[s],t);if(i.onLeave.length<3)t()}catch(a){t(a)}}else{t()}}},i)()};n.to=function(e,t,r,i,s){t.reduceRight(function(t,s){return function(n){if(n||e.abortReason){t(n)}else if(s.onEnter){try{s.onEnter(e,r,i,t);if(s.onEnter.length<4)t()}catch(a){t(a)}}else{t()}}},s)()};t.exports=n},{"./Cancellation":135,"./Redirect":143}],150:[function(e,t,r){"use strict";var i={PUSH:"push",REPLACE:"replace",POP:"pop"};t.exports=i},{}],151:[function(e,t,r){"use strict";var i=e("../actions/LocationActions");var s={updateScrollPosition:function n(e,t){switch(t){case i.PUSH:case i.REPLACE:window.scrollTo(0,0);break;case i.POP:if(e){window.scrollTo(e.x,e.y)}else{window.scrollTo(0,0)}break}}};t.exports=s},{"../actions/LocationActions":150}],152:[function(e,t,r){"use strict";var i={updateScrollPosition:function s(){window.scrollTo(0,0)}};t.exports=i},{}],153:[function(e,t,r){"use strict";var i=window.React;var s=e("../Configuration");var n=e("../PropTypes");var a=i.createClass({displayName:"DefaultRoute",mixins:[s],propTypes:{name:n.string,path:n.falsy,children:n.falsy,handler:n.func.isRequired}});t.exports=a},{"../Configuration":136,"../PropTypes":142}],154:[function(e,t,r){"use strict";var i=window.React;var s=e("react/lib/cx");var n=e("react/lib/Object.assign");var a=e("../Navigation");var o=e("../State");var l=e("../PropTypes");var c=e("../Route");function u(e){return e.button===0}function p(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var d=i.createClass({displayName:"Link",mixins:[a,o],propTypes:{activeClassName:l.string.isRequired,to:l.oneOfType([l.string,l.instanceOf(c)]),params:l.object,query:l.object,activeStyle:l.object,onClick:l.func},getDefaultProps:function f(){return{activeClassName:"active"}},handleClick:function h(e){var t=true;var r;if(this.props.onClick)r=this.props.onClick(e);if(p(e)||!u(e)){return}if(r===false||e.defaultPrevented===true)t=false;e.preventDefault();if(t)this.transitionTo(this.props.to,this.props.params,this.props.query)},getHref:function m(){return this.makeHref(this.props.to,this.props.params,this.props.query)},getClassName:function g(){var e={};if(this.props.className)e[this.props.className]=true;if(this.getActiveState())e[this.props.activeClassName]=true;return s(e)},getActiveState:function y(){return this.isActive(this.props.to,this.props.params,this.props.query)},render:function v(){var e=n({},this.props,{href:this.getHref(),className:this.getClassName(),onClick:this.handleClick});if(e.activeStyle&&this.getActiveState())e.style=e.activeStyle;return i.DOM.a(e,this.props.children)}});t.exports=d},{"../Navigation":139,"../PropTypes":142,"../Route":144,"../State":147,"react/lib/Object.assign":176,"react/lib/cx":177}],155:[function(e,t,r){"use strict";var i=window.React;var s=e("../Configuration");var n=e("../PropTypes");var a=i.createClass({displayName:"NotFoundRoute",mixins:[s],propTypes:{name:n.string,path:n.falsy,children:n.falsy,handler:n.func.isRequired}});t.exports=a},{"../Configuration":136,"../PropTypes":142}],156:[function(e,t,r){"use strict";var i=window.React;var s=e("../Configuration");var n=e("../PropTypes");var a=i.createClass({displayName:"Redirect",mixins:[s],propTypes:{path:n.string,from:n.string,to:n.string,handler:n.falsy}});t.exports=a},{"../Configuration":136,"../PropTypes":142}],157:[function(e,t,r){"use strict";var i=window.React;var s=e("../Configuration");var n=e("../PropTypes");var a=e("./RouteHandler");var o=i.createClass({displayName:"Route",mixins:[s],propTypes:{name:n.string,path:n.string,handler:n.func,ignoreScrollBehavior:n.bool},getDefaultProps:function l(){return{handler:a}}});t.exports=o},{"../Configuration":136,"../PropTypes":142,"./RouteHandler":158}],158:[function(e,t,r){"use strict";var i=window.React;var s=e("../RouteHandlerMixin");var n=i.createClass({displayName:"RouteHandler",mixins:[s],render:function a(){return this.createChildRouteHandler()}});t.exports=n},{"../RouteHandlerMixin":145}],159:[function(e,t,r){(function(r){"use strict";var i=window.React;var s=e("react/lib/warning");var n=e("react/lib/invariant");var a=e("react/lib/ExecutionEnvironment").canUseDOM;var o=e("./actions/LocationActions");var l=e("./behaviors/ImitateBrowserBehavior");var c=e("./locations/HashLocation");var u=e("./locations/HistoryLocation");var p=e("./locations/RefreshLocation");var d=e("./locations/StaticLocation");var f=e("./NavigationContext");var h=e("./ScrollHistory");var m=e("./StateContext");var g=e("./createRoutesFromReactChildren");var y=e("./isReactChildren");var v=e("./Transition");var _=e("./PropTypes");var E=e("./Redirect");var b=e("./History");var w=e("./Cancellation");var S=e("./Match");var A=e("./Route");var C=e("./supportsHistory");var T=e("./PathUtils");var R=a?c:"/";var P=a?l:null;function N(e,t){for(var r in t)if(t.hasOwnProperty(r)&&e[r]!==t[r]){return false}return true}function D(e,t,r,i,s,n){return e.some(function(e){if(e!==t)return false;var a=t.paramNames;var o;for(var l=0,c=a.length;l<c;++l){o=a[l];if(i[o]!==r[o])return false}return N(s,n)&&N(n,s)})}function x(e,t){var r;for(var i=0,s=e.length;i<s;++i){r=e[i];if(r.name){n(t[r.name]==null,'You may not have more than one route named "%s"',r.name);t[r.name]=r}if(r.childRoutes)x(r.childRoutes,t)}}function k(e){e=e||{};if(y(e))e={routes:e};var t=[];var l=e.location||R;var N=e.scrollBehavior||P;var k={};var O={};var I=null;var M=null;if(typeof l==="string")l=new d(l);if(l instanceof d){s(!a||r.env.NODE_ENV==="test","You should not use a static location in a DOM environment because "+"the router will not be kept in sync with the current URL")}else{n(a||l.needsDOM===false,"You cannot use %s without a DOM",l)}if(l===u&&!C())l=p;var F=i.createClass({displayName:"Router",statics:{isRunning:false,cancelPendingTransition:function q(){if(I){I.cancel();I=null}},clearAllRoutes:function L(){this.cancelPendingTransition();this.namedRoutes={};this.routes=[]},addRoutes:function j(e){if(y(e))e=g(e);x(e,this.namedRoutes);this.routes.push.apply(this.routes,e)},replaceRoutes:function B(e){this.clearAllRoutes();this.addRoutes(e);this.refresh()},match:function X(e){return S.findMatch(this.routes,e)},makePath:function G(e,t,r){var i;if(T.isAbsolute(e)){i=e}else{var s=e instanceof A?e:this.namedRoutes[e];n(s instanceof A,'Cannot find a route named "%s"',e);i=s.path}return T.withQuery(T.injectParams(i,t),r)},makeHref:function U(e,t,r){var i=this.makePath(e,t,r);return l===c?"#"+i:i},transitionTo:function V(e,t,r){var i=this.makePath(e,t,r);if(I){l.replace(i)}else{l.push(i)}},replaceWith:function H(e,t,r){l.replace(this.makePath(e,t,r))},goBack:function Y(){if(b.length>1||l===p){l.pop();return true}s(false,"goBack() was ignored because there is no router history");return false},handleAbort:e.onAbort||function(e){if(l instanceof d)throw new Error("Unhandled aborted transition! Reason: "+e);if(e instanceof w){return}else if(e instanceof E){l.replace(this.makePath(e.to,e.params,e.query))}else{l.pop()}},handleError:e.onError||function(e){throw e},handleLocationChange:function z(e){this.dispatch(e.path,e.type)},dispatch:function W(e,r){this.cancelPendingTransition();var i=k.path;var n=r==null;if(i===e&&!n){return}if(i&&r===o.PUSH)this.recordScrollPosition(i);var a=this.match(e);s(a!=null,'No route matches path "%s". Make sure you have <Route path="%s"> somewhere in your routes',e,e);if(a==null)a={};var l=k.routes||[];var c=k.params||{};var u=k.query||{};var p=a.routes||[];var d=a.params||{};var f=a.query||{};var h,m;if(l.length){h=l.filter(function(e){return!D(p,e,c,d,u,f)});m=p.filter(function(e){return!D(l,e,c,d,u,f)})}else{h=[];m=p}var g=new v(e,this.replaceWith.bind(this,e));I=g;var y=t.slice(l.length-h.length);v.from(g,h,y,function(t){if(t||g.abortReason)return M.call(F,t,g);v.to(g,m,d,f,function(t){M.call(F,t,g,{path:e,action:r,pathname:a.pathname,routes:p,params:d,query:f})})})},run:function J(e){n(!this.isRunning,"Router is already running");M=function(t,r,i){if(t)F.handleError(t);if(I!==r)return;I=null;if(r.abortReason){F.handleAbort(r.abortReason)}else{e.call(this,this,O=i)}};if(!(l instanceof d)){if(l.addChangeListener)l.addChangeListener(F.handleLocationChange);this.isRunning=true}this.refresh()},refresh:function Q(){F.dispatch(l.getCurrentPath(),null)},stop:function Z(){this.cancelPendingTransition();if(l.removeChangeListener)l.removeChangeListener(F.handleLocationChange);this.isRunning=false},getScrollBehavior:function K(){return N}},mixins:[f,m,h],propTypes:{children:_.falsy},childContextTypes:{getRouteAtDepth:i.PropTypes.func.isRequired,setRouteComponentAtDepth:i.PropTypes.func.isRequired,routeHandlers:i.PropTypes.array.isRequired},getChildContext:function $(){return{getRouteAtDepth:this.getRouteAtDepth,setRouteComponentAtDepth:this.setRouteComponentAtDepth,routeHandlers:[this]}},getInitialState:function et(){return k=O},componentWillReceiveProps:function tt(){this.setState(k=O)},componentWillUnmount:function rt(){F.stop()},getLocation:function it(){return l},getRouteAtDepth:function st(e){var t=this.state.routes;return t&&t[e]},setRouteComponentAtDepth:function nt(e,r){t[e]=r},render:function at(){var e=this.getRouteAtDepth(0);return e?i.createElement(e.handler,this.props):null}});F.clearAllRoutes();if(e.routes)F.addRoutes(e.routes);return F}t.exports=k}).call(this,e("_process"))},{"./Cancellation":135,"./History":137,"./Match":138,"./NavigationContext":140,"./PathUtils":141,"./PropTypes":142,"./Redirect":143,"./Route":144,"./ScrollHistory":146,"./StateContext":148,"./Transition":149,"./actions/LocationActions":150,"./behaviors/ImitateBrowserBehavior":151,"./createRoutesFromReactChildren":160,"./isReactChildren":163,"./locations/HashLocation":164,"./locations/HistoryLocation":165,"./locations/RefreshLocation":166,"./locations/StaticLocation":167,"./supportsHistory":169,_process:130,"react/lib/ExecutionEnvironment":175,"react/lib/invariant":179,"react/lib/warning":180}],160:[function(e,t,r){"use strict";var i=window.React;var s=e("react/lib/Object.assign");var n=e("react/lib/warning");var a=e("./components/DefaultRoute").type;var o=e("./components/NotFoundRoute").type;var l=e("./components/Redirect").type;var c=e("./Route");function u(e,t,r){e=e||"UnknownComponent";for(var i in t){if(t.hasOwnProperty(i)){var s=t[i](r,i,e);if(s instanceof Error)n(false,s.message)}}}function p(e){var t=s({},e);var r=t.handler;if(r){t.onEnter=r.willTransitionTo;t.onLeave=r.willTransitionFrom}return t}function d(e){if(!i.isValidElement(e)){return}var t=e.type;var r=e.props;if(t.propTypes)u(t.displayName,t.propTypes,r);if(t===a){return c.createDefaultRoute(p(r))}if(t===o){return c.createNotFoundRoute(p(r))}if(t===l){return c.createRedirect(p(r))}return c.createRoute(p(r),function(){if(r.children)f(r.children)})}function f(e){var t=[];i.Children.forEach(e,function(e){if(e=d(e))t.push(e)});return t}t.exports=f},{"./Route":144,"./components/DefaultRoute":153,"./components/NotFoundRoute":155,"./components/Redirect":156,"react/lib/Object.assign":176,"react/lib/warning":180}],161:[function(e,t,r){"use strict";var i=e("react/lib/invariant");var s=e("react/lib/ExecutionEnvironment").canUseDOM;function n(){i(s,"Cannot get current scroll position without a DOM");return{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}}t.exports=n},{"react/lib/ExecutionEnvironment":175,"react/lib/invariant":179}],162:[function(e,t,r){"use strict";r.DefaultRoute=e("./components/DefaultRoute");r.Link=e("./components/Link");r.NotFoundRoute=e("./components/NotFoundRoute");r.Redirect=e("./components/Redirect");r.Route=e("./components/Route");r.RouteHandler=e("./components/RouteHandler");r.HashLocation=e("./locations/HashLocation");r.HistoryLocation=e("./locations/HistoryLocation");r.RefreshLocation=e("./locations/RefreshLocation");r.StaticLocation=e("./locations/StaticLocation");r.ImitateBrowserBehavior=e("./behaviors/ImitateBrowserBehavior");r.ScrollToTopBehavior=e("./behaviors/ScrollToTopBehavior");r.History=e("./History");r.Navigation=e("./Navigation");r.RouteHandlerMixin=e("./RouteHandlerMixin");r.State=e("./State");r.createRoute=e("./Route").createRoute;r.createDefaultRoute=e("./Route").createDefaultRoute;r.createNotFoundRoute=e("./Route").createNotFoundRoute;r.createRedirect=e("./Route").createRedirect;r.createRoutesFromReactChildren=e("./createRoutesFromReactChildren");r.create=e("./createRouter");r.run=e("./runRouter")},{"./History":137,"./Navigation":139,"./Route":144,"./RouteHandlerMixin":145,"./State":147,"./behaviors/ImitateBrowserBehavior":151,"./behaviors/ScrollToTopBehavior":152,"./components/DefaultRoute":153,"./components/Link":154,"./components/NotFoundRoute":155,"./components/Redirect":156,"./components/Route":157,"./components/RouteHandler":158,"./createRouter":159,"./createRoutesFromReactChildren":160,"./locations/HashLocation":164,"./locations/HistoryLocation":165,"./locations/RefreshLocation":166,"./locations/StaticLocation":167,"./runRouter":168}],163:[function(e,t,r){"use strict";var i=window.React;function s(e){return e==null||i.isValidElement(e)}function n(e){return s(e)||Array.isArray(e)&&e.every(s)}t.exports=n},{}],164:[function(e,t,r){"use strict";var i=e("../actions/LocationActions");var s=e("../History");function n(){return decodeURI(window.location.href.split("#")[1]||"")}var a;function o(){var e=n();if(e.charAt(0)==="/"){return true}d.replace("/"+e);return false}var l=[];function c(e){if(e===i.PUSH)s.length+=1;var t={path:n(),type:e};l.forEach(function(e){e(t)})}var u=false;function p(){if(o()){c(a||i.POP);a=null}}var d={addChangeListener:function f(e){l.push(e);o();if(!u){if(window.addEventListener){window.addEventListener("hashchange",p,false)}else{window.attachEvent("onhashchange",p)}u=true}},removeChangeListener:function h(e){l=l.filter(function(t){return t!==e});if(l.length===0){if(window.removeEventListener){window.removeEventListener("hashchange",p,false)}else{window.removeEvent("onhashchange",p)}u=false}},push:function m(e){a=i.PUSH;window.location.hash=e},replace:function g(e){a=i.REPLACE;window.location.replace(window.location.pathname+window.location.search+"#"+e)},pop:function y(){a=i.POP;s.back()},getCurrentPath:n,toString:function v(){return"<HashLocation>"}};t.exports=d},{"../History":137,"../actions/LocationActions":150}],165:[function(e,t,r){"use strict";var i=e("../actions/LocationActions");var s=e("../History");function n(){return decodeURI(window.location.pathname+window.location.search)}var a=[];function o(e){var t={path:n(),type:e};a.forEach(function(e){e(t)})}var l=false;function c(e){if(e.state===undefined){return}o(i.POP)}var u={addChangeListener:function p(e){a.push(e);if(!l){if(window.addEventListener){window.addEventListener("popstate",c,false)}else{window.attachEvent("onpopstate",c)}l=true}},removeChangeListener:function d(e){a=a.filter(function(t){return t!==e});if(a.length===0){if(window.addEventListener){window.removeEventListener("popstate",c,false)}else{window.removeEvent("onpopstate",c)}l=false}},push:function f(e){window.history.pushState({path:e},"",e);s.length+=1;o(i.PUSH)},replace:function h(e){window.history.replaceState({path:e},"",e);o(i.REPLACE)},pop:s.back,getCurrentPath:n,toString:function m(){return"<HistoryLocation>"}};t.exports=u},{"../History":137,"../actions/LocationActions":150}],166:[function(e,t,r){"use strict";var i=e("./HistoryLocation");var s=e("../History");var n={push:function a(e){window.location=e},replace:function o(e){window.location.replace(e)},pop:s.back,getCurrentPath:i.getCurrentPath,toString:function l(){return"<RefreshLocation>"}};t.exports=n},{"../History":137,"./HistoryLocation":165}],167:[function(e,t,r){"use strict";var i=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var s=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var n=e("react/lib/invariant");function a(){n(false,"You cannot modify a static location")}var o=function(){function e(t){s(this,e);this.path=t}i(e,null,{getCurrentPath:{value:function t(){return this.path},writable:true,configurable:true},toString:{value:function r(){return'<StaticLocation path="'+this.path+'">'},writable:true,configurable:true}});return e}();o.prototype.push=a;o.prototype.replace=a;o.prototype.pop=a;t.exports=o},{"react/lib/invariant":179}],168:[function(e,t,r){"use strict";var i=e("./createRouter");function s(e,t,r){if(typeof t==="function"){r=t;t=null}var s=i({routes:e,location:t});s.run(r);return s}t.exports=s},{"./createRouter":159}],169:[function(e,t,r){"use strict";function i(){var e=navigator.userAgent;if((e.indexOf("Android 2.")!==-1||e.indexOf("Android 4.0")!==-1)&&e.indexOf("Mobile Safari")!==-1&&e.indexOf("Chrome")===-1&&e.indexOf("Windows Phone")===-1){return false}return window.history&&"pushState"in window.history}t.exports=i},{}],170:[function(e,t,r){t.exports=e("./lib/")},{"./lib/":171}],171:[function(e,t,r){var i=e("./stringify");var s=e("./parse");var n={};t.exports={stringify:i,parse:s}},{"./parse":172,"./stringify":173}],172:[function(e,t,r){var i=e("./utils");var s={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3};s.parseValues=function(e,t){var r={};var s=e.split(t.delimiter,t.parameterLimit===Infinity?undefined:t.parameterLimit);for(var n=0,a=s.length;n<a;++n){var o=s[n];var l=o.indexOf("]=")===-1?o.indexOf("="):o.indexOf("]=")+1;if(l===-1){r[i.decode(o)]=""}else{var c=i.decode(o.slice(0,l));var u=i.decode(o.slice(l+1));if(!r.hasOwnProperty(c)){r[c]=u}else{r[c]=[].concat(r[c]).concat(u)}}}return r};s.parseObject=function(e,t,r){if(!e.length){return t}var i=e.shift();var n={};if(i==="[]"){n=[];n=n.concat(s.parseObject(e,t,r))}else{var a=i[0]==="["&&i[i.length-1]==="]"?i.slice(1,i.length-1):i;var o=parseInt(a,10);var l=""+o;if(!isNaN(o)&&i!==a&&l===a&&o>=0&&o<=r.arrayLimit){n=[];n[o]=s.parseObject(e,t,r)}else{n[a]=s.parseObject(e,t,r)}}return n};s.parseKeys=function(e,t,r){if(!e){return}var i=/^([^\[\]]*)/;var n=/(\[[^\[\]]*\])/g;var a=i.exec(e);if(Object.prototype.hasOwnProperty(a[1])){return}var o=[];if(a[1]){o.push(a[1])}var l=0;while((a=n.exec(e))!==null&&l<r.depth){++l;if(!Object.prototype.hasOwnProperty(a[1].replace(/\[|\]/g,""))){o.push(a[1])}}if(a){o.push("["+e.slice(a.index)+"]")}return s.parseObject(o,t,r)};t.exports=function(e,t){if(e===""||e===null||typeof e==="undefined"){return{}}t=t||{};t.delimiter=typeof t.delimiter==="string"||i.isRegExp(t.delimiter)?t.delimiter:s.delimiter;t.depth=typeof t.depth==="number"?t.depth:s.depth;t.arrayLimit=typeof t.arrayLimit==="number"?t.arrayLimit:s.arrayLimit;t.parameterLimit=typeof t.parameterLimit==="number"?t.parameterLimit:s.parameterLimit;var r=typeof e==="string"?s.parseValues(e,t):e;var n={};var a=Object.keys(r);for(var o=0,l=a.length;o<l;++o){var c=a[o];var u=s.parseKeys(c,r[c],t);n=i.merge(n,u)}return i.compact(n)}},{"./utils":174}],173:[function(e,t,r){var i=e("./utils");var s={delimiter:"&",indices:true};s.stringify=function(e,t,r){if(i.isBuffer(e)){e=e.toString()}else if(e instanceof Date){e=e.toISOString()}else if(e===null){e=""}if(typeof e==="string"||typeof e==="number"||typeof e==="boolean"){return[encodeURIComponent(t)+"="+encodeURIComponent(e)]}var n=[];if(typeof e==="undefined"){return n}var a=Object.keys(e);for(var o=0,l=a.length;o<l;++o){var c=a[o];if(!r.indices&&Array.isArray(e)){n=n.concat(s.stringify(e[c],t,r))}else{n=n.concat(s.stringify(e[c],t+"["+c+"]",r))}}return n};t.exports=function(e,t){t=t||{};var r=typeof t.delimiter==="undefined"?s.delimiter:t.delimiter;t.indices=typeof t.indices==="boolean"?t.indices:s.indices;var i=[];if(typeof e!=="object"||e===null){return""}var n=Object.keys(e);for(var a=0,o=n.length;a<o;++a){var l=n[a];i=i.concat(s.stringify(e[l],l,t))}return i.join(r)}},{"./utils":174}],174:[function(e,t,r){var i={};r.arrayToObject=function(e){var t={};for(var r=0,i=e.length;r<i;++r){if(typeof e[r]!=="undefined"){t[r]=e[r]}}return t};r.merge=function(e,t){if(!t){return e}if(typeof t!=="object"){if(Array.isArray(e)){e.push(t)}else{e[t]=true}return e}if(typeof e!=="object"){e=[e].concat(t);return e}if(Array.isArray(e)&&!Array.isArray(t)){e=r.arrayToObject(e)}var i=Object.keys(t);for(var s=0,n=i.length;s<n;++s){var a=i[s];var o=t[a];if(!e[a]){e[a]=o}else{e[a]=r.merge(e[a],o)}}return e};r.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}};r.compact=function(e,t){if(typeof e!=="object"||e===null){return e}t=t||[];var i=t.indexOf(e);if(i!==-1){return t[i]}t.push(e);if(Array.isArray(e)){var s=[];for(var n=0,a=e.length;n<a;++n){if(typeof e[n]!=="undefined"){s.push(e[n])}}return s}var o=Object.keys(e);for(n=0,a=o.length;n<a;++n){var l=o[n];e[l]=r.compact(e[l],t)}return e};r.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"};r.isBuffer=function(e){if(e===null||typeof e==="undefined"){return false}return!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},{}],175:[function(e,t,r){"use strict";var i=!!(typeof window!=="undefined"&&window.document&&window.document.createElement);var s={canUseDOM:i,canUseWorkers:typeof Worker!=="undefined",canUseEventListeners:i&&!!(window.addEventListener||window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};t.exports=s},{}],176:[function(e,t,r){function i(e,t){if(e==null){throw new TypeError("Object.assign target cannot be null or undefined")}var r=Object(e);var i=Object.prototype.hasOwnProperty;for(var s=1;s<arguments.length;s++){var n=arguments[s];if(n==null){continue}var a=Object(n);for(var o in a){if(i.call(a,o)){r[o]=a[o]}}}return r}t.exports=i},{}],177:[function(e,t,r){function i(e){if(typeof e=="object"){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}else{return Array.prototype.join.call(arguments," ")}}t.exports=i},{}],178:[function(e,t,r){function i(e){return function(){return e}}function s(){}s.thatReturns=i;s.thatReturnsFalse=i(false);s.thatReturnsTrue=i(true);s.thatReturnsNull=i(null);s.thatReturnsThis=function(){return this};s.thatReturnsArgument=function(e){return e};t.exports=s},{}],179:[function(e,t,r){(function(e){"use strict";var r=function(t,r,i,s,n,a,o,l){if("production"!==e.env.NODE_ENV){if(r===undefined){throw new Error("invariant requires an error message argument")}}if(!t){var c;if(r===undefined){c=new Error("Minified exception occurred; use the non-minified dev environment "+"for the full error message and additional helpful warnings.")}else{var u=[i,s,n,a,o,l];var p=0;c=new Error("Invariant Violation: "+r.replace(/%s/g,function(){return u[p++]}))}c.framesToPop=1;throw c}};t.exports=r}).call(this,e("_process"))},{_process:130}],180:[function(e,t,r){(function(r){"use strict";var i=e("./emptyFunction");var s=i;if("production"!==r.env.NODE_ENV){s=function(e,t){for(var r=[],i=2,s=arguments.length;i<s;i++)r.push(arguments[i]);if(t===undefined){throw new Error("`warning(condition, format, ...args)` requires a warning "+"message argument")}if(!e){var n=0;console.warn("Warning: "+t.replace(/%s/g,function(){return r[n++]}))}}}t.exports=s}).call(this,e("_process"))},{"./emptyFunction":178,_process:130}],181:[function(e,t,r){(function(e){(function(t,r){"use strict";if(t.setImmediate){return}var i=1;var s={};var n=false;var a=t.document;var o;function l(e){s[i]=c.apply(r,e);return i++}function c(e){var t=[].slice.call(arguments,1);return function(){if(typeof e==="function"){e.apply(r,t)}else{new Function(""+e)()}}}function u(e){if(n){setTimeout(c(u,e),0)}else{var t=s[e];if(t){n=true;try{t()}finally{p(e);n=false}}}}function p(e){delete s[e]}function d(){o=function(){var t=l(arguments);e.nextTick(c(u,t));return t}}function f(){if(t.postMessage&&!t.importScripts){var e=true;var r=t.onmessage;t.onmessage=function(){e=false};t.postMessage("","*");t.onmessage=r;return e}}function h(){var e="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===t&&typeof r.data==="string"&&r.data.indexOf(e)===0){u(+r.data.slice(e.length))}};if(t.addEventListener){t.addEventListener("message",r,false)}else{t.attachEvent("onmessage",r)}o=function(){var r=l(arguments);t.postMessage(e+r,"*");return r}}function m(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;u(t)};o=function(){var t=l(arguments);e.port2.postMessage(t);return t}}function g(){var e=a.documentElement;o=function(){var t=l(arguments);var r=a.createElement("script");r.onreadystatechange=function(){u(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r);return t}}function y(){o=function(){var e=l(arguments);setTimeout(c(u,e),0);return e}}var v=Object.getPrototypeOf&&Object.getPrototypeOf(t);v=v&&v.setTimeout?v:t;if({}.toString.call(t.process)==="[object process]"){d()}else if(f()){h()}else if(t.MessageChannel){m()}else if(a&&"onreadystatechange"in a.createElement("script")){g()}else{y()}v.setImmediate=o;v.clearImmediate=p})(new Function("return this")())}).call(this,e("_process"))},{_process:130}],182:[function(e,t,r){(function(e){var r;if(e.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);r=function n(){crypto.getRandomValues(i);return i}}if(!r){var s=new Array(16);r=function(){for(var e=0,t;e<16;e++){if((e&3)===0)t=Math.random()*4294967296;s[e]=t>>>((e&3)<<3)&255}return s}}t.exports=r}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],183:[function(e,t,r){var i=e("./rng");var s=[];var n={};for(var a=0;a<256;a++){s[a]=(a+256).toString(16).substr(1);n[s[a]]=a}function o(e,t,r){var i=t&&r||0,s=0;t=t||[];e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){if(s<16){t[i+s++]=n[e]}});while(s<16){t[i+s++]=0}return t}function l(e,t){var r=t||0,i=s;return i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]}var c=i();var u=[c[0]|1,c[1],c[2],c[3],c[4],c[5]];var p=(c[6]<<8|c[7])&16383;var d=0,f=0;function h(e,t,r){var i=t&&r||0;var s=t||[];e=e||{};var n=e.clockseq!==undefined?e.clockseq:p;var a=e.msecs!==undefined?e.msecs:(new Date).getTime();var o=e.nsecs!==undefined?e.nsecs:f+1;var c=a-d+(o-f)/1e4;if(c<0&&e.clockseq===undefined){n=n+1&16383}if((c<0||a>d)&&e.nsecs===undefined){o=0}if(o>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}d=a;f=o;p=n;a+=122192928e5;var h=((a&268435455)*1e4+o)%4294967296;s[i++]=h>>>24&255;s[i++]=h>>>16&255;s[i++]=h>>>8&255;s[i++]=h&255;var m=a/4294967296*1e4&268435455;s[i++]=m>>>8&255;s[i++]=m&255;s[i++]=m>>>24&15|16;s[i++]=m>>>16&255;s[i++]=n>>>8|128;s[i++]=n&255;var g=e.node||u;for(var y=0;y<6;y++){s[i+y]=g[y]}return t?t:l(s)}function m(e,t,r){var s=t&&r||0;if(typeof e=="string"){t=e=="binary"?new Array(16):null;e=null}e=e||{};var n=e.random||(e.rng||i)();n[6]=n[6]&15|64;n[8]=n[8]&63|128;if(t){for(var a=0;a<16;a++){t[s+a]=n[a]}}return t||l(n)}var g=m;g.v1=h;g.v4=m;g.parse=o;g.unparse=l;t.exports=g},{"./rng":182}]},{},[1]);
//# sourceMappingURL=sr.js.map